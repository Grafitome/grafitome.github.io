function convertDateIntoYYMMDD(t){var e=t.getMonth()+1,a=t.getDate();10>e&&(e="0"+e),10>a&&(a="0"+a);var n=t.getFullYear()+"-"+e+"-"+a;return n}function getMinRange(t){return Math.min(Math.min(getMinFromArray(t,"Trend"),getMinFromArray(t,"LowBand")),getMinFromArray(t,"Low"),getMinFromArray(t,"Close"))}function getMaxRange(t){return Math.max(Math.max(getMaxFromArray(t,"Trend"),getMaxFromArray(t,"HighBand")),getMaxFromArray(t,"High"),getMaxFromArray(t,"Close"))}function getMinFromArray(t,e){var a=Number.MAX_VALUE;return angular.forEach(t,function(t){t[e]<a&&0!=t[e]&&(a=t[e])}),a}function getMaxFromArray(t,e){var a=-Number.MAX_VALUE;return angular.forEach(t,function(t){t[e]>a&&0!=t[e]&&(a=t[e])}),a==Number.MIN_VALUE?void 0:a}!function(){function t(t,e){return e>t?-1:t>e?1:t>=e?0:0/0}function e(t){return null===t?0/0:+t}function a(t){return!isNaN(t)}function n(t){return{left:function(e,a,n,r){for(arguments.length<3&&(n=0),arguments.length<4&&(r=e.length);r>n;){var i=n+r>>>1;t(e[i],a)<0?n=i+1:r=i}return n},right:function(e,a,n,r){for(arguments.length<3&&(n=0),arguments.length<4&&(r=e.length);r>n;){var i=n+r>>>1;t(e[i],a)>0?r=i:n=i+1}return n}}}function r(t){return t.length}function i(t){for(var e=1;t*e%1;)e*=10;return e}function o(t,e){for(var a in e)Object.defineProperty(t.prototype,a,{value:e[a],enumerable:!1})}function l(){this._=Object.create(null)}function s(t){return(t+="")===cl||t[0]===dl?dl+t:t}function u(t){return(t+="")[0]===dl?t.slice(1):t}function c(t){return s(t)in this._}function d(t){return(t=s(t))in this._&&delete this._[t]}function f(){var t=[];for(var e in this._)t.push(u(e));return t}function h(){var t=0;for(var e in this._)++t;return t}function p(){for(var t in this._)return!1;return!0}function g(){this._=Object.create(null)}function v(t,e,a){return function(){var n=a.apply(e,arguments);return n===e?t:n}}function y(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var a=0,n=fl.length;n>a;++a){var r=fl[a]+e;if(r in t)return r}}function x(){}function m(){}function b(t){function e(){for(var e,n=a,r=-1,i=n.length;++r<i;)(e=n[r].on)&&e.apply(this,arguments);return t}var a=[],n=new l;return e.on=function(e,r){var i,o=n.get(e);return arguments.length<2?o&&o.on:(o&&(o.on=null,a=a.slice(0,i=a.indexOf(o)).concat(a.slice(i+1)),n.remove(e)),r&&a.push(n.set(e,{on:r})),t)},e}function A(){Wo.event.preventDefault()}function M(){for(var t,e=Wo.event;t=e.sourceEvent;)e=t;return e}function k(t){for(var e=new m,a=0,n=arguments.length;++a<n;)e[arguments[a]]=b(e);return e.of=function(a,n){return function(r){try{var i=r.sourceEvent=Wo.event;r.target=t,Wo.event=r,e[r.type].apply(a,n)}finally{Wo.event=i}}},e}function w(t){return pl(t,ml),t}function S(t){return"function"==typeof t?t:function(){return gl(t,this)}}function C(t){return"function"==typeof t?t:function(){return vl(t,this)}}function T(t,e){function a(){this.removeAttribute(t)}function n(){this.removeAttributeNS(t.space,t.local)}function r(){this.setAttribute(t,e)}function i(){this.setAttributeNS(t.space,t.local,e)}function o(){var a=e.apply(this,arguments);null==a?this.removeAttribute(t):this.setAttribute(t,a)}function l(){var a=e.apply(this,arguments);null==a?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,a)}return t=Wo.ns.qualify(t),null==e?t.local?n:a:"function"==typeof e?t.local?l:o:t.local?i:r}function L(t){return t.trim().replace(/\s+/g," ")}function N(t){return new RegExp("(?:^|\\s+)"+Wo.requote(t)+"(?:\\s+|$)","g")}function D(t){return(t+"").trim().split(/^|\s+/)}function P(t,e){function a(){for(var a=-1;++a<r;)t[a](this,e)}function n(){for(var a=-1,n=e.apply(this,arguments);++a<r;)t[a](this,n)}t=D(t).map(_);var r=t.length;return"function"==typeof e?n:a}function _(t){var e=N(t);return function(a,n){if(r=a.classList)return n?r.add(t):r.remove(t);var r=a.getAttribute("class")||"";n?(e.lastIndex=0,e.test(r)||a.setAttribute("class",L(r+" "+t))):a.setAttribute("class",L(r.replace(e," ")))}}function I(t,e,a){function n(){this.style.removeProperty(t)}function r(){this.style.setProperty(t,e,a)}function i(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,a)}return null==e?n:"function"==typeof e?i:r}function V(t,e){function a(){delete this[t]}function n(){this[t]=e}function r(){var a=e.apply(this,arguments);null==a?delete this[t]:this[t]=a}return null==e?a:"function"==typeof e?r:n}function F(t){return"function"==typeof t?t:(t=Wo.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,t)}}function O(t){return{__data__:t}}function z(t){return function(){return xl(this,t)}}function G(e){return arguments.length||(e=t),function(t,a){return t&&a?e(t.__data__,a.__data__):!t-!a}}function R(t,e){for(var a=0,n=t.length;n>a;a++)for(var r,i=t[a],o=0,l=i.length;l>o;o++)(r=i[o])&&e(r,o,a);return t}function E(t){return pl(t,Al),t}function Y(t){var e,a;return function(n,r,i){var o,l=t[i].update,s=l.length;for(i!=a&&(a=i,e=0),r>=e&&(e=r+1);!(o=l[e])&&++e<s;);return o}}function B(){var t=this.__transition__;t&&++t.active}function J(t,e,a){function n(){var e=this[o];e&&(this.removeEventListener(t,e,e.$),delete this[o])}function r(){var r=s(e,Zo(arguments));n.call(this),this.addEventListener(t,this[o]=r,r.$=a),r._=e}function i(){var e,a=new RegExp("^__on([^.]+)"+Wo.requote(t)+"$");for(var n in this)if(e=n.match(a)){var r=this[n];this.removeEventListener(e[1],r,r.$),delete this[n]}}var o="__on"+t,l=t.indexOf("."),s=q;l>0&&(t=t.slice(0,l));var u=kl.get(t);return u&&(t=u,s=X),l?e?r:n:e?x:i}function q(t,e){return function(a){var n=Wo.event;Wo.event=a,e[0]=this.__data__;try{t.apply(this,e)}finally{Wo.event=n}}}function X(t,e){var a=q(t,e);return function(t){var e=this,n=t.relatedTarget;n&&(n===e||8&n.compareDocumentPosition(e))||a.call(e,t)}}function U(){var t=".dragsuppress-"+ ++Sl,e="click"+t,a=Wo.select(tl).on("touchmove"+t,A).on("dragstart"+t,A).on("selectstart"+t,A);if(wl){var n=Qo.style,r=n[wl];n[wl]="none"}return function(i){function o(){a.on(e,null)}a.on(t,null),wl&&(n[wl]=r),i&&(a.on(e,function(){A(),o()},!0),setTimeout(o,0))}}function H(t,e){e.changedTouches&&(e=e.changedTouches[0]);var a=t.ownerSVGElement||t;if(a.createSVGPoint){var n=a.createSVGPoint();if(0>Cl&&(tl.scrollX||tl.scrollY)){a=Wo.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var r=a[0][0].getScreenCTM();Cl=!(r.f||r.e),a.remove()}return Cl?(n.x=e.pageX,n.y=e.pageY):(n.x=e.clientX,n.y=e.clientY),n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}function j(){return Wo.event.changedTouches[0].identifier}function W(){return Wo.event.target}function $(){return tl}function Z(t){return t>0?1:0>t?-1:0}function K(t,e,a){return(e[0]-t[0])*(a[1]-t[1])-(e[1]-t[1])*(a[0]-t[0])}function Q(t){return t>1?0:-1>t?Tl:Math.acos(t)}function te(t){return t>1?Nl:-1>t?-Nl:Math.asin(t)}function ee(t){return((t=Math.exp(t))-1/t)/2}function ae(t){return((t=Math.exp(t))+1/t)/2}function ne(t){return((t=Math.exp(2*t))-1)/(t+1)}function re(t){return(t=Math.sin(t/2))*t}function ie(){}function oe(t,e,a){return this instanceof oe?(this.h=+t,this.s=+e,void(this.l=+a)):arguments.length<2?t instanceof oe?new oe(t.h,t.s,t.l):be(""+t,Ae,oe):new oe(t,e,a)}function le(t,e,a){function n(t){return t>360?t-=360:0>t&&(t+=360),60>t?i+(o-i)*t/60:180>t?o:240>t?i+(o-i)*(240-t)/60:i}function r(t){return Math.round(255*n(t))}var i,o;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,a=0>a?0:a>1?1:a,o=.5>=a?a*(1+e):a+e-a*e,i=2*a-o,new ve(r(t+120),r(t),r(t-120))}function se(t,e,a){return this instanceof se?(this.h=+t,this.c=+e,void(this.l=+a)):arguments.length<2?t instanceof se?new se(t.h,t.c,t.l):t instanceof ce?fe(t.l,t.a,t.b):fe((t=Me((t=Wo.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new se(t,e,a)}function ue(t,e,a){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new ce(a,Math.cos(t*=_l)*e,Math.sin(t)*e)}function ce(t,e,a){return this instanceof ce?(this.l=+t,this.a=+e,void(this.b=+a)):arguments.length<2?t instanceof ce?new ce(t.l,t.a,t.b):t instanceof se?ue(t.h,t.c,t.l):Me((t=ve(t)).r,t.g,t.b):new ce(t,e,a)}function de(t,e,a){var n=(t+16)/116,r=n+e/500,i=n-a/200;return r=he(r)*Jl,n=he(n)*ql,i=he(i)*Xl,new ve(ge(3.2404542*r-1.5371385*n-.4985314*i),ge(-.969266*r+1.8760108*n+.041556*i),ge(.0556434*r-.2040259*n+1.0572252*i))}function fe(t,e,a){return t>0?new se(Math.atan2(a,e)*Il,Math.sqrt(e*e+a*a),t):new se(0/0,0/0,t)}function he(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function pe(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function ge(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function ve(t,e,a){return this instanceof ve?(this.r=~~t,this.g=~~e,void(this.b=~~a)):arguments.length<2?t instanceof ve?new ve(t.r,t.g,t.b):be(""+t,ve,le):new ve(t,e,a)}function ye(t){return new ve(t>>16,255&t>>8,255&t)}function xe(t){return ye(t)+""}function me(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function be(t,e,a){var n,r,i,o=0,l=0,s=0;if(n=/([a-z]+)\((.*)\)/i.exec(t))switch(r=n[2].split(","),n[1]){case"hsl":return a(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(we(r[0]),we(r[1]),we(r[2]))}return(i=jl.get(t))?e(i.r,i.g,i.b):(null==t||"#"!==t.charAt(0)||isNaN(i=parseInt(t.slice(1),16))||(4===t.length?(o=(3840&i)>>4,o=o>>4|o,l=240&i,l=l>>4|l,s=15&i,s=s<<4|s):7===t.length&&(o=(16711680&i)>>16,l=(65280&i)>>8,s=255&i)),e(o,l,s))}function Ae(t,e,a){var n,r,i=Math.min(t/=255,e/=255,a/=255),o=Math.max(t,e,a),l=o-i,s=(o+i)/2;return l?(r=.5>s?l/(o+i):l/(2-o-i),n=t==o?(e-a)/l+(a>e?6:0):e==o?(a-t)/l+2:(t-e)/l+4,n*=60):(n=0/0,r=s>0&&1>s?0:n),new oe(n,r,s)}function Me(t,e,a){t=ke(t),e=ke(e),a=ke(a);var n=pe((.4124564*t+.3575761*e+.1804375*a)/Jl),r=pe((.2126729*t+.7151522*e+.072175*a)/ql),i=pe((.0193339*t+.119192*e+.9503041*a)/Xl);return ce(116*r-16,500*(n-r),200*(r-i))}function ke(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function we(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function Se(t){return"function"==typeof t?t:function(){return t}}function Ce(t){return t}function Te(t){return function(e,a,n){return 2===arguments.length&&"function"==typeof a&&(n=a,a=null),Le(e,a,t,n)}}function Le(t,e,a,n){function r(){var t,e=s.status;if(!e&&De(s)||e>=200&&300>e||304===e){try{t=a.call(i,s)}catch(n){return void o.error.call(i,n)}o.load.call(i,t)}else o.error.call(i,s)}var i={},o=Wo.dispatch("beforesend","progress","load","error"),l={},s=new XMLHttpRequest,u=null;return!tl.XDomainRequest||"withCredentials"in s||!/^(http(s)?:)?\/\//.test(t)||(s=new XDomainRequest),"onload"in s?s.onload=s.onerror=r:s.onreadystatechange=function(){s.readyState>3&&r()},s.onprogress=function(t){var e=Wo.event;Wo.event=t;try{o.progress.call(i,s)}finally{Wo.event=e}},i.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?l[t]:(null==e?delete l[t]:l[t]=e+"",i)},i.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",i):e},i.responseType=function(t){return arguments.length?(u=t,i):u},i.response=function(t){return a=t,i},["get","post"].forEach(function(t){i[t]=function(){return i.send.apply(i,[t].concat(Zo(arguments)))}}),i.send=function(a,n,r){if(2===arguments.length&&"function"==typeof n&&(r=n,n=null),s.open(a,t,!0),null==e||"accept"in l||(l.accept=e+",*/*"),s.setRequestHeader)for(var c in l)s.setRequestHeader(c,l[c]);return null!=e&&s.overrideMimeType&&s.overrideMimeType(e),null!=u&&(s.responseType=u),null!=r&&i.on("error",r).on("load",function(t){r(null,t)}),o.beforesend.call(i,s),s.send(null==n?null:n),i},i.abort=function(){return s.abort(),i},Wo.rebind(i,o,"on"),null==n?i:i.get(Ne(n))}function Ne(t){return 1===t.length?function(e,a){t(null==e?a:null)}:t}function De(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function Pe(){var t=_e(),e=Ie()-t;e>24?(isFinite(e)&&(clearTimeout(Kl),Kl=setTimeout(Pe,e)),Zl=0):(Zl=1,ts(Pe))}function _e(){var t=Date.now();for(Ql=Wl;Ql;)t>=Ql.t&&(Ql.f=Ql.c(t-Ql.t)),Ql=Ql.n;return t}function Ie(){for(var t,e=Wl,a=1/0;e;)e.f?e=t?t.n=e.n:Wl=e.n:(e.t<a&&(a=e.t),e=(t=e).n);return $l=t,a}function Ve(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function Fe(t,e){var a=Math.pow(10,3*ul(8-e));return{scale:e>8?function(t){return t/a}:function(t){return t*a},symbol:t}}function Oe(t){var e=t.decimal,a=t.thousands,n=t.grouping,r=t.currency,i=n&&a?function(t,e){for(var r=t.length,i=[],o=0,l=n[0],s=0;r>0&&l>0&&(s+l+1>e&&(l=Math.max(1,e-s)),i.push(t.substring(r-=l,r+l)),!((s+=l+1)>e));)l=n[o=(o+1)%n.length];return i.reverse().join(a)}:Ce;return function(t){var a=as.exec(t),n=a[1]||" ",o=a[2]||">",l=a[3]||"-",s=a[4]||"",u=a[5],c=+a[6],d=a[7],f=a[8],h=a[9],p=1,g="",v="",y=!1,x=!0;switch(f&&(f=+f.substring(1)),(u||"0"===n&&"="===o)&&(u=n="0",o="="),h){case"n":d=!0,h="g";break;case"%":p=100,v="%",h="f";break;case"p":p=100,v="%",h="r";break;case"b":case"o":case"x":case"X":"#"===s&&(g="0"+h.toLowerCase());case"c":x=!1;case"d":y=!0,f=0;break;case"s":p=-1,h="r"}"$"===s&&(g=r[0],v=r[1]),"r"!=h||f||(h="g"),null!=f&&("g"==h?f=Math.max(1,Math.min(21,f)):("e"==h||"f"==h)&&(f=Math.max(0,Math.min(20,f)))),h=ns.get(h)||ze;var m=u&&d;return function(t){var a=v;if(y&&t%1)return"";var r=0>t||0===t&&0>1/t?(t=-t,"-"):"-"===l?"":l;if(0>p){var s=Wo.formatPrefix(t,f);t=s.scale(t),a=s.symbol+v}else t*=p;t=h(t,f);var b,A,M=t.lastIndexOf(".");if(0>M){var k=x?t.lastIndexOf("e"):-1;0>k?(b=t,A=""):(b=t.substring(0,k),A=t.substring(k))}else b=t.substring(0,M),A=e+t.substring(M+1);!u&&d&&(b=i(b,1/0));var w=g.length+b.length+A.length+(m?0:r.length),S=c>w?new Array(w=c-w+1).join(n):"";return m&&(b=i(S+b,S.length?c-A.length:1/0)),r+=g,t=b+A,("<"===o?r+t+S:">"===o?S+r+t:"^"===o?S.substring(0,w>>=1)+r+t+S.substring(w):r+(m?t:S+t))+a}}}function ze(t){return t+""}function Ge(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Re(t,e,a){function n(e){var a=t(e),n=i(a,1);return n-e>e-a?a:n}function r(a){return e(a=t(new is(a-1)),1),a}function i(t,a){return e(t=new is(+t),a),t}function o(t,n,i){var o=r(t),l=[];if(i>1)for(;n>o;)a(o)%i||l.push(new Date(+o)),e(o,1);else for(;n>o;)l.push(new Date(+o)),e(o,1);return l}function l(t,e,a){try{is=Ge;var n=new Ge;return n._=t,o(n,e,a)}finally{is=Date}}t.floor=t,t.round=n,t.ceil=r,t.offset=i,t.range=o;var s=t.utc=Ee(t);return s.floor=s,s.round=Ee(n),s.ceil=Ee(r),s.offset=Ee(i),s.range=l,t}function Ee(t){return function(e,a){try{is=Ge;var n=new Ge;return n._=e,t(n,a)._}finally{is=Date}}}function Ye(t){function e(t){function e(e){for(var a,r,i,o=[],l=-1,s=0;++l<n;)37===t.charCodeAt(l)&&(o.push(t.slice(s,l)),null!=(r=ls[a=t.charAt(++l)])&&(a=t.charAt(++l)),(i=L[a])&&(a=i(e,null==r?"e"===a?" ":"0":r)),o.push(a),s=l+1);return o.push(t.slice(s,l)),o.join("")}var n=t.length;return e.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},r=a(n,t,e,0);if(r!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var i=null!=n.Z&&is!==Ge,o=new(i?Ge:is);return"j"in n?o.setFullYear(n.y,0,n.j):"w"in n&&("W"in n||"U"in n)?(o.setFullYear(n.y,0,1),o.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(o.getDay()+5)%7:n.w+7*n.U-(o.getDay()+6)%7)):o.setFullYear(n.y,n.m,n.d),o.setHours(n.H+(0|n.Z/100),n.M+n.Z%100,n.S,n.L),i?o._:o},e.toString=function(){return t},e}function a(t,e,a,n){for(var r,i,o,l=0,s=e.length,u=a.length;s>l;){if(n>=u)return-1;if(r=e.charCodeAt(l++),37===r){if(o=e.charAt(l++),i=N[o in ls?e.charAt(l++):o],!i||(n=i(t,a,n))<0)return-1}else if(r!=a.charCodeAt(n++))return-1}return n}function n(t,e,a){M.lastIndex=0;var n=M.exec(e.slice(a));return n?(t.w=k.get(n[0].toLowerCase()),a+n[0].length):-1}function r(t,e,a){b.lastIndex=0;var n=b.exec(e.slice(a));return n?(t.w=A.get(n[0].toLowerCase()),a+n[0].length):-1}function i(t,e,a){C.lastIndex=0;var n=C.exec(e.slice(a));return n?(t.m=T.get(n[0].toLowerCase()),a+n[0].length):-1}function o(t,e,a){w.lastIndex=0;var n=w.exec(e.slice(a));return n?(t.m=S.get(n[0].toLowerCase()),a+n[0].length):-1}function l(t,e,n){return a(t,L.c.toString(),e,n)}function s(t,e,n){return a(t,L.x.toString(),e,n)}function u(t,e,n){return a(t,L.X.toString(),e,n)}function c(t,e,a){var n=m.get(e.slice(a,a+=2).toLowerCase());return null==n?-1:(t.p=n,a)}var d=t.dateTime,f=t.date,h=t.time,p=t.periods,g=t.days,v=t.shortDays,y=t.months,x=t.shortMonths;e.utc=function(t){function a(t){try{is=Ge;var e=new is;return e._=t,n(e)}finally{is=Date}}var n=e(t);return a.parse=function(t){try{is=Ge;var e=n.parse(t);return e&&e._}finally{is=Date}},a.toString=n.toString,a},e.multi=e.utc.multi=la;var m=Wo.map(),b=Je(g),A=qe(g),M=Je(v),k=qe(v),w=Je(y),S=qe(y),C=Je(x),T=qe(x);p.forEach(function(t,e){m.set(t.toLowerCase(),e)});var L={a:function(t){return v[t.getDay()]},A:function(t){return g[t.getDay()]},b:function(t){return x[t.getMonth()]},B:function(t){return y[t.getMonth()]},c:e(d),d:function(t,e){return Be(t.getDate(),e,2)},e:function(t,e){return Be(t.getDate(),e,2)},H:function(t,e){return Be(t.getHours(),e,2)},I:function(t,e){return Be(t.getHours()%12||12,e,2)},j:function(t,e){return Be(1+rs.dayOfYear(t),e,3)},L:function(t,e){return Be(t.getMilliseconds(),e,3)},m:function(t,e){return Be(t.getMonth()+1,e,2)},M:function(t,e){return Be(t.getMinutes(),e,2)},p:function(t){return p[+(t.getHours()>=12)]},S:function(t,e){return Be(t.getSeconds(),e,2)},U:function(t,e){return Be(rs.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return Be(rs.mondayOfYear(t),e,2)},x:e(f),X:e(h),y:function(t,e){return Be(t.getFullYear()%100,e,2)},Y:function(t,e){return Be(t.getFullYear()%1e4,e,4)},Z:ia,"%":function(){return"%"}},N={a:n,A:r,b:i,B:o,c:l,d:Qe,e:Qe,H:ea,I:ea,j:ta,L:ra,m:Ke,M:aa,p:c,S:na,U:Ue,w:Xe,W:He,x:s,X:u,y:We,Y:je,Z:$e,"%":oa};return e}function Be(t,e,a){var n=0>t?"-":"",r=(n?-t:t)+"",i=r.length;return n+(a>i?new Array(a-i+1).join(e)+r:r)}function Je(t){return new RegExp("^(?:"+t.map(Wo.requote).join("|")+")","i")}function qe(t){for(var e=new l,a=-1,n=t.length;++a<n;)e.set(t[a].toLowerCase(),a);return e}function Xe(t,e,a){ss.lastIndex=0;var n=ss.exec(e.slice(a,a+1));return n?(t.w=+n[0],a+n[0].length):-1}function Ue(t,e,a){ss.lastIndex=0;var n=ss.exec(e.slice(a));return n?(t.U=+n[0],a+n[0].length):-1}function He(t,e,a){ss.lastIndex=0;var n=ss.exec(e.slice(a));return n?(t.W=+n[0],a+n[0].length):-1}function je(t,e,a){ss.lastIndex=0;var n=ss.exec(e.slice(a,a+4));return n?(t.y=+n[0],a+n[0].length):-1}function We(t,e,a){ss.lastIndex=0;var n=ss.exec(e.slice(a,a+2));return n?(t.y=Ze(+n[0]),a+n[0].length):-1}function $e(t,e,a){return/^[+-]\d{4}$/.test(e=e.slice(a,a+5))?(t.Z=-e,a+5):-1}function Ze(t){return t+(t>68?1900:2e3)}function Ke(t,e,a){ss.lastIndex=0;var n=ss.exec(e.slice(a,a+2));return n?(t.m=n[0]-1,a+n[0].length):-1}function Qe(t,e,a){ss.lastIndex=0;var n=ss.exec(e.slice(a,a+2));return n?(t.d=+n[0],a+n[0].length):-1}function ta(t,e,a){ss.lastIndex=0;var n=ss.exec(e.slice(a,a+3));return n?(t.j=+n[0],a+n[0].length):-1}function ea(t,e,a){ss.lastIndex=0;var n=ss.exec(e.slice(a,a+2));return n?(t.H=+n[0],a+n[0].length):-1}function aa(t,e,a){ss.lastIndex=0;var n=ss.exec(e.slice(a,a+2));return n?(t.M=+n[0],a+n[0].length):-1}function na(t,e,a){ss.lastIndex=0;var n=ss.exec(e.slice(a,a+2));return n?(t.S=+n[0],a+n[0].length):-1}function ra(t,e,a){ss.lastIndex=0;var n=ss.exec(e.slice(a,a+3));return n?(t.L=+n[0],a+n[0].length):-1}function ia(t){var e=t.getTimezoneOffset(),a=e>0?"-":"+",n=0|ul(e)/60,r=ul(e)%60;return a+Be(n,"0",2)+Be(r,"0",2)}function oa(t,e,a){us.lastIndex=0;var n=us.exec(e.slice(a,a+1));return n?a+n[0].length:-1}function la(t){for(var e=t.length,a=-1;++a<e;)t[a][0]=this(t[a][0]);return function(e){for(var a=0,n=t[a];!n[1](e);)n=t[++a];return n[0](e)}}function sa(){}function ua(t,e,a){var n=a.s=t+e,r=n-t,i=n-r;a.t=t-i+(e-r)}function ca(t,e){t&&hs.hasOwnProperty(t.type)&&hs[t.type](t,e)}function da(t,e,a){var n,r=-1,i=t.length-a;for(e.lineStart();++r<i;)n=t[r],e.point(n[0],n[1],n[2]);e.lineEnd()}function fa(t,e){var a=-1,n=t.length;for(e.polygonStart();++a<n;)da(t[a],e,1);e.polygonEnd()}function ha(){function t(t,e){t*=_l,e=e*_l/2+Tl/4;var a=t-n,o=a>=0?1:-1,l=o*a,s=Math.cos(e),u=Math.sin(e),c=i*u,d=r*s+c*Math.cos(l),f=c*o*Math.sin(l);gs.add(Math.atan2(f,d)),n=t,r=s,i=u}var e,a,n,r,i;vs.point=function(o,l){vs.point=t,n=(e=o)*_l,r=Math.cos(l=(a=l)*_l/2+Tl/4),i=Math.sin(l)},vs.lineEnd=function(){t(e,a)}}function pa(t){var e=t[0],a=t[1],n=Math.cos(a);return[n*Math.cos(e),n*Math.sin(e),Math.sin(a)]}function ga(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function va(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function ya(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function xa(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function ma(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function ba(t){return[Math.atan2(t[1],t[0]),te(t[2])]}function Aa(t,e){return ul(t[0]-e[0])<Dl&&ul(t[1]-e[1])<Dl}function Ma(t,e){t*=_l;var a=Math.cos(e*=_l);ka(a*Math.cos(t),a*Math.sin(t),Math.sin(e))}function ka(t,e,a){++ys,ms+=(t-ms)/ys,bs+=(e-bs)/ys,As+=(a-As)/ys}function wa(){function t(t,r){t*=_l;var i=Math.cos(r*=_l),o=i*Math.cos(t),l=i*Math.sin(t),s=Math.sin(r),u=Math.atan2(Math.sqrt((u=a*s-n*l)*u+(u=n*o-e*s)*u+(u=e*l-a*o)*u),e*o+a*l+n*s);xs+=u,Ms+=u*(e+(e=o)),ks+=u*(a+(a=l)),ws+=u*(n+(n=s)),ka(e,a,n)}var e,a,n;Ls.point=function(r,i){r*=_l;var o=Math.cos(i*=_l);e=o*Math.cos(r),a=o*Math.sin(r),n=Math.sin(i),Ls.point=t,ka(e,a,n)}}function Sa(){Ls.point=Ma}function Ca(){function t(t,e){t*=_l;var a=Math.cos(e*=_l),o=a*Math.cos(t),l=a*Math.sin(t),s=Math.sin(e),u=r*s-i*l,c=i*o-n*s,d=n*l-r*o,f=Math.sqrt(u*u+c*c+d*d),h=n*o+r*l+i*s,p=f&&-Q(h)/f,g=Math.atan2(f,h);Ss+=p*u,Cs+=p*c,Ts+=p*d,xs+=g,Ms+=g*(n+(n=o)),ks+=g*(r+(r=l)),ws+=g*(i+(i=s)),ka(n,r,i)}var e,a,n,r,i;Ls.point=function(o,l){e=o,a=l,Ls.point=t,o*=_l;var s=Math.cos(l*=_l);n=s*Math.cos(o),r=s*Math.sin(o),i=Math.sin(l),ka(n,r,i)},Ls.lineEnd=function(){t(e,a),Ls.lineEnd=Sa,Ls.point=Ma}}function Ta(){return!0}function La(t,e,a,n,r){var i=[],o=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,a=t[0],n=t[e];if(Aa(a,n)){r.lineStart();for(var l=0;e>l;++l)r.point((a=t[l])[0],a[1]);return void r.lineEnd()}var s=new Da(a,t,null,!0),u=new Da(a,null,s,!1);s.o=u,i.push(s),o.push(u),s=new Da(n,t,null,!1),u=new Da(n,null,s,!0),s.o=u,i.push(s),o.push(u)}}),o.sort(e),Na(i),Na(o),i.length){for(var l=0,s=a,u=o.length;u>l;++l)o[l].e=s=!s;for(var c,d,f=i[0];;){for(var h=f,p=!0;h.v;)if((h=h.n)===f)return;c=h.z,r.lineStart();do{if(h.v=h.o.v=!0,h.e){if(p)for(var l=0,u=c.length;u>l;++l)r.point((d=c[l])[0],d[1]);else n(h.x,h.n.x,1,r);h=h.n}else{if(p){c=h.p.z;for(var l=c.length-1;l>=0;--l)r.point((d=c[l])[0],d[1])}else n(h.x,h.p.x,-1,r);h=h.p}h=h.o,c=h.z,p=!p}while(!h.v);r.lineEnd()}}}function Na(t){if(e=t.length){for(var e,a,n=0,r=t[0];++n<e;)r.n=a=t[n],a.p=r,r=a;r.n=a=t[0],a.p=r}}function Da(t,e,a,n){this.x=t,this.z=e,this.o=a,this.e=n,this.v=!1,this.n=this.p=null}function Pa(t,e,a,n){return function(r,i){function o(e,a){var n=r(e,a);t(e=n[0],a=n[1])&&i.point(e,a)}function l(t,e){var a=r(t,e);v.point(a[0],a[1])}function s(){x.point=l,v.lineStart()}function u(){x.point=o,v.lineEnd()}function c(t,e){g.push([t,e]);var a=r(t,e);b.point(a[0],a[1])}function d(){b.lineStart(),g=[]}function f(){c(g[0][0],g[0][1]),b.lineEnd();var t,e=b.clean(),a=m.buffer(),n=a.length;if(g.pop(),p.push(g),g=null,n)if(1&e){t=a[0];var r,n=t.length-1,o=-1;if(n>0){for(A||(i.polygonStart(),A=!0),i.lineStart();++o<n;)i.point((r=t[o])[0],r[1]);i.lineEnd()}}else n>1&&2&e&&a.push(a.pop().concat(a.shift())),h.push(a.filter(_a))}var h,p,g,v=e(i),y=r.invert(n[0],n[1]),x={point:o,lineStart:s,lineEnd:u,polygonStart:function(){x.point=c,x.lineStart=d,x.lineEnd=f,h=[],p=[]},polygonEnd:function(){x.point=o,x.lineStart=s,x.lineEnd=u,h=Wo.merge(h);var t=Ga(y,p);h.length?(A||(i.polygonStart(),A=!0),La(h,Va,t,a,i)):t&&(A||(i.polygonStart(),A=!0),i.lineStart(),a(null,null,1,i),i.lineEnd()),A&&(i.polygonEnd(),A=!1),h=p=null},sphere:function(){i.polygonStart(),i.lineStart(),a(null,null,1,i),i.lineEnd(),i.polygonEnd()}},m=Ia(),b=e(m),A=!1;return x}}function _a(t){return t.length>1}function Ia(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,a){t.push([e,a])},lineEnd:x,buffer:function(){var a=e;return e=[],t=null,a},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function Va(t,e){return((t=t.x)[0]<0?t[1]-Nl-Dl:Nl-t[1])-((e=e.x)[0]<0?e[1]-Nl-Dl:Nl-e[1])}function Fa(t){var e,a=0/0,n=0/0,r=0/0;return{lineStart:function(){t.lineStart(),e=1},point:function(i,o){var l=i>0?Tl:-Tl,s=ul(i-a);ul(s-Tl)<Dl?(t.point(a,n=(n+o)/2>0?Nl:-Nl),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(l,n),t.point(i,n),e=0):r!==l&&s>=Tl&&(ul(a-r)<Dl&&(a-=r*Dl),ul(i-l)<Dl&&(i-=l*Dl),n=Oa(a,n,i,o),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(l,n),e=0),t.point(a=i,n=o),r=l},lineEnd:function(){t.lineEnd(),a=n=0/0},clean:function(){return 2-e}}}function Oa(t,e,a,n){var r,i,o=Math.sin(t-a);return ul(o)>Dl?Math.atan((Math.sin(e)*(i=Math.cos(n))*Math.sin(a)-Math.sin(n)*(r=Math.cos(e))*Math.sin(t))/(r*i*o)):(e+n)/2}function za(t,e,a,n){var r;if(null==t)r=a*Nl,n.point(-Tl,r),n.point(0,r),n.point(Tl,r),n.point(Tl,0),n.point(Tl,-r),n.point(0,-r),n.point(-Tl,-r),n.point(-Tl,0),n.point(-Tl,r);else if(ul(t[0]-e[0])>Dl){var i=t[0]<e[0]?Tl:-Tl;r=a*i/2,n.point(-i,r),n.point(0,r),n.point(i,r)}else n.point(e[0],e[1])}function Ga(t,e){var a=t[0],n=t[1],r=[Math.sin(a),-Math.cos(a),0],i=0,o=0;gs.reset();for(var l=0,s=e.length;s>l;++l){var u=e[l],c=u.length;if(c)for(var d=u[0],f=d[0],h=d[1]/2+Tl/4,p=Math.sin(h),g=Math.cos(h),v=1;;){v===c&&(v=0),t=u[v];var y=t[0],x=t[1]/2+Tl/4,m=Math.sin(x),b=Math.cos(x),A=y-f,M=A>=0?1:-1,k=M*A,w=k>Tl,S=p*m;if(gs.add(Math.atan2(S*M*Math.sin(k),g*b+S*Math.cos(k))),i+=w?A+M*Ll:A,w^f>=a^y>=a){var C=va(pa(d),pa(t));ma(C);var T=va(r,C);ma(T);var L=(w^A>=0?-1:1)*te(T[2]);(n>L||n===L&&(C[0]||C[1]))&&(o+=w^A>=0?1:-1)}if(!v++)break;f=y,p=m,g=b,d=t}}return(-Dl>i||Dl>i&&0>gs)^1&o}function Ra(t){function e(t,e){return Math.cos(t)*Math.cos(e)>i}function a(t){var a,i,s,u,c;return{lineStart:function(){u=s=!1,c=1},point:function(d,f){var h,p=[d,f],g=e(d,f),v=o?g?0:r(d,f):g?r(d+(0>d?Tl:-Tl),f):0;if(!a&&(u=s=g)&&t.lineStart(),g!==s&&(h=n(a,p),(Aa(a,h)||Aa(p,h))&&(p[0]+=Dl,p[1]+=Dl,g=e(p[0],p[1]))),g!==s)c=0,g?(t.lineStart(),h=n(p,a),t.point(h[0],h[1])):(h=n(a,p),t.point(h[0],h[1]),t.lineEnd()),a=h;else if(l&&a&&o^g){var y;v&i||!(y=n(p,a,!0))||(c=0,o?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1])))}!g||a&&Aa(a,p)||t.point(p[0],p[1]),a=p,s=g,i=v},lineEnd:function(){s&&t.lineEnd(),a=null},clean:function(){return c|(u&&s)<<1}}}function n(t,e,a){var n=pa(t),r=pa(e),o=[1,0,0],l=va(n,r),s=ga(l,l),u=l[0],c=s-u*u;if(!c)return!a&&t;var d=i*s/c,f=-i*u/c,h=va(o,l),p=xa(o,d),g=xa(l,f);ya(p,g);var v=h,y=ga(p,v),x=ga(v,v),m=y*y-x*(ga(p,p)-1);if(!(0>m)){var b=Math.sqrt(m),A=xa(v,(-y-b)/x);if(ya(A,p),A=ba(A),!a)return A;var M,k=t[0],w=e[0],S=t[1],C=e[1];k>w&&(M=k,k=w,w=M);var T=w-k,L=ul(T-Tl)<Dl,N=L||Dl>T;if(!L&&S>C&&(M=S,S=C,C=M),N?L?S+C>0^A[1]<(ul(A[0]-k)<Dl?S:C):S<=A[1]&&A[1]<=C:T>Tl^(k<=A[0]&&A[0]<=w)){var D=xa(v,(-y+b)/x);return ya(D,p),[A,ba(D)]}}}function r(e,a){var n=o?t:Tl-t,r=0;return-n>e?r|=1:e>n&&(r|=2),-n>a?r|=4:a>n&&(r|=8),r}var i=Math.cos(t),o=i>0,l=ul(i)>Dl,s=pn(t,6*_l);return Pa(e,a,s,o?[0,-t]:[-Tl,t-Tl])}function Ea(t,e,a,n){return function(r){var i,o=r.a,l=r.b,s=o.x,u=o.y,c=l.x,d=l.y,f=0,h=1,p=c-s,g=d-u;if(i=t-s,p||!(i>0)){if(i/=p,0>p){if(f>i)return;h>i&&(h=i)}else if(p>0){if(i>h)return;i>f&&(f=i)}if(i=a-s,p||!(0>i)){if(i/=p,0>p){if(i>h)return;i>f&&(f=i)}else if(p>0){if(f>i)return;h>i&&(h=i)}if(i=e-u,g||!(i>0)){if(i/=g,0>g){if(f>i)return;h>i&&(h=i)}else if(g>0){if(i>h)return;i>f&&(f=i)}if(i=n-u,g||!(0>i)){if(i/=g,0>g){if(i>h)return;i>f&&(f=i)}else if(g>0){if(f>i)return;h>i&&(h=i)}return f>0&&(r.a={x:s+f*p,y:u+f*g}),1>h&&(r.b={x:s+h*p,y:u+h*g}),r}}}}}}function Ya(t,e,a,n){function r(n,r){return ul(n[0]-t)<Dl?r>0?0:3:ul(n[0]-a)<Dl?r>0?2:1:ul(n[1]-e)<Dl?r>0?1:0:r>0?3:2}function i(t,e){return o(t.x,e.x)}function o(t,e){var a=r(t,1),n=r(e,1);return a!==n?a-n:0===a?e[1]-t[1]:1===a?t[0]-e[0]:2===a?t[1]-e[1]:e[0]-t[0]}return function(l){function s(t){for(var e=0,a=v.length,n=t[1],r=0;a>r;++r)for(var i,o=1,l=v[r],s=l.length,u=l[0];s>o;++o)i=l[o],u[1]<=n?i[1]>n&&K(u,i,t)>0&&++e:i[1]<=n&&K(u,i,t)<0&&--e,u=i;return 0!==e}function u(i,l,s,u){var c=0,d=0;if(null==i||(c=r(i,s))!==(d=r(l,s))||o(i,l)<0^s>0){do u.point(0===c||3===c?t:a,c>1?n:e);while((c=(c+s+4)%4)!==d)}else u.point(l[0],l[1])}function c(r,i){return r>=t&&a>=r&&i>=e&&n>=i}function d(t,e){c(t,e)&&l.point(t,e)}function f(){N.point=p,v&&v.push(y=[]),w=!0,k=!1,A=M=0/0}function h(){g&&(p(x,m),b&&k&&T.rejoin(),g.push(T.buffer())),N.point=d,k&&l.lineEnd()}function p(t,e){t=Math.max(-Ds,Math.min(Ds,t)),e=Math.max(-Ds,Math.min(Ds,e));var a=c(t,e);if(v&&y.push([t,e]),w)x=t,m=e,b=a,w=!1,a&&(l.lineStart(),l.point(t,e));else if(a&&k)l.point(t,e);else{var n={a:{x:A,y:M},b:{x:t,y:e}};L(n)?(k||(l.lineStart(),l.point(n.a.x,n.a.y)),l.point(n.b.x,n.b.y),a||l.lineEnd(),S=!1):a&&(l.lineStart(),l.point(t,e),S=!1)}A=t,M=e,k=a}var g,v,y,x,m,b,A,M,k,w,S,C=l,T=Ia(),L=Ea(t,e,a,n),N={point:d,lineStart:f,lineEnd:h,polygonStart:function(){l=T,g=[],v=[],S=!0},polygonEnd:function(){l=C,g=Wo.merge(g);var e=s([t,n]),a=S&&e,r=g.length;(a||r)&&(l.polygonStart(),a&&(l.lineStart(),u(null,null,1,l),l.lineEnd()),r&&La(g,i,e,u,l),l.polygonEnd()),g=v=y=null}};return N}}function Ba(t,e){function a(a,n){return a=t(a,n),e(a[0],a[1])}return t.invert&&e.invert&&(a.invert=function(a,n){return a=e.invert(a,n),a&&t.invert(a[0],a[1])}),a}function Ja(t){var e=0,a=Tl/3,n=on(t),r=n(e,a);return r.parallels=function(t){return arguments.length?n(e=t[0]*Tl/180,a=t[1]*Tl/180):[180*(e/Tl),180*(a/Tl)]},r}function qa(t,e){function a(t,e){var a=Math.sqrt(i-2*r*Math.sin(e))/r;return[a*Math.sin(t*=r),o-a*Math.cos(t)]}var n=Math.sin(t),r=(n+Math.sin(e))/2,i=1+n*(2*r-n),o=Math.sqrt(i)/r;return a.invert=function(t,e){var a=o-e;return[Math.atan2(t,a)/r,te((i-(t*t+a*a)*r*r)/(2*r))]},a}function Xa(){function t(t,e){_s+=r*t-n*e,n=t,r=e}var e,a,n,r;zs.point=function(i,o){zs.point=t,e=n=i,a=r=o},zs.lineEnd=function(){t(e,a)}}function Ua(t,e){Is>t&&(Is=t),t>Fs&&(Fs=t),Vs>e&&(Vs=e),e>Os&&(Os=e)}function Ha(){function t(t,e){o.push("M",t,",",e,i)}function e(t,e){o.push("M",t,",",e),l.point=a}function a(t,e){o.push("L",t,",",e)}function n(){l.point=t}function r(){o.push("Z")}var i=ja(4.5),o=[],l={point:t,lineStart:function(){l.point=e},lineEnd:n,polygonStart:function(){l.lineEnd=r},polygonEnd:function(){l.lineEnd=n,l.point=t},pointRadius:function(t){return i=ja(t),l},result:function(){if(o.length){var t=o.join("");return o=[],t}}};return l}function ja(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Wa(t,e){ms+=t,bs+=e,++As}function $a(){function t(t,n){var r=t-e,i=n-a,o=Math.sqrt(r*r+i*i);Ms+=o*(e+t)/2,ks+=o*(a+n)/2,ws+=o,Wa(e=t,a=n)}var e,a;Rs.point=function(n,r){Rs.point=t,Wa(e=n,a=r)}}function Za(){Rs.point=Wa}function Ka(){function t(t,e){var a=t-n,i=e-r,o=Math.sqrt(a*a+i*i);Ms+=o*(n+t)/2,ks+=o*(r+e)/2,ws+=o,o=r*t-n*e,Ss+=o*(n+t),Cs+=o*(r+e),Ts+=3*o,Wa(n=t,r=e)}var e,a,n,r;Rs.point=function(i,o){Rs.point=t,Wa(e=n=i,a=r=o)},Rs.lineEnd=function(){t(e,a)}}function Qa(t){function e(e,a){t.moveTo(e,a),t.arc(e,a,o,0,Ll)}function a(e,a){t.moveTo(e,a),l.point=n}function n(e,a){t.lineTo(e,a)}function r(){l.point=e}function i(){t.closePath()}var o=4.5,l={point:e,lineStart:function(){l.point=a},lineEnd:r,polygonStart:function(){l.lineEnd=i},polygonEnd:function(){l.lineEnd=r,l.point=e},pointRadius:function(t){return o=t,l},result:x};return l}function tn(t){function e(t){return(l?n:a)(t)}function a(e){return nn(e,function(a,n){a=t(a,n),e.point(a[0],a[1])})}function n(e){function a(a,n){a=t(a,n),e.point(a[0],a[1])
}function n(){m=0/0,w.point=i,e.lineStart()}function i(a,n){var i=pa([a,n]),o=t(a,n);r(m,b,x,A,M,k,m=o[0],b=o[1],x=a,A=i[0],M=i[1],k=i[2],l,e),e.point(m,b)}function o(){w.point=a,e.lineEnd()}function s(){n(),w.point=u,w.lineEnd=c}function u(t,e){i(d=t,f=e),h=m,p=b,g=A,v=M,y=k,w.point=i}function c(){r(m,b,x,A,M,k,h,p,d,g,v,y,l,e),w.lineEnd=o,o()}var d,f,h,p,g,v,y,x,m,b,A,M,k,w={point:a,lineStart:n,lineEnd:o,polygonStart:function(){e.polygonStart(),w.lineStart=s},polygonEnd:function(){e.polygonEnd(),w.lineStart=n}};return w}function r(e,a,n,l,s,u,c,d,f,h,p,g,v,y){var x=c-e,m=d-a,b=x*x+m*m;if(b>4*i&&v--){var A=l+h,M=s+p,k=u+g,w=Math.sqrt(A*A+M*M+k*k),S=Math.asin(k/=w),C=ul(ul(k)-1)<Dl||ul(n-f)<Dl?(n+f)/2:Math.atan2(M,A),T=t(C,S),L=T[0],N=T[1],D=L-e,P=N-a,_=m*D-x*P;(_*_/b>i||ul((x*D+m*P)/b-.5)>.3||o>l*h+s*p+u*g)&&(r(e,a,n,l,s,u,L,N,C,A/=w,M/=w,k,v,y),y.point(L,N),r(L,N,C,A,M,k,c,d,f,h,p,g,v,y))}}var i=.5,o=Math.cos(30*_l),l=16;return e.precision=function(t){return arguments.length?(l=(i=t*t)>0&&16,e):Math.sqrt(i)},e}function en(t){var e=tn(function(e,a){return t([e*Il,a*Il])});return function(t){return ln(e(t))}}function an(t){this.stream=t}function nn(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function rn(t){return on(function(){return t})()}function on(t){function e(t){return t=l(t[0]*_l,t[1]*_l),[t[0]*f+s,u-t[1]*f]}function a(t){return t=l.invert((t[0]-s)/f,(u-t[1])/f),t&&[t[0]*Il,t[1]*Il]}function n(){l=Ba(o=cn(y,x,m),i);var t=i(g,v);return s=h-t[0]*f,u=p+t[1]*f,r()}function r(){return c&&(c.valid=!1,c=null),e}var i,o,l,s,u,c,d=tn(function(t,e){return t=i(t,e),[t[0]*f+s,u-t[1]*f]}),f=150,h=480,p=250,g=0,v=0,y=0,x=0,m=0,b=Ns,A=Ce,M=null,k=null;return e.stream=function(t){return c&&(c.valid=!1),c=ln(b(o,d(A(t)))),c.valid=!0,c},e.clipAngle=function(t){return arguments.length?(b=null==t?(M=t,Ns):Ra((M=+t)*_l),r()):M},e.clipExtent=function(t){return arguments.length?(k=t,A=t?Ya(t[0][0],t[0][1],t[1][0],t[1][1]):Ce,r()):k},e.scale=function(t){return arguments.length?(f=+t,n()):f},e.translate=function(t){return arguments.length?(h=+t[0],p=+t[1],n()):[h,p]},e.center=function(t){return arguments.length?(g=t[0]%360*_l,v=t[1]%360*_l,n()):[g*Il,v*Il]},e.rotate=function(t){return arguments.length?(y=t[0]%360*_l,x=t[1]%360*_l,m=t.length>2?t[2]%360*_l:0,n()):[y*Il,x*Il,m*Il]},Wo.rebind(e,d,"precision"),function(){return i=t.apply(this,arguments),e.invert=i.invert&&a,n()}}function ln(t){return nn(t,function(e,a){t.point(e*_l,a*_l)})}function sn(t,e){return[t,e]}function un(t,e){return[t>Tl?t-Ll:-Tl>t?t+Ll:t,e]}function cn(t,e,a){return t?e||a?Ba(fn(t),hn(e,a)):fn(t):e||a?hn(e,a):un}function dn(t){return function(e,a){return e+=t,[e>Tl?e-Ll:-Tl>e?e+Ll:e,a]}}function fn(t){var e=dn(t);return e.invert=dn(-t),e}function hn(t,e){function a(t,e){var a=Math.cos(e),l=Math.cos(t)*a,s=Math.sin(t)*a,u=Math.sin(e),c=u*n+l*r;return[Math.atan2(s*i-c*o,l*n-u*r),te(c*i+s*o)]}var n=Math.cos(t),r=Math.sin(t),i=Math.cos(e),o=Math.sin(e);return a.invert=function(t,e){var a=Math.cos(e),l=Math.cos(t)*a,s=Math.sin(t)*a,u=Math.sin(e),c=u*i-s*o;return[Math.atan2(s*i+u*o,l*n+c*r),te(c*n-l*r)]},a}function pn(t,e){var a=Math.cos(t),n=Math.sin(t);return function(r,i,o,l){var s=o*e;null!=r?(r=gn(a,r),i=gn(a,i),(o>0?i>r:r>i)&&(r+=o*Ll)):(r=t+o*Ll,i=t-.5*s);for(var u,c=r;o>0?c>i:i>c;c-=s)l.point((u=ba([a,-n*Math.cos(c),-n*Math.sin(c)]))[0],u[1])}}function gn(t,e){var a=pa(e);a[0]-=t,ma(a);var n=Q(-a[1]);return((-a[2]<0?-n:n)+2*Math.PI-Dl)%(2*Math.PI)}function vn(t,e,a){var n=Wo.range(t,e-Dl,a).concat(e);return function(t){return n.map(function(e){return[t,e]})}}function yn(t,e,a){var n=Wo.range(t,e-Dl,a).concat(e);return function(t){return n.map(function(e){return[e,t]})}}function xn(t){return t.source}function mn(t){return t.target}function bn(t,e,a,n){var r=Math.cos(e),i=Math.sin(e),o=Math.cos(n),l=Math.sin(n),s=r*Math.cos(t),u=r*Math.sin(t),c=o*Math.cos(a),d=o*Math.sin(a),f=2*Math.asin(Math.sqrt(re(n-e)+r*o*re(a-t))),h=1/Math.sin(f),p=f?function(t){var e=Math.sin(t*=f)*h,a=Math.sin(f-t)*h,n=a*s+e*c,r=a*u+e*d,o=a*i+e*l;return[Math.atan2(r,n)*Il,Math.atan2(o,Math.sqrt(n*n+r*r))*Il]}:function(){return[t*Il,e*Il]};return p.distance=f,p}function An(){function t(t,r){var i=Math.sin(r*=_l),o=Math.cos(r),l=ul((t*=_l)-e),s=Math.cos(l);Es+=Math.atan2(Math.sqrt((l=o*Math.sin(l))*l+(l=n*i-a*o*s)*l),a*i+n*o*s),e=t,a=i,n=o}var e,a,n;Ys.point=function(r,i){e=r*_l,a=Math.sin(i*=_l),n=Math.cos(i),Ys.point=t},Ys.lineEnd=function(){Ys.point=Ys.lineEnd=x}}function Mn(t,e){function a(e,a){var n=Math.cos(e),r=Math.cos(a),i=t(n*r);return[i*r*Math.sin(e),i*Math.sin(a)]}return a.invert=function(t,a){var n=Math.sqrt(t*t+a*a),r=e(n),i=Math.sin(r),o=Math.cos(r);return[Math.atan2(t*i,n*o),Math.asin(n&&a*i/n)]},a}function kn(t,e){function a(t,e){o>0?-Nl+Dl>e&&(e=-Nl+Dl):e>Nl-Dl&&(e=Nl-Dl);var a=o/Math.pow(r(e),i);return[a*Math.sin(i*t),o-a*Math.cos(i*t)]}var n=Math.cos(t),r=function(t){return Math.tan(Tl/4+t/2)},i=t===e?Math.sin(t):Math.log(n/Math.cos(e))/Math.log(r(e)/r(t)),o=n*Math.pow(r(t),i)/i;return i?(a.invert=function(t,e){var a=o-e,n=Z(i)*Math.sqrt(t*t+a*a);return[Math.atan2(t,a)/i,2*Math.atan(Math.pow(o/n,1/i))-Nl]},a):Sn}function wn(t,e){function a(t,e){var a=i-e;return[a*Math.sin(r*t),i-a*Math.cos(r*t)]}var n=Math.cos(t),r=t===e?Math.sin(t):(n-Math.cos(e))/(e-t),i=n/r+t;return ul(r)<Dl?sn:(a.invert=function(t,e){var a=i-e;return[Math.atan2(t,a)/r,i-Z(r)*Math.sqrt(t*t+a*a)]},a)}function Sn(t,e){return[t,Math.log(Math.tan(Tl/4+e/2))]}function Cn(t){var e,a=rn(t),n=a.scale,r=a.translate,i=a.clipExtent;return a.scale=function(){var t=n.apply(a,arguments);return t===a?e?a.clipExtent(null):a:t},a.translate=function(){var t=r.apply(a,arguments);return t===a?e?a.clipExtent(null):a:t},a.clipExtent=function(t){var o=i.apply(a,arguments);if(o===a){if(e=null==t){var l=Tl*n(),s=r();i([[s[0]-l,s[1]-l],[s[0]+l,s[1]+l]])}}else e&&(o=null);return o},a.clipExtent(null)}function Tn(t,e){return[Math.log(Math.tan(Tl/4+e/2)),-t]}function Ln(t){return t[0]}function Nn(t){return t[1]}function Dn(t){for(var e=t.length,a=[0,1],n=2,r=2;e>r;r++){for(;n>1&&K(t[a[n-2]],t[a[n-1]],t[r])<=0;)--n;a[n++]=r}return a.slice(0,n)}function Pn(t,e){return t[0]-e[0]||t[1]-e[1]}function _n(t,e,a){return(a[0]-e[0])*(t[1]-e[1])<(a[1]-e[1])*(t[0]-e[0])}function In(t,e,a,n){var r=t[0],i=a[0],o=e[0]-r,l=n[0]-i,s=t[1],u=a[1],c=e[1]-s,d=n[1]-u,f=(l*(s-u)-d*(r-i))/(d*o-l*c);return[r+f*o,s+f*c]}function Vn(t){var e=t[0],a=t[t.length-1];return!(e[0]-a[0]||e[1]-a[1])}function Fn(){ar(this),this.edge=this.site=this.circle=null}function On(t){var e=Qs.pop()||new Fn;return e.site=t,e}function zn(t){Hn(t),$s.remove(t),Qs.push(t),ar(t)}function Gn(t){var e=t.circle,a=e.x,n=e.cy,r={x:a,y:n},i=t.P,o=t.N,l=[t];zn(t);for(var s=i;s.circle&&ul(a-s.circle.x)<Dl&&ul(n-s.circle.cy)<Dl;)i=s.P,l.unshift(s),zn(s),s=i;l.unshift(s),Hn(s);for(var u=o;u.circle&&ul(a-u.circle.x)<Dl&&ul(n-u.circle.cy)<Dl;)o=u.N,l.push(u),zn(u),u=o;l.push(u),Hn(u);var c,d=l.length;for(c=1;d>c;++c)u=l[c],s=l[c-1],Qn(u.edge,s.site,u.site,r);s=l[0],u=l[d-1],u.edge=Zn(s.site,u.site,null,r),Un(s),Un(u)}function Rn(t){for(var e,a,n,r,i=t.x,o=t.y,l=$s._;l;)if(n=En(l,o)-i,n>Dl)l=l.L;else{if(r=i-Yn(l,o),!(r>Dl)){n>-Dl?(e=l.P,a=l):r>-Dl?(e=l,a=l.N):e=a=l;break}if(!l.R){e=l;break}l=l.R}var s=On(t);if($s.insert(e,s),e||a){if(e===a)return Hn(e),a=On(e.site),$s.insert(s,a),s.edge=a.edge=Zn(e.site,s.site),Un(e),void Un(a);if(!a)return void(s.edge=Zn(e.site,s.site));Hn(e),Hn(a);var u=e.site,c=u.x,d=u.y,f=t.x-c,h=t.y-d,p=a.site,g=p.x-c,v=p.y-d,y=2*(f*v-h*g),x=f*f+h*h,m=g*g+v*v,b={x:(v*x-h*m)/y+c,y:(f*m-g*x)/y+d};Qn(a.edge,u,p,b),s.edge=Zn(u,t,null,b),a.edge=Zn(t,p,null,b),Un(e),Un(a)}}function En(t,e){var a=t.site,n=a.x,r=a.y,i=r-e;if(!i)return n;var o=t.P;if(!o)return-1/0;a=o.site;var l=a.x,s=a.y,u=s-e;if(!u)return l;var c=l-n,d=1/i-1/u,f=c/u;return d?(-f+Math.sqrt(f*f-2*d*(c*c/(-2*u)-s+u/2+r-i/2)))/d+n:(n+l)/2}function Yn(t,e){var a=t.N;if(a)return En(a,e);var n=t.site;return n.y===e?n.x:1/0}function Bn(t){this.site=t,this.edges=[]}function Jn(t){for(var e,a,n,r,i,o,l,s,u,c,d=t[0][0],f=t[1][0],h=t[0][1],p=t[1][1],g=Ws,v=g.length;v--;)if(i=g[v],i&&i.prepare())for(l=i.edges,s=l.length,o=0;s>o;)c=l[o].end(),n=c.x,r=c.y,u=l[++o%s].start(),e=u.x,a=u.y,(ul(n-e)>Dl||ul(r-a)>Dl)&&(l.splice(o,0,new tr(Kn(i.site,c,ul(n-d)<Dl&&p-r>Dl?{x:d,y:ul(e-d)<Dl?a:p}:ul(r-p)<Dl&&f-n>Dl?{x:ul(a-p)<Dl?e:f,y:p}:ul(n-f)<Dl&&r-h>Dl?{x:f,y:ul(e-f)<Dl?a:h}:ul(r-h)<Dl&&n-d>Dl?{x:ul(a-h)<Dl?e:d,y:h}:null),i.site,null)),++s)}function qn(t,e){return e.angle-t.angle}function Xn(){ar(this),this.x=this.y=this.arc=this.site=this.cy=null}function Un(t){var e=t.P,a=t.N;if(e&&a){var n=e.site,r=t.site,i=a.site;if(n!==i){var o=r.x,l=r.y,s=n.x-o,u=n.y-l,c=i.x-o,d=i.y-l,f=2*(s*d-u*c);if(!(f>=-Pl)){var h=s*s+u*u,p=c*c+d*d,g=(d*h-u*p)/f,v=(s*p-c*h)/f,d=v+l,y=tu.pop()||new Xn;y.arc=t,y.site=r,y.x=g+o,y.y=d+Math.sqrt(g*g+v*v),y.cy=d,t.circle=y;for(var x=null,m=Ks._;m;)if(y.y<m.y||y.y===m.y&&y.x<=m.x){if(!m.L){x=m.P;break}m=m.L}else{if(!m.R){x=m;break}m=m.R}Ks.insert(x,y),x||(Zs=y)}}}}function Hn(t){var e=t.circle;e&&(e.P||(Zs=e.N),Ks.remove(e),tu.push(e),ar(e),t.circle=null)}function jn(t){for(var e,a=js,n=Ea(t[0][0],t[0][1],t[1][0],t[1][1]),r=a.length;r--;)e=a[r],(!Wn(e,t)||!n(e)||ul(e.a.x-e.b.x)<Dl&&ul(e.a.y-e.b.y)<Dl)&&(e.a=e.b=null,a.splice(r,1))}function Wn(t,e){var a=t.b;if(a)return!0;var n,r,i=t.a,o=e[0][0],l=e[1][0],s=e[0][1],u=e[1][1],c=t.l,d=t.r,f=c.x,h=c.y,p=d.x,g=d.y,v=(f+p)/2,y=(h+g)/2;if(g===h){if(o>v||v>=l)return;if(f>p){if(i){if(i.y>=u)return}else i={x:v,y:s};a={x:v,y:u}}else{if(i){if(i.y<s)return}else i={x:v,y:u};a={x:v,y:s}}}else if(n=(f-p)/(g-h),r=y-n*v,-1>n||n>1)if(f>p){if(i){if(i.y>=u)return}else i={x:(s-r)/n,y:s};a={x:(u-r)/n,y:u}}else{if(i){if(i.y<s)return}else i={x:(u-r)/n,y:u};a={x:(s-r)/n,y:s}}else if(g>h){if(i){if(i.x>=l)return}else i={x:o,y:n*o+r};a={x:l,y:n*l+r}}else{if(i){if(i.x<o)return}else i={x:l,y:n*l+r};a={x:o,y:n*o+r}}return t.a=i,t.b=a,!0}function $n(t,e){this.l=t,this.r=e,this.a=this.b=null}function Zn(t,e,a,n){var r=new $n(t,e);return js.push(r),a&&Qn(r,t,e,a),n&&Qn(r,e,t,n),Ws[t.i].edges.push(new tr(r,t,e)),Ws[e.i].edges.push(new tr(r,e,t)),r}function Kn(t,e,a){var n=new $n(t,null);return n.a=e,n.b=a,js.push(n),n}function Qn(t,e,a,n){t.a||t.b?t.l===a?t.b=n:t.a=n:(t.a=n,t.l=e,t.r=a)}function tr(t,e,a){var n=t.a,r=t.b;this.edge=t,this.site=e,this.angle=a?Math.atan2(a.y-e.y,a.x-e.x):t.l===e?Math.atan2(r.x-n.x,n.y-r.y):Math.atan2(n.x-r.x,r.y-n.y)}function er(){this._=null}function ar(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function nr(t,e){var a=e,n=e.R,r=a.U;r?r.L===a?r.L=n:r.R=n:t._=n,n.U=r,a.U=n,a.R=n.L,a.R&&(a.R.U=a),n.L=a}function rr(t,e){var a=e,n=e.L,r=a.U;r?r.L===a?r.L=n:r.R=n:t._=n,n.U=r,a.U=n,a.L=n.R,a.L&&(a.L.U=a),n.R=a}function ir(t){for(;t.L;)t=t.L;return t}function or(t,e){var a,n,r,i=t.sort(lr).pop();for(js=[],Ws=new Array(t.length),$s=new er,Ks=new er;;)if(r=Zs,i&&(!r||i.y<r.y||i.y===r.y&&i.x<r.x))(i.x!==a||i.y!==n)&&(Ws[i.i]=new Bn(i),Rn(i),a=i.x,n=i.y),i=t.pop();else{if(!r)break;Gn(r.arc)}e&&(jn(e),Jn(e));var o={cells:Ws,edges:js};return $s=Ks=js=Ws=null,o}function lr(t,e){return e.y-t.y||e.x-t.x}function sr(t,e,a){return(t.x-a.x)*(e.y-t.y)-(t.x-e.x)*(a.y-t.y)}function ur(t){return t.x}function cr(t){return t.y}function dr(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function fr(t,e,a,n,r,i){if(!t(e,a,n,r,i)){var o=.5*(a+r),l=.5*(n+i),s=e.nodes;s[0]&&fr(t,s[0],a,n,o,l),s[1]&&fr(t,s[1],o,n,r,l),s[2]&&fr(t,s[2],a,l,o,i),s[3]&&fr(t,s[3],o,l,r,i)}}function hr(t,e){t=Wo.rgb(t),e=Wo.rgb(e);var a=t.r,n=t.g,r=t.b,i=e.r-a,o=e.g-n,l=e.b-r;return function(t){return"#"+me(Math.round(a+i*t))+me(Math.round(n+o*t))+me(Math.round(r+l*t))}}function pr(t,e){var a,n={},r={};for(a in t)a in e?n[a]=yr(t[a],e[a]):r[a]=t[a];for(a in e)a in t||(r[a]=e[a]);return function(t){for(a in n)r[a]=n[a](t);return r}}function gr(t,e){return t=+t,e=+e,function(a){return t*(1-a)+e*a}}function vr(t,e){var a,n,r,i=au.lastIndex=nu.lastIndex=0,o=-1,l=[],s=[];for(t+="",e+="";(a=au.exec(t))&&(n=nu.exec(e));)(r=n.index)>i&&(r=e.slice(i,r),l[o]?l[o]+=r:l[++o]=r),(a=a[0])===(n=n[0])?l[o]?l[o]+=n:l[++o]=n:(l[++o]=null,s.push({i:o,x:gr(a,n)})),i=nu.lastIndex;return i<e.length&&(r=e.slice(i),l[o]?l[o]+=r:l[++o]=r),l.length<2?s[0]?(e=s[0].x,function(t){return e(t)+""}):function(){return e}:(e=s.length,function(t){for(var a,n=0;e>n;++n)l[(a=s[n]).i]=a.x(t);return l.join("")})}function yr(t,e){for(var a,n=Wo.interpolators.length;--n>=0&&!(a=Wo.interpolators[n](t,e)););return a}function xr(t,e){var a,n=[],r=[],i=t.length,o=e.length,l=Math.min(t.length,e.length);for(a=0;l>a;++a)n.push(yr(t[a],e[a]));for(;i>a;++a)r[a]=t[a];for(;o>a;++a)r[a]=e[a];return function(t){for(a=0;l>a;++a)r[a]=n[a](t);return r}}function mr(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function br(t){return function(e){return 1-t(1-e)}}function Ar(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function Mr(t){return t*t}function kr(t){return t*t*t}function wr(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,a=e*t;return 4*(.5>t?a:3*(t-e)+a-.75)}function Sr(t){return function(e){return Math.pow(e,t)}}function Cr(t){return 1-Math.cos(t*Nl)}function Tr(t){return Math.pow(2,10*(t-1))}function Lr(t){return 1-Math.sqrt(1-t*t)}function Nr(t,e){var a;return arguments.length<2&&(e=.45),arguments.length?a=e/Ll*Math.asin(1/t):(t=1,a=e/4),function(n){return 1+t*Math.pow(2,-10*n)*Math.sin((n-a)*Ll/e)}}function Dr(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Pr(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function _r(t,e){t=Wo.hcl(t),e=Wo.hcl(e);var a=t.h,n=t.c,r=t.l,i=e.h-a,o=e.c-n,l=e.l-r;return isNaN(o)&&(o=0,n=isNaN(n)?e.c:n),isNaN(i)?(i=0,a=isNaN(a)?e.h:a):i>180?i-=360:-180>i&&(i+=360),function(t){return ue(a+i*t,n+o*t,r+l*t)+""}}function Ir(t,e){t=Wo.hsl(t),e=Wo.hsl(e);var a=t.h,n=t.s,r=t.l,i=e.h-a,o=e.s-n,l=e.l-r;return isNaN(o)&&(o=0,n=isNaN(n)?e.s:n),isNaN(i)?(i=0,a=isNaN(a)?e.h:a):i>180?i-=360:-180>i&&(i+=360),function(t){return le(a+i*t,n+o*t,r+l*t)+""}}function Vr(t,e){t=Wo.lab(t),e=Wo.lab(e);var a=t.l,n=t.a,r=t.b,i=e.l-a,o=e.a-n,l=e.b-r;return function(t){return de(a+i*t,n+o*t,r+l*t)+""}}function Fr(t,e){return e-=t,function(a){return Math.round(t+e*a)}}function Or(t){var e=[t.a,t.b],a=[t.c,t.d],n=Gr(e),r=zr(e,a),i=Gr(Rr(a,e,-r))||0;e[0]*a[1]<a[0]*e[1]&&(e[0]*=-1,e[1]*=-1,n*=-1,r*=-1),this.rotate=(n?Math.atan2(e[1],e[0]):Math.atan2(-a[0],a[1]))*Il,this.translate=[t.e,t.f],this.scale=[n,i],this.skew=i?Math.atan2(r,i)*Il:0}function zr(t,e){return t[0]*e[0]+t[1]*e[1]}function Gr(t){var e=Math.sqrt(zr(t,t));return e&&(t[0]/=e,t[1]/=e),e}function Rr(t,e,a){return t[0]+=a*e[0],t[1]+=a*e[1],t}function Er(t,e){var a,n=[],r=[],i=Wo.transform(t),o=Wo.transform(e),l=i.translate,s=o.translate,u=i.rotate,c=o.rotate,d=i.skew,f=o.skew,h=i.scale,p=o.scale;return l[0]!=s[0]||l[1]!=s[1]?(n.push("translate(",null,",",null,")"),r.push({i:1,x:gr(l[0],s[0])},{i:3,x:gr(l[1],s[1])})):n.push(s[0]||s[1]?"translate("+s+")":""),u!=c?(u-c>180?c+=360:c-u>180&&(u+=360),r.push({i:n.push(n.pop()+"rotate(",null,")")-2,x:gr(u,c)})):c&&n.push(n.pop()+"rotate("+c+")"),d!=f?r.push({i:n.push(n.pop()+"skewX(",null,")")-2,x:gr(d,f)}):f&&n.push(n.pop()+"skewX("+f+")"),h[0]!=p[0]||h[1]!=p[1]?(a=n.push(n.pop()+"scale(",null,",",null,")"),r.push({i:a-4,x:gr(h[0],p[0])},{i:a-2,x:gr(h[1],p[1])})):(1!=p[0]||1!=p[1])&&n.push(n.pop()+"scale("+p+")"),a=r.length,function(t){for(var e,i=-1;++i<a;)n[(e=r[i]).i]=e.x(t);return n.join("")}}function Yr(t,e){return e=(e-=t=+t)||1/e,function(a){return(a-t)/e}}function Br(t,e){return e=(e-=t=+t)||1/e,function(a){return Math.max(0,Math.min(1,(a-t)/e))}}function Jr(t){for(var e=t.source,a=t.target,n=Xr(e,a),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;a!==n;)r.splice(i,0,a),a=a.parent;return r}function qr(t){for(var e=[],a=t.parent;null!=a;)e.push(t),t=a,a=a.parent;return e.push(t),e}function Xr(t,e){if(t===e)return t;for(var a=qr(t),n=qr(e),r=a.pop(),i=n.pop(),o=null;r===i;)o=r,r=a.pop(),i=n.pop();return o}function Ur(t){t.fixed|=2}function Hr(t){t.fixed&=-7}function jr(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Wr(t){t.fixed&=-5}function $r(t,e,a){var n=0,r=0;if(t.charge=0,!t.leaf)for(var i,o=t.nodes,l=o.length,s=-1;++s<l;)i=o[s],null!=i&&($r(i,e,a),t.charge+=i.charge,n+=i.charge*i.cx,r+=i.charge*i.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var u=e*a[t.point.index];t.charge+=t.pointCharge=u,n+=u*t.point.x,r+=u*t.point.y}t.cx=n/t.charge,t.cy=r/t.charge}function Zr(t,e){return Wo.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=ni,t}function Kr(t,e){for(var a=[t];null!=(t=a.pop());)if(e(t),(r=t.children)&&(n=r.length))for(var n,r;--n>=0;)a.push(r[n])}function Qr(t,e){for(var a=[t],n=[];null!=(t=a.pop());)if(n.push(t),(i=t.children)&&(r=i.length))for(var r,i,o=-1;++o<r;)a.push(i[o]);for(;null!=(t=n.pop());)e(t)}function ti(t){return t.children}function ei(t){return t.value}function ai(t,e){return e.value-t.value}function ni(t){return Wo.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function ri(t){return t.x}function ii(t){return t.y}function oi(t,e,a){t.y0=e,t.y=a}function li(t){return Wo.range(t.length)}function si(t){for(var e=-1,a=t[0].length,n=[];++e<a;)n[e]=0;return n}function ui(t){for(var e,a=1,n=0,r=t[0][1],i=t.length;i>a;++a)(e=t[a][1])>r&&(n=a,r=e);return n}function ci(t){return t.reduce(di,0)}function di(t,e){return t+e[1]}function fi(t,e){return hi(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function hi(t,e){for(var a=-1,n=+t[0],r=(t[1]-n)/e,i=[];++a<=e;)i[a]=r*a+n;return i}function pi(t){return[Wo.min(t),Wo.max(t)]}function gi(t,e){return t.value-e.value}function vi(t,e){var a=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=a,a._pack_prev=e}function yi(t,e){t._pack_next=e,e._pack_prev=t}function xi(t,e){var a=e.x-t.x,n=e.y-t.y,r=t.r+e.r;return.999*r*r>a*a+n*n}function mi(t){function e(t){c=Math.min(t.x-t.r,c),d=Math.max(t.x+t.r,d),f=Math.min(t.y-t.r,f),h=Math.max(t.y+t.r,h)}if((a=t.children)&&(u=a.length)){var a,n,r,i,o,l,s,u,c=1/0,d=-1/0,f=1/0,h=-1/0;if(a.forEach(bi),n=a[0],n.x=-n.r,n.y=0,e(n),u>1&&(r=a[1],r.x=r.r,r.y=0,e(r),u>2))for(i=a[2],ki(n,r,i),e(i),vi(n,i),n._pack_prev=i,vi(i,r),r=n._pack_next,o=3;u>o;o++){ki(n,r,i=a[o]);var p=0,g=1,v=1;for(l=r._pack_next;l!==r;l=l._pack_next,g++)if(xi(l,i)){p=1;break}if(1==p)for(s=n._pack_prev;s!==l._pack_prev&&!xi(s,i);s=s._pack_prev,v++);p?(v>g||g==v&&r.r<n.r?yi(n,r=l):yi(n=s,r),o--):(vi(n,i),r=i,e(i))}var y=(c+d)/2,x=(f+h)/2,m=0;for(o=0;u>o;o++)i=a[o],i.x-=y,i.y-=x,m=Math.max(m,i.r+Math.sqrt(i.x*i.x+i.y*i.y));t.r=m,a.forEach(Ai)}}function bi(t){t._pack_next=t._pack_prev=t}function Ai(t){delete t._pack_next,delete t._pack_prev}function Mi(t,e,a,n){var r=t.children;if(t.x=e+=n*t.x,t.y=a+=n*t.y,t.r*=n,r)for(var i=-1,o=r.length;++i<o;)Mi(r[i],e,a,n)}function ki(t,e,a){var n=t.r+a.r,r=e.x-t.x,i=e.y-t.y;if(n&&(r||i)){var o=e.r+a.r,l=r*r+i*i;o*=o,n*=n;var s=.5+(n-o)/(2*l),u=Math.sqrt(Math.max(0,2*o*(n+l)-(n-=l)*n-o*o))/(2*l);a.x=t.x+s*r+u*i,a.y=t.y+s*i-u*r}else a.x=t.x+n,a.y=t.y}function wi(t,e){return t.parent==e.parent?1:2}function Si(t){var e=t.children;return e.length?e[0]:t.t}function Ci(t){var e,a=t.children;return(e=a.length)?a[e-1]:t.t}function Ti(t,e,a){var n=a/(e.i-t.i);e.c-=n,e.s+=a,t.c+=n,e.z+=a,e.m+=a}function Li(t){for(var e,a=0,n=0,r=t.children,i=r.length;--i>=0;)e=r[i],e.z+=a,e.m+=a,a+=e.s+(n+=e.c)}function Ni(t,e,a){return t.a.parent===e.parent?t.a:a}function Di(t){return 1+Wo.max(t,function(t){return t.y})}function Pi(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function _i(t){var e=t.children;return e&&e.length?_i(e[0]):t}function Ii(t){var e,a=t.children;return a&&(e=a.length)?Ii(a[e-1]):t}function Vi(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Fi(t,e){var a=t.x+e[3],n=t.y+e[0],r=t.dx-e[1]-e[3],i=t.dy-e[0]-e[2];return 0>r&&(a+=r/2,r=0),0>i&&(n+=i/2,i=0),{x:a,y:n,dx:r,dy:i}}function Oi(t){var e=t[0],a=t[t.length-1];return a>e?[e,a]:[a,e]}function zi(t){return t.rangeExtent?t.rangeExtent():Oi(t.range())}function Gi(t,e,a,n){var r=a(t[0],t[1]),i=n(e[0],e[1]);return function(t){return i(r(t))}}function Ri(t,e){var a,n=0,r=t.length-1,i=t[n],o=t[r];return i>o&&(a=n,n=r,r=a,a=i,i=o,o=a),t[n]=e.floor(i),t[r]=e.ceil(o),t}function Ei(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:pu}function Yi(t,e,a,n){var r=[],i=[],o=0,l=Math.min(t.length,e.length)-1;for(t[l]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<=l;)r.push(a(t[o-1],t[o])),i.push(n(e[o-1],e[o]));return function(e){var a=Wo.bisect(t,e,1,l)-1;return i[a](r[a](e))}}function Bi(t,e,a,n){function r(){var r=Math.min(t.length,e.length)>2?Yi:Gi,s=n?Br:Yr;return o=r(t,e,s,a),l=r(e,t,s,yr),i}function i(t){return o(t)}var o,l;return i.invert=function(t){return l(t)},i.domain=function(e){return arguments.length?(t=e.map(Number),r()):t},i.range=function(t){return arguments.length?(e=t,r()):e},i.rangeRound=function(t){return i.range(t).interpolate(Fr)},i.clamp=function(t){return arguments.length?(n=t,r()):n},i.interpolate=function(t){return arguments.length?(a=t,r()):a},i.ticks=function(e){return Ui(t,e)},i.tickFormat=function(e,a){return Hi(t,e,a)},i.nice=function(e){return qi(t,e),r()},i.copy=function(){return Bi(t,e,a,n)},r()}function Ji(t,e){return Wo.rebind(t,e,"range","rangeRound","interpolate","clamp")}function qi(t,e){return Ri(t,Ei(Xi(t,e)[2]))}function Xi(t,e){null==e&&(e=10);var a=Oi(t),n=a[1]-a[0],r=Math.pow(10,Math.floor(Math.log(n/e)/Math.LN10)),i=e/n*r;return.15>=i?r*=10:.35>=i?r*=5:.75>=i&&(r*=2),a[0]=Math.ceil(a[0]/r)*r,a[1]=Math.floor(a[1]/r)*r+.5*r,a[2]=r,a}function Ui(t,e){return Wo.range.apply(Wo,Xi(t,e))}function Hi(t,e,a){var n=Xi(t,e);if(a){var r=as.exec(a);if(r.shift(),"s"===r[8]){var i=Wo.formatPrefix(Math.max(ul(n[0]),ul(n[1])));return r[7]||(r[7]="."+ji(i.scale(n[2]))),r[8]="f",a=Wo.format(r.join("")),function(t){return a(i.scale(t))+i.symbol}}r[7]||(r[7]="."+Wi(r[8],n)),a=r.join("")}else a=",."+ji(n[2])+"f";return Wo.format(a)}function ji(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function Wi(t,e){var a=ji(e[2]);return t in gu?Math.abs(a-ji(Math.max(ul(e[0]),ul(e[1]))))+ +("e"!==t):a-2*("%"===t)}function $i(t,e,a,n){function r(t){return(a?Math.log(0>t?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function i(t){return a?Math.pow(e,t):-Math.pow(e,-t)}function o(e){return t(r(e))}return o.invert=function(e){return i(t.invert(e))},o.domain=function(e){return arguments.length?(a=e[0]>=0,t.domain((n=e.map(Number)).map(r)),o):n},o.base=function(a){return arguments.length?(e=+a,t.domain(n.map(r)),o):e},o.nice=function(){var e=Ri(n.map(r),a?Math:yu);return t.domain(e),n=e.map(i),o},o.ticks=function(){var t=Oi(n),o=[],l=t[0],s=t[1],u=Math.floor(r(l)),c=Math.ceil(r(s)),d=e%1?2:e;if(isFinite(c-u)){if(a){for(;c>u;u++)for(var f=1;d>f;f++)o.push(i(u)*f);o.push(i(u))}else for(o.push(i(u));u++<c;)for(var f=d-1;f>0;f--)o.push(i(u)*f);for(u=0;o[u]<l;u++);for(c=o.length;o[c-1]>s;c--);o=o.slice(u,c)}return o},o.tickFormat=function(t,e){if(!arguments.length)return vu;arguments.length<2?e=vu:"function"!=typeof e&&(e=Wo.format(e));var n,l=Math.max(.1,t/o.ticks().length),s=a?(n=1e-12,Math.ceil):(n=-1e-12,Math.floor);return function(t){return t/i(s(r(t)+n))<=l?e(t):""}},o.copy=function(){return $i(t.copy(),e,a,n)},Ji(o,t)}function Zi(t,e,a){function n(e){return t(r(e))}var r=Ki(e),i=Ki(1/e);return n.invert=function(e){return i(t.invert(e))},n.domain=function(e){return arguments.length?(t.domain((a=e.map(Number)).map(r)),n):a},n.ticks=function(t){return Ui(a,t)},n.tickFormat=function(t,e){return Hi(a,t,e)},n.nice=function(t){return n.domain(qi(a,t))},n.exponent=function(o){return arguments.length?(r=Ki(e=o),i=Ki(1/e),t.domain(a.map(r)),n):e},n.copy=function(){return Zi(t.copy(),e,a)},Ji(n,t)}function Ki(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function Qi(t,e){function a(a){return i[((r.get(a)||("range"===e.t?r.set(a,t.push(a)):0/0))-1)%i.length]}function n(e,a){return Wo.range(t.length).map(function(t){return e+a*t})}var r,i,o;return a.domain=function(n){if(!arguments.length)return t;t=[],r=new l;for(var i,o=-1,s=n.length;++o<s;)r.has(i=n[o])||r.set(i,t.push(i));return a[e.t].apply(a,e.a)},a.range=function(t){return arguments.length?(i=t,o=0,e={t:"range",a:arguments},a):i},a.rangePoints=function(r,l){arguments.length<2&&(l=0);var s=r[0],u=r[1],c=(u-s)/(Math.max(1,t.length-1)+l);return i=n(t.length<2?(s+u)/2:s+c*l/2,c),o=0,e={t:"rangePoints",a:arguments},a},a.rangeBands=function(r,l,s){arguments.length<2&&(l=0),arguments.length<3&&(s=l);var u=r[1]<r[0],c=r[u-0],d=r[1-u],f=(d-c)/(t.length-l+2*s);return i=n(c+f*s,f),u&&i.reverse(),o=f*(1-l),e={t:"rangeBands",a:arguments},a},a.rangeRoundBands=function(r,l,s){arguments.length<2&&(l=0),arguments.length<3&&(s=l);var u=r[1]<r[0],c=r[u-0],d=r[1-u],f=Math.floor((d-c)/(t.length-l+2*s)),h=d-c-(t.length-l)*f;return i=n(c+Math.round(h/2),f),u&&i.reverse(),o=Math.round(f*(1-l)),e={t:"rangeRoundBands",a:arguments},a},a.rangeBand=function(){return o},a.rangeExtent=function(){return Oi(e.a[0])},a.copy=function(){return Qi(t,e)},a.domain(t)}function to(n,r){function i(){var t=0,e=r.length;for(l=[];++t<e;)l[t-1]=Wo.quantile(n,t/e);return o}function o(t){return isNaN(t=+t)?void 0:r[Wo.bisect(l,t)]}var l;return o.domain=function(r){return arguments.length?(n=r.map(e).filter(a).sort(t),i()):n},o.range=function(t){return arguments.length?(r=t,i()):r},o.quantiles=function(){return l},o.invertExtent=function(t){return t=r.indexOf(t),0>t?[0/0,0/0]:[t>0?l[t-1]:n[0],t<l.length?l[t]:n[n.length-1]]},o.copy=function(){return to(n,r)},i()}function eo(t,e,a){function n(e){return a[Math.max(0,Math.min(o,Math.floor(i*(e-t))))]}function r(){return i=a.length/(e-t),o=a.length-1,n}var i,o;return n.domain=function(a){return arguments.length?(t=+a[0],e=+a[a.length-1],r()):[t,e]},n.range=function(t){return arguments.length?(a=t,r()):a},n.invertExtent=function(e){return e=a.indexOf(e),e=0>e?0/0:e/i+t,[e,e+1/i]},n.copy=function(){return eo(t,e,a)},r()}function ao(t,e){function a(a){return a>=a?e[Wo.bisect(t,a)]:void 0}return a.domain=function(e){return arguments.length?(t=e,a):t},a.range=function(t){return arguments.length?(e=t,a):e},a.invertExtent=function(a){return a=e.indexOf(a),[t[a-1],t[a]]},a.copy=function(){return ao(t,e)},a}function no(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(a){return arguments.length?(t=a.map(e),e):t},e.ticks=function(e){return Ui(t,e)},e.tickFormat=function(e,a){return Hi(t,e,a)},e.copy=function(){return no(t)},e}function ro(t){return t.innerRadius}function io(t){return t.outerRadius}function oo(t){return t.startAngle}function lo(t){return t.endAngle}function so(t){function e(e){function o(){u.push("M",i(t(c),l))}for(var s,u=[],c=[],d=-1,f=e.length,h=Se(a),p=Se(n);++d<f;)r.call(this,s=e[d],d)?c.push([+h.call(this,s,d),+p.call(this,s,d)]):c.length&&(o(),c=[]);return c.length&&o(),u.length?u.join(""):null}var a=Ln,n=Nn,r=Ta,i=uo,o=i.key,l=.7;return e.x=function(t){return arguments.length?(a=t,e):a},e.y=function(t){return arguments.length?(n=t,e):n},e.defined=function(t){return arguments.length?(r=t,e):r},e.interpolate=function(t){return arguments.length?(o="function"==typeof t?i=t:(i=wu.get(t)||uo).key,e):o},e.tension=function(t){return arguments.length?(l=t,e):l},e}function uo(t){return t.join("L")}function co(t){return uo(t)+"Z"}function fo(t){for(var e=0,a=t.length,n=t[0],r=[n[0],",",n[1]];++e<a;)r.push("H",(n[0]+(n=t[e])[0])/2,"V",n[1]);return a>1&&r.push("H",n[0]),r.join("")}function ho(t){for(var e=0,a=t.length,n=t[0],r=[n[0],",",n[1]];++e<a;)r.push("V",(n=t[e])[1],"H",n[0]);return r.join("")}function po(t){for(var e=0,a=t.length,n=t[0],r=[n[0],",",n[1]];++e<a;)r.push("H",(n=t[e])[0],"V",n[1]);return r.join("")}function go(t,e){return t.length<4?uo(t):t[1]+xo(t.slice(1,t.length-1),mo(t,e))}function vo(t,e){return t.length<3?uo(t):t[0]+xo((t.push(t[0]),t),mo([t[t.length-2]].concat(t,[t[1]]),e))}function yo(t,e){return t.length<3?uo(t):t[0]+xo(t,mo(t,e))}function xo(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return uo(t);var a=t.length!=e.length,n="",r=t[0],i=t[1],o=e[0],l=o,s=1;if(a&&(n+="Q"+(i[0]-2*o[0]/3)+","+(i[1]-2*o[1]/3)+","+i[0]+","+i[1],r=t[1],s=2),e.length>1){l=e[1],i=t[s],s++,n+="C"+(r[0]+o[0])+","+(r[1]+o[1])+","+(i[0]-l[0])+","+(i[1]-l[1])+","+i[0]+","+i[1];for(var u=2;u<e.length;u++,s++)i=t[s],l=e[u],n+="S"+(i[0]-l[0])+","+(i[1]-l[1])+","+i[0]+","+i[1]}if(a){var c=t[s];n+="Q"+(i[0]+2*l[0]/3)+","+(i[1]+2*l[1]/3)+","+c[0]+","+c[1]}return n}function mo(t,e){for(var a,n=[],r=(1-e)/2,i=t[0],o=t[1],l=1,s=t.length;++l<s;)a=i,i=o,o=t[l],n.push([r*(o[0]-a[0]),r*(o[1]-a[1])]);return n}function bo(t){if(t.length<3)return uo(t);var e=1,a=t.length,n=t[0],r=n[0],i=n[1],o=[r,r,r,(n=t[1])[0]],l=[i,i,i,n[1]],s=[r,",",i,"L",wo(Tu,o),",",wo(Tu,l)];for(t.push(t[a-1]);++e<=a;)n=t[e],o.shift(),o.push(n[0]),l.shift(),l.push(n[1]),So(s,o,l);return t.pop(),s.push("L",n),s.join("")}function Ao(t){if(t.length<4)return uo(t);for(var e,a=[],n=-1,r=t.length,i=[0],o=[0];++n<3;)e=t[n],i.push(e[0]),o.push(e[1]);for(a.push(wo(Tu,i)+","+wo(Tu,o)),--n;++n<r;)e=t[n],i.shift(),i.push(e[0]),o.shift(),o.push(e[1]),So(a,i,o);return a.join("")}function Mo(t){for(var e,a,n=-1,r=t.length,i=r+4,o=[],l=[];++n<4;)a=t[n%r],o.push(a[0]),l.push(a[1]);for(e=[wo(Tu,o),",",wo(Tu,l)],--n;++n<i;)a=t[n%r],o.shift(),o.push(a[0]),l.shift(),l.push(a[1]),So(e,o,l);return e.join("")}function ko(t,e){var a=t.length-1;if(a)for(var n,r,i=t[0][0],o=t[0][1],l=t[a][0]-i,s=t[a][1]-o,u=-1;++u<=a;)n=t[u],r=u/a,n[0]=e*n[0]+(1-e)*(i+r*l),n[1]=e*n[1]+(1-e)*(o+r*s);return bo(t)}function wo(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function So(t,e,a){t.push("C",wo(Su,e),",",wo(Su,a),",",wo(Cu,e),",",wo(Cu,a),",",wo(Tu,e),",",wo(Tu,a))}function Co(t,e){return(e[1]-t[1])/(e[0]-t[0])}function To(t){for(var e=0,a=t.length-1,n=[],r=t[0],i=t[1],o=n[0]=Co(r,i);++e<a;)n[e]=(o+(o=Co(r=i,i=t[e+1])))/2;return n[e]=o,n}function Lo(t){for(var e,a,n,r,i=[],o=To(t),l=-1,s=t.length-1;++l<s;)e=Co(t[l],t[l+1]),ul(e)<Dl?o[l]=o[l+1]=0:(a=o[l]/e,n=o[l+1]/e,r=a*a+n*n,r>9&&(r=3*e/Math.sqrt(r),o[l]=r*a,o[l+1]=r*n));for(l=-1;++l<=s;)r=(t[Math.min(s,l+1)][0]-t[Math.max(0,l-1)][0])/(6*(1+o[l]*o[l])),i.push([r||0,o[l]*r||0]);return i}function No(t){return t.length<3?uo(t):t[0]+xo(t,Lo(t))}function Do(t){for(var e,a,n,r=-1,i=t.length;++r<i;)e=t[r],a=e[0],n=e[1]+Mu,e[0]=a*Math.cos(n),e[1]=a*Math.sin(n);return t}function Po(t){function e(e){function s(){g.push("M",l(t(y),d),c,u(t(v.reverse()),d),"Z")}for(var f,h,p,g=[],v=[],y=[],x=-1,m=e.length,b=Se(a),A=Se(r),M=a===n?function(){return h}:Se(n),k=r===i?function(){return p}:Se(i);++x<m;)o.call(this,f=e[x],x)?(v.push([h=+b.call(this,f,x),p=+A.call(this,f,x)]),y.push([+M.call(this,f,x),+k.call(this,f,x)])):v.length&&(s(),v=[],y=[]);return v.length&&s(),g.length?g.join(""):null}var a=Ln,n=Ln,r=0,i=Nn,o=Ta,l=uo,s=l.key,u=l,c="L",d=.7;return e.x=function(t){return arguments.length?(a=n=t,e):n},e.x0=function(t){return arguments.length?(a=t,e):a},e.x1=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(r=i=t,e):i},e.y0=function(t){return arguments.length?(r=t,e):r},e.y1=function(t){return arguments.length?(i=t,e):i},e.defined=function(t){return arguments.length?(o=t,e):o},e.interpolate=function(t){return arguments.length?(s="function"==typeof t?l=t:(l=wu.get(t)||uo).key,u=l.reverse||l,c=l.closed?"M":"L",e):s},e.tension=function(t){return arguments.length?(d=t,e):d},e}function _o(t){return t.radius}function Io(t){return[t.x,t.y]}function Vo(t){return function(){var e=t.apply(this,arguments),a=e[0],n=e[1]+Mu;return[a*Math.cos(n),a*Math.sin(n)]}}function Fo(){return 64
}function Oo(){return"circle"}function zo(t){var e=Math.sqrt(t/Tl);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function Go(t,e){return pl(t,Iu),t.id=e,t}function Ro(t,e,a,n){var r=t.id;return R(t,"function"==typeof a?function(t,i,o){t.__transition__[r].tween.set(e,n(a.call(t,t.__data__,i,o)))}:(a=n(a),function(t){t.__transition__[r].tween.set(e,a)}))}function Eo(t){return null==t&&(t=""),function(){this.textContent=t}}function Yo(t,e,a,n){var r=t.__transition__||(t.__transition__={active:0,count:0}),i=r[a];if(!i){var o=n.time;i=r[a]={tween:new l,time:o,ease:n.ease,delay:n.delay,duration:n.duration},++r.count,Wo.timer(function(n){function l(n){return r.active>a?u():(r.active=a,i.event&&i.event.start.call(t,c,e),i.tween.forEach(function(a,n){(n=n.call(t,c,e))&&g.push(n)}),void Wo.timer(function(){return p.c=s(n||1)?Ta:s,1},0,o))}function s(n){if(r.active!==a)return u();for(var o=n/h,l=d(o),s=g.length;s>0;)g[--s].call(t,l);return o>=1?(i.event&&i.event.end.call(t,c,e),u()):void 0}function u(){return--r.count?delete r[a]:delete t.__transition__,1}var c=t.__data__,d=i.ease,f=i.delay,h=i.duration,p=Ql,g=[];return p.t=f+o,n>=f?l(n-f):void(p.c=l)},0,o)}}function Bo(t,e,a){t.attr("transform",function(t){var n=e(t);return"translate("+(isFinite(n)?n:a(t))+",0)"})}function Jo(t,e,a){t.attr("transform",function(t){var n=e(t);return"translate(0,"+(isFinite(n)?n:a(t))+")"})}function qo(t){return t.toISOString()}function Xo(t,e,a){function n(e){return t(e)}function r(t,a){var n=t[1]-t[0],r=n/a,i=Wo.bisect(Bu,r);return i==Bu.length?[e.year,Xi(t.map(function(t){return t/31536e6}),a)[2]]:i?e[r/Bu[i-1]<Bu[i]/r?i-1:i]:[Xu,Xi(t,a)[2]]}return n.invert=function(e){return Uo(t.invert(e))},n.domain=function(e){return arguments.length?(t.domain(e),n):t.domain().map(Uo)},n.nice=function(t,e){function a(a){return!isNaN(a)&&!t.range(a,Uo(+a+1),e).length}var i=n.domain(),o=Oi(i),l=null==t?r(o,10):"number"==typeof t&&r(o,t);return l&&(t=l[0],e=l[1]),n.domain(Ri(i,e>1?{floor:function(e){for(;a(e=t.floor(e));)e=Uo(e-1);return e},ceil:function(e){for(;a(e=t.ceil(e));)e=Uo(+e+1);return e}}:t))},n.ticks=function(t,e){var a=Oi(n.domain()),i=null==t?r(a,10):"number"==typeof t?r(a,t):!t.range&&[{range:t},e];return i&&(t=i[0],e=i[1]),t.range(a[0],Uo(+a[1]+1),1>e?1:e)},n.tickFormat=function(){return a},n.copy=function(){return Xo(t.copy(),e,a)},Ji(n,t)}function Uo(t){return new Date(t)}function Ho(t){return JSON.parse(t.responseText)}function jo(t){var e=Ko.createRange();return e.selectNode(Ko.body),e.createContextualFragment(t.responseText)}var Wo={version:"3.4.13"};Date.now||(Date.now=function(){return+new Date});var $o=[].slice,Zo=function(t){return $o.call(t)},Ko=document,Qo=Ko.documentElement,tl=window;try{Zo(Qo.childNodes)[0].nodeType}catch(el){Zo=function(t){for(var e=t.length,a=new Array(e);e--;)a[e]=t[e];return a}}try{Ko.createElement("div").style.setProperty("opacity",0,"")}catch(al){var nl=tl.Element.prototype,rl=nl.setAttribute,il=nl.setAttributeNS,ol=tl.CSSStyleDeclaration.prototype,ll=ol.setProperty;nl.setAttribute=function(t,e){rl.call(this,t,e+"")},nl.setAttributeNS=function(t,e,a){il.call(this,t,e,a+"")},ol.setProperty=function(t,e,a){ll.call(this,t,e+"",a)}}Wo.ascending=t,Wo.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:0/0},Wo.min=function(t,e){var a,n,r=-1,i=t.length;if(1===arguments.length){for(;++r<i&&!(null!=(a=t[r])&&a>=a);)a=void 0;for(;++r<i;)null!=(n=t[r])&&a>n&&(a=n)}else{for(;++r<i&&!(null!=(a=e.call(t,t[r],r))&&a>=a);)a=void 0;for(;++r<i;)null!=(n=e.call(t,t[r],r))&&a>n&&(a=n)}return a},Wo.max=function(t,e){var a,n,r=-1,i=t.length;if(1===arguments.length){for(;++r<i&&!(null!=(a=t[r])&&a>=a);)a=void 0;for(;++r<i;)null!=(n=t[r])&&n>a&&(a=n)}else{for(;++r<i&&!(null!=(a=e.call(t,t[r],r))&&a>=a);)a=void 0;for(;++r<i;)null!=(n=e.call(t,t[r],r))&&n>a&&(a=n)}return a},Wo.extent=function(t,e){var a,n,r,i=-1,o=t.length;if(1===arguments.length){for(;++i<o&&!(null!=(a=r=t[i])&&a>=a);)a=r=void 0;for(;++i<o;)null!=(n=t[i])&&(a>n&&(a=n),n>r&&(r=n))}else{for(;++i<o&&!(null!=(a=r=e.call(t,t[i],i))&&a>=a);)a=void 0;for(;++i<o;)null!=(n=e.call(t,t[i],i))&&(a>n&&(a=n),n>r&&(r=n))}return[a,r]},Wo.sum=function(t,e){var n,r=0,i=t.length,o=-1;if(1===arguments.length)for(;++o<i;)a(n=+t[o])&&(r+=n);else for(;++o<i;)a(n=+e.call(t,t[o],o))&&(r+=n);return r},Wo.mean=function(t,n){var r,i=0,o=t.length,l=-1,s=o;if(1===arguments.length)for(;++l<o;)a(r=e(t[l]))?i+=r:--s;else for(;++l<o;)a(r=e(n.call(t,t[l],l)))?i+=r:--s;return s?i/s:void 0},Wo.quantile=function(t,e){var a=(t.length-1)*e+1,n=Math.floor(a),r=+t[n-1],i=a-n;return i?r+i*(t[n]-r):r},Wo.median=function(n,r){var i,o=[],l=n.length,s=-1;if(1===arguments.length)for(;++s<l;)a(i=e(n[s]))&&o.push(i);else for(;++s<l;)a(i=e(r.call(n,n[s],s)))&&o.push(i);return o.length?Wo.quantile(o.sort(t),.5):void 0};var sl=n(t);Wo.bisectLeft=sl.left,Wo.bisect=Wo.bisectRight=sl.right,Wo.bisector=function(e){return n(1===e.length?function(a,n){return t(e(a),n)}:e)},Wo.shuffle=function(t){for(var e,a,n=t.length;n;)a=0|Math.random()*n--,e=t[n],t[n]=t[a],t[a]=e;return t},Wo.permute=function(t,e){for(var a=e.length,n=new Array(a);a--;)n[a]=t[e[a]];return n},Wo.pairs=function(t){for(var e,a=0,n=t.length-1,r=t[0],i=new Array(0>n?0:n);n>a;)i[a]=[e=r,r=t[++a]];return i},Wo.zip=function(){if(!(n=arguments.length))return[];for(var t=-1,e=Wo.min(arguments,r),a=new Array(e);++t<e;)for(var n,i=-1,o=a[t]=new Array(n);++i<n;)o[i]=arguments[i][t];return a},Wo.transpose=function(t){return Wo.zip.apply(Wo,t)},Wo.keys=function(t){var e=[];for(var a in t)e.push(a);return e},Wo.values=function(t){var e=[];for(var a in t)e.push(t[a]);return e},Wo.entries=function(t){var e=[];for(var a in t)e.push({key:a,value:t[a]});return e},Wo.merge=function(t){for(var e,a,n,r=t.length,i=-1,o=0;++i<r;)o+=t[i].length;for(a=new Array(o);--r>=0;)for(n=t[r],e=n.length;--e>=0;)a[--o]=n[e];return a};var ul=Math.abs;Wo.range=function(t,e,a){if(arguments.length<3&&(a=1,arguments.length<2&&(e=t,t=0)),1/0===(e-t)/a)throw new Error("infinite range");var n,r=[],o=i(ul(a)),l=-1;if(t*=o,e*=o,a*=o,0>a)for(;(n=t+a*++l)>e;)r.push(n/o);else for(;(n=t+a*++l)<e;)r.push(n/o);return r},Wo.map=function(t){var e=new l;if(t instanceof l)t.forEach(function(t,a){e.set(t,a)});else for(var a in t)e.set(a,t[a]);return e};var cl="__proto__",dl="\x00";o(l,{has:c,get:function(t){return this._[s(t)]},set:function(t,e){return this._[s(t)]=e},remove:d,keys:f,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:u(e),value:this._[e]});return t},size:h,empty:p,forEach:function(t){for(var e in this._)t.call(this,u(e),this._[e])}}),Wo.nest=function(){function t(e,o,s){if(s>=i.length)return n?n.call(r,o):a?o.sort(a):o;for(var u,c,d,f,h=-1,p=o.length,g=i[s++],v=new l;++h<p;)(f=v.get(u=g(c=o[h])))?f.push(c):v.set(u,[c]);return e?(c=e(),d=function(a,n){c.set(a,t(e,n,s))}):(c={},d=function(a,n){c[a]=t(e,n,s)}),v.forEach(d),c}function e(t,a){if(a>=i.length)return t;var n=[],r=o[a++];return t.forEach(function(t,r){n.push({key:t,values:e(r,a)})}),r?n.sort(function(t,e){return r(t.key,e.key)}):n}var a,n,r={},i=[],o=[];return r.map=function(e,a){return t(a,e,0)},r.entries=function(a){return e(t(Wo.map,a,0),0)},r.key=function(t){return i.push(t),r},r.sortKeys=function(t){return o[i.length-1]=t,r},r.sortValues=function(t){return a=t,r},r.rollup=function(t){return n=t,r},r},Wo.set=function(t){var e=new g;if(t)for(var a=0,n=t.length;n>a;++a)e.add(t[a]);return e},o(g,{has:c,add:function(t){return this._[s(t+="")]=!0,t},remove:d,values:f,size:h,empty:p,forEach:function(t){for(var e in this._)t.call(this,u(e))}}),Wo.behavior={},Wo.rebind=function(t,e){for(var a,n=1,r=arguments.length;++n<r;)t[a=arguments[n]]=v(t,e,e[a]);return t};var fl=["webkit","ms","moz","Moz","o","O"];Wo.dispatch=function(){for(var t=new m,e=-1,a=arguments.length;++e<a;)t[arguments[e]]=b(t);return t},m.prototype.on=function(t,e){var a=t.indexOf("."),n="";if(a>=0&&(n=t.slice(a+1),t=t.slice(0,a)),t)return arguments.length<2?this[t].on(n):this[t].on(n,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(n,null);return this}},Wo.event=null,Wo.requote=function(t){return t.replace(hl,"\\$&")};var hl=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,pl={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var a in e)t[a]=e[a]},gl=function(t,e){return e.querySelector(t)},vl=function(t,e){return e.querySelectorAll(t)},yl=Qo.matches||Qo[y(Qo,"matchesSelector")],xl=function(t,e){return yl.call(t,e)};"function"==typeof Sizzle&&(gl=function(t,e){return Sizzle(t,e)[0]||null},vl=Sizzle,xl=Sizzle.matchesSelector),Wo.selection=function(){return Ml};var ml=Wo.selection.prototype=[];ml.select=function(t){var e,a,n,r,i=[];t=S(t);for(var o=-1,l=this.length;++o<l;){i.push(e=[]),e.parentNode=(n=this[o]).parentNode;for(var s=-1,u=n.length;++s<u;)(r=n[s])?(e.push(a=t.call(r,r.__data__,s,o)),a&&"__data__"in r&&(a.__data__=r.__data__)):e.push(null)}return w(i)},ml.selectAll=function(t){var e,a,n=[];t=C(t);for(var r=-1,i=this.length;++r<i;)for(var o=this[r],l=-1,s=o.length;++l<s;)(a=o[l])&&(n.push(e=Zo(t.call(a,a.__data__,l,r))),e.parentNode=a);return w(n)};var bl={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Wo.ns={prefix:bl,qualify:function(t){var e=t.indexOf(":"),a=t;return e>=0&&(a=t.slice(0,e),t=t.slice(e+1)),bl.hasOwnProperty(a)?{space:bl[a],local:t}:t}},ml.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var a=this.node();return t=Wo.ns.qualify(t),t.local?a.getAttributeNS(t.space,t.local):a.getAttribute(t)}for(e in t)this.each(T(e,t[e]));return this}return this.each(T(t,e))},ml.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var a=this.node(),n=(t=D(t)).length,r=-1;if(e=a.classList){for(;++r<n;)if(!e.contains(t[r]))return!1}else for(e=a.getAttribute("class");++r<n;)if(!N(t[r]).test(e))return!1;return!0}for(e in t)this.each(P(e,t[e]));return this}return this.each(P(t,e))},ml.style=function(t,e,a){var n=arguments.length;if(3>n){if("string"!=typeof t){2>n&&(e="");for(a in t)this.each(I(a,t[a],e));return this}if(2>n)return tl.getComputedStyle(this.node(),null).getPropertyValue(t);a=""}return this.each(I(t,e,a))},ml.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(V(e,t[e]));return this}return this.each(V(t,e))},ml.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},ml.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},ml.append=function(t){return t=F(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},ml.insert=function(t,e){return t=F(t),e=S(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},ml.remove=function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},ml.data=function(t,e){function a(t,a){var n,r,i,o=t.length,d=a.length,f=Math.min(o,d),h=new Array(d),p=new Array(d),g=new Array(o);if(e){var v,y=new l,x=new Array(o);for(n=-1;++n<o;)y.has(v=e.call(r=t[n],r.__data__,n))?g[n]=r:y.set(v,r),x[n]=v;for(n=-1;++n<d;)(r=y.get(v=e.call(a,i=a[n],n)))?r!==!0&&(h[n]=r,r.__data__=i):p[n]=O(i),y.set(v,!0);for(n=-1;++n<o;)y.get(x[n])!==!0&&(g[n]=t[n])}else{for(n=-1;++n<f;)r=t[n],i=a[n],r?(r.__data__=i,h[n]=r):p[n]=O(i);for(;d>n;++n)p[n]=O(a[n]);for(;o>n;++n)g[n]=t[n]}p.update=h,p.parentNode=h.parentNode=g.parentNode=t.parentNode,s.push(p),u.push(h),c.push(g)}var n,r,i=-1,o=this.length;if(!arguments.length){for(t=new Array(o=(n=this[0]).length);++i<o;)(r=n[i])&&(t[i]=r.__data__);return t}var s=E([]),u=w([]),c=w([]);if("function"==typeof t)for(;++i<o;)a(n=this[i],t.call(n,n.parentNode.__data__,i));else for(;++i<o;)a(n=this[i],t);return u.enter=function(){return s},u.exit=function(){return c},u},ml.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},ml.filter=function(t){var e,a,n,r=[];"function"!=typeof t&&(t=z(t));for(var i=0,o=this.length;o>i;i++){r.push(e=[]),e.parentNode=(a=this[i]).parentNode;for(var l=0,s=a.length;s>l;l++)(n=a[l])&&t.call(n,n.__data__,l,i)&&e.push(n)}return w(r)},ml.order=function(){for(var t=-1,e=this.length;++t<e;)for(var a,n=this[t],r=n.length-1,i=n[r];--r>=0;)(a=n[r])&&(i&&i!==a.nextSibling&&i.parentNode.insertBefore(a,i),i=a);return this},ml.sort=function(t){t=G.apply(this,arguments);for(var e=-1,a=this.length;++e<a;)this[e].sort(t);return this.order()},ml.each=function(t){return R(this,function(e,a,n){t.call(e,e.__data__,a,n)})},ml.call=function(t){var e=Zo(arguments);return t.apply(e[0]=this,e),this},ml.empty=function(){return!this.node()},ml.node=function(){for(var t=0,e=this.length;e>t;t++)for(var a=this[t],n=0,r=a.length;r>n;n++){var i=a[n];if(i)return i}return null},ml.size=function(){var t=0;return R(this,function(){++t}),t};var Al=[];Wo.selection.enter=E,Wo.selection.enter.prototype=Al,Al.append=ml.append,Al.empty=ml.empty,Al.node=ml.node,Al.call=ml.call,Al.size=ml.size,Al.select=function(t){for(var e,a,n,r,i,o=[],l=-1,s=this.length;++l<s;){n=(r=this[l]).update,o.push(e=[]),e.parentNode=r.parentNode;for(var u=-1,c=r.length;++u<c;)(i=r[u])?(e.push(n[u]=a=t.call(r.parentNode,i.__data__,u,l)),a.__data__=i.__data__):e.push(null)}return w(o)},Al.insert=function(t,e){return arguments.length<2&&(e=Y(this)),ml.insert.call(this,t,e)},ml.transition=function(){for(var t,e,a=Nu||++Vu,n=[],r=Du||{time:Date.now(),ease:wr,delay:0,duration:250},i=-1,o=this.length;++i<o;){n.push(t=[]);for(var l=this[i],s=-1,u=l.length;++s<u;)(e=l[s])&&Yo(e,s,a,r),t.push(e)}return Go(n,a)},ml.interrupt=function(){return this.each(B)},Wo.select=function(t){var e=["string"==typeof t?gl(t,Ko):t];return e.parentNode=Qo,w([e])},Wo.selectAll=function(t){var e=Zo("string"==typeof t?vl(t,Ko):t);return e.parentNode=Qo,w([e])};var Ml=Wo.select(Qo);ml.on=function(t,e,a){var n=arguments.length;if(3>n){if("string"!=typeof t){2>n&&(e=!1);for(a in t)this.each(J(a,t[a],e));return this}if(2>n)return(n=this.node()["__on"+t])&&n._;a=!1}return this.each(J(t,e,a))};var kl=Wo.map({mouseenter:"mouseover",mouseleave:"mouseout"});kl.forEach(function(t){"on"+t in Ko&&kl.remove(t)});var wl="onselectstart"in Ko?null:y(Qo.style,"userSelect"),Sl=0;Wo.mouse=function(t){return H(t,M())};var Cl=/WebKit/.test(tl.navigator.userAgent)?-1:0;Wo.touch=function(t,e,a){if(arguments.length<3&&(a=e,e=M().changedTouches),e)for(var n,r=0,i=e.length;i>r;++r)if((n=e[r]).identifier===a)return H(t,n)},Wo.behavior.drag=function(){function t(){this.on("mousedown.drag",r).on("touchstart.drag",i)}function e(t,e,r,i,o){return function(){function l(){var t,a,n=e(f,g);n&&(t=n[0]-m[0],a=n[1]-m[1],p|=t|a,m=n,h({type:"drag",x:n[0]+u[0],y:n[1]+u[1],dx:t,dy:a}))}function s(){e(f,g)&&(y.on(i+v,null).on(o+v,null),x(p&&Wo.event.target===d),h({type:"dragend"}))}var u,c=this,d=Wo.event.target,f=c.parentNode,h=a.of(c,arguments),p=0,g=t(),v=".drag"+(null==g?"":"-"+g),y=Wo.select(r()).on(i+v,l).on(o+v,s),x=U(),m=e(f,g);n?(u=n.apply(c,arguments),u=[u.x-m[0],u.y-m[1]]):u=[0,0],h({type:"dragstart"})}}var a=k(t,"drag","dragstart","dragend"),n=null,r=e(x,Wo.mouse,$,"mousemove","mouseup"),i=e(j,Wo.touch,W,"touchmove","touchend");return t.origin=function(e){return arguments.length?(n=e,t):n},Wo.rebind(t,a,"on")},Wo.touches=function(t,e){return arguments.length<2&&(e=M().touches),e?Zo(e).map(function(e){var a=H(t,e);return a.identifier=e.identifier,a}):[]};var Tl=Math.PI,Ll=2*Tl,Nl=Tl/2,Dl=1e-6,Pl=Dl*Dl,_l=Tl/180,Il=180/Tl,Vl=Math.SQRT2,Fl=2,Ol=4;Wo.interpolateZoom=function(t,e){function a(t){var e=t*x;if(y){var a=ae(g),o=i/(Fl*f)*(a*ne(Vl*e+g)-ee(g));return[n+o*u,r+o*c,i*a/ae(Vl*e+g)]}return[n+t*u,r+t*c,i*Math.exp(Vl*e)]}var n=t[0],r=t[1],i=t[2],o=e[0],l=e[1],s=e[2],u=o-n,c=l-r,d=u*u+c*c,f=Math.sqrt(d),h=(s*s-i*i+Ol*d)/(2*i*Fl*f),p=(s*s-i*i-Ol*d)/(2*s*Fl*f),g=Math.log(Math.sqrt(h*h+1)-h),v=Math.log(Math.sqrt(p*p+1)-p),y=v-g,x=(y||Math.log(s/i))/Vl;return a.duration=1e3*x,a},Wo.behavior.zoom=function(){function t(t){t.on(T,u).on(Rl+".zoom",d).on("dblclick.zoom",f).on(D,c)}function e(t){return[(t[0]-w.x)/w.k,(t[1]-w.y)/w.k]}function a(t){return[t[0]*w.k+w.x,t[1]*w.k+w.y]}function n(t){w.k=Math.max(C[0],Math.min(C[1],t))}function r(t,e){e=a(e),w.x+=t[0]-e[0],w.y+=t[1]-e[1]}function i(){m&&m.domain(x.range().map(function(t){return(t-w.x)/w.k}).map(x.invert)),M&&M.domain(b.range().map(function(t){return(t-w.y)/w.k}).map(b.invert))}function o(t){t({type:"zoomstart"})}function l(t){i(),t({type:"zoom",scale:w.k,translate:[w.x,w.y]})}function s(t){t({type:"zoomend"})}function u(){function t(){c=1,r(Wo.mouse(n),f),l(u)}function a(){d.on(L,null).on(N,null),h(c&&Wo.event.target===i),s(u)}var n=this,i=Wo.event.target,u=P.of(n,arguments),c=0,d=Wo.select(tl).on(L,t).on(N,a),f=e(Wo.mouse(n)),h=U();B.call(n),o(u)}function c(){function t(){var t=Wo.touches(h);return f=w.k,t.forEach(function(t){t.identifier in g&&(g[t.identifier]=e(t))}),t}function a(){var e=Wo.event.target;Wo.select(e).on(m,i).on(b,d),M.push(e);for(var a=Wo.event.changedTouches,o=0,s=a.length;s>o;++o)g[a[o].identifier]=null;var u=t(),c=Date.now();if(1===u.length){if(500>c-y){var f=u[0],h=g[f.identifier];n(2*w.k),r(f,h),A(),l(p)}y=c}else if(u.length>1){var f=u[0],x=u[1],k=f[0]-x[0],S=f[1]-x[1];v=k*k+S*S}}function i(){for(var t,e,a,i,o=Wo.touches(h),s=0,u=o.length;u>s;++s,i=null)if(a=o[s],i=g[a.identifier]){if(e)break;t=a,e=i}if(i){var c=(c=a[0]-t[0])*c+(c=a[1]-t[1])*c,d=v&&Math.sqrt(c/v);t=[(t[0]+a[0])/2,(t[1]+a[1])/2],e=[(e[0]+i[0])/2,(e[1]+i[1])/2],n(d*f)}y=null,r(t,e),l(p)}function d(){if(Wo.event.touches.length){for(var e=Wo.event.changedTouches,a=0,n=e.length;n>a;++a)delete g[e[a].identifier];for(var r in g)return void t()}Wo.selectAll(M).on(x,null),k.on(T,u).on(D,c),S(),s(p)}var f,h=this,p=P.of(h,arguments),g={},v=0,x=".zoom-"+Wo.event.changedTouches[0].identifier,m="touchmove"+x,b="touchend"+x,M=[],k=Wo.select(h),S=U();B.call(h),a(),o(p),k.on(T,null).on(D,a)}function d(){var t=P.of(this,arguments);v?clearTimeout(v):(h=e(p=g||Wo.mouse(this)),B.call(this),o(t)),v=setTimeout(function(){v=null,s(t)},50),A(),n(Math.pow(2,.002*zl())*w.k),r(p,h),l(t)}function f(){var t=P.of(this,arguments),a=Wo.mouse(this),i=e(a),u=Math.log(w.k)/Math.LN2;o(t),n(Math.pow(2,Wo.event.shiftKey?Math.ceil(u)-1:Math.floor(u)+1)),r(a,i),l(t),s(t)}var h,p,g,v,y,x,m,b,M,w={x:0,y:0,k:1},S=[960,500],C=Gl,T="mousedown.zoom",L="mousemove.zoom",N="mouseup.zoom",D="touchstart.zoom",P=k(t,"zoomstart","zoom","zoomend");return t.event=function(t){t.each(function(){var t=P.of(this,arguments),e=w;Nu?Wo.select(this).transition().each("start.zoom",function(){w=this.__chart__||{x:0,y:0,k:1},o(t)}).tween("zoom:zoom",function(){var a=S[0],n=S[1],r=a/2,i=n/2,o=Wo.interpolateZoom([(r-w.x)/w.k,(i-w.y)/w.k,a/w.k],[(r-e.x)/e.k,(i-e.y)/e.k,a/e.k]);return function(e){var n=o(e),s=a/n[2];this.__chart__=w={x:r-n[0]*s,y:i-n[1]*s,k:s},l(t)}}).each("end.zoom",function(){s(t)}):(this.__chart__=w,o(t),l(t),s(t))})},t.translate=function(e){return arguments.length?(w={x:+e[0],y:+e[1],k:w.k},i(),t):[w.x,w.y]},t.scale=function(e){return arguments.length?(w={x:w.x,y:w.y,k:+e},i(),t):w.k},t.scaleExtent=function(e){return arguments.length?(C=null==e?Gl:[+e[0],+e[1]],t):C},t.center=function(e){return arguments.length?(g=e&&[+e[0],+e[1]],t):g},t.size=function(e){return arguments.length?(S=e&&[+e[0],+e[1]],t):S},t.x=function(e){return arguments.length?(m=e,x=e.copy(),w={x:0,y:0,k:1},t):m},t.y=function(e){return arguments.length?(M=e,b=e.copy(),w={x:0,y:0,k:1},t):M},Wo.rebind(t,P,"on")};var zl,Gl=[0,1/0],Rl="onwheel"in Ko?(zl=function(){return-Wo.event.deltaY*(Wo.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Ko?(zl=function(){return Wo.event.wheelDelta},"mousewheel"):(zl=function(){return-Wo.event.detail},"MozMousePixelScroll");Wo.color=ie,ie.prototype.toString=function(){return this.rgb()+""},Wo.hsl=oe;var El=oe.prototype=new ie;El.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new oe(this.h,this.s,this.l/t)},El.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new oe(this.h,this.s,t*this.l)},El.rgb=function(){return le(this.h,this.s,this.l)},Wo.hcl=se;var Yl=se.prototype=new ie;Yl.brighter=function(t){return new se(this.h,this.c,Math.min(100,this.l+Bl*(arguments.length?t:1)))},Yl.darker=function(t){return new se(this.h,this.c,Math.max(0,this.l-Bl*(arguments.length?t:1)))},Yl.rgb=function(){return ue(this.h,this.c,this.l).rgb()},Wo.lab=ce;var Bl=18,Jl=.95047,ql=1,Xl=1.08883,Ul=ce.prototype=new ie;Ul.brighter=function(t){return new ce(Math.min(100,this.l+Bl*(arguments.length?t:1)),this.a,this.b)},Ul.darker=function(t){return new ce(Math.max(0,this.l-Bl*(arguments.length?t:1)),this.a,this.b)},Ul.rgb=function(){return de(this.l,this.a,this.b)},Wo.rgb=ve;var Hl=ve.prototype=new ie;Hl.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,a=this.g,n=this.b,r=30;return e||a||n?(e&&r>e&&(e=r),a&&r>a&&(a=r),n&&r>n&&(n=r),new ve(Math.min(255,e/t),Math.min(255,a/t),Math.min(255,n/t))):new ve(r,r,r)},Hl.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new ve(t*this.r,t*this.g,t*this.b)},Hl.hsl=function(){return Ae(this.r,this.g,this.b)},Hl.toString=function(){return"#"+me(this.r)+me(this.g)+me(this.b)};var jl=Wo.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});jl.forEach(function(t,e){jl.set(t,ye(e))}),Wo.functor=Se,Wo.xhr=Te(Ce),Wo.dsv=function(t,e){function a(t,a,i){arguments.length<3&&(i=a,a=null);var o=Le(t,e,null==a?n:r(a),i);return o.row=function(t){return arguments.length?o.response(null==(a=t)?n:r(t)):a},o}function n(t){return a.parse(t.responseText)}function r(t){return function(e){return a.parse(e.responseText,t)}}function i(e){return e.map(o).join(t)}function o(t){return l.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var l=new RegExp('["'+t+"\n]"),s=t.charCodeAt(0);return a.parse=function(t,e){var n;return a.parseRows(t,function(t,a){if(n)return n(t,a-1);var r=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");n=e?function(t,a){return e(r(t),a)}:r})},a.parseRows=function(t,e){function a(){if(c>=u)return o;if(r)return r=!1,i;var e=c;if(34===t.charCodeAt(e)){for(var a=e;a++<u;)if(34===t.charCodeAt(a)){if(34!==t.charCodeAt(a+1))break;++a}c=a+2;var n=t.charCodeAt(a+1);return 13===n?(r=!0,10===t.charCodeAt(a+2)&&++c):10===n&&(r=!0),t.slice(e+1,a).replace(/""/g,'"')}for(;u>c;){var n=t.charCodeAt(c++),l=1;if(10===n)r=!0;else if(13===n)r=!0,10===t.charCodeAt(c)&&(++c,++l);else if(n!==s)continue;return t.slice(e,c-l)}return t.slice(e)}for(var n,r,i={},o={},l=[],u=t.length,c=0,d=0;(n=a())!==o;){for(var f=[];n!==i&&n!==o;)f.push(n),n=a();e&&null==(f=e(f,d++))||l.push(f)}return l},a.format=function(e){if(Array.isArray(e[0]))return a.formatRows(e);var n=new g,r=[];return e.forEach(function(t){for(var e in t)n.has(e)||r.push(n.add(e))}),[r.map(o).join(t)].concat(e.map(function(e){return r.map(function(t){return o(e[t])}).join(t)})).join("\n")},a.formatRows=function(t){return t.map(i).join("\n")},a},Wo.csv=Wo.dsv(",","text/csv"),Wo.tsv=Wo.dsv("	","text/tab-separated-values");var Wl,$l,Zl,Kl,Ql,ts=tl[y(tl,"requestAnimationFrame")]||function(t){setTimeout(t,17)};Wo.timer=function(t,e,a){var n=arguments.length;2>n&&(e=0),3>n&&(a=Date.now());var r=a+e,i={c:t,t:r,f:!1,n:null};$l?$l.n=i:Wl=i,$l=i,Zl||(Kl=clearTimeout(Kl),Zl=1,ts(Pe))},Wo.timer.flush=function(){_e(),Ie()},Wo.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var es=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(Fe);Wo.formatPrefix=function(t,e){var a=0;return t&&(0>t&&(t*=-1),e&&(t=Wo.round(t,Ve(t,e))),a=1+Math.floor(1e-12+Math.log(t)/Math.LN10),a=Math.max(-24,Math.min(24,3*Math.floor((a-1)/3)))),es[8+a/3]};var as=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ns=Wo.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=Wo.round(t,Ve(t,e))).toFixed(Math.max(0,Math.min(20,Ve(t*(1+1e-15),e))))}}),rs=Wo.time={},is=Date;Ge.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){os.setUTCDate.apply(this._,arguments)},setDay:function(){os.setUTCDay.apply(this._,arguments)},setFullYear:function(){os.setUTCFullYear.apply(this._,arguments)},setHours:function(){os.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){os.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){os.setUTCMinutes.apply(this._,arguments)},setMonth:function(){os.setUTCMonth.apply(this._,arguments)},setSeconds:function(){os.setUTCSeconds.apply(this._,arguments)},setTime:function(){os.setTime.apply(this._,arguments)}};var os=Date.prototype;rs.year=Re(function(t){return t=rs.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),rs.years=rs.year.range,rs.years.utc=rs.year.utc.range,rs.day=Re(function(t){var e=new is(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),rs.days=rs.day.range,rs.days.utc=rs.day.utc.range,rs.dayOfYear=function(t){var e=rs.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var a=rs[t]=Re(function(t){return(t=rs.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var a=rs.year(t).getDay();return Math.floor((rs.dayOfYear(t)+(a+e)%7)/7)-(a!==e)});rs[t+"s"]=a.range,rs[t+"s"].utc=a.utc.range,rs[t+"OfYear"]=function(t){var a=rs.year(t).getDay();return Math.floor((rs.dayOfYear(t)+(a+e)%7)/7)}}),rs.week=rs.sunday,rs.weeks=rs.sunday.range,rs.weeks.utc=rs.sunday.utc.range,rs.weekOfYear=rs.sundayOfYear;var ls={"-":"",_:" ",0:"0"},ss=/^\s*\d+/,us=/^%/;Wo.locale=function(t){return{numberFormat:Oe(t),timeFormat:Ye(t)}};var cs=Wo.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Wo.format=cs.numberFormat,Wo.geo={},sa.prototype={s:0,t:0,add:function(t){ua(t,this.t,ds),ua(ds.s,this.s,this),this.s?this.t+=ds.t:this.s=ds.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ds=new sa;Wo.geo.stream=function(t,e){t&&fs.hasOwnProperty(t.type)?fs[t.type](t,e):ca(t,e)};var fs={Feature:function(t,e){ca(t.geometry,e)},FeatureCollection:function(t,e){for(var a=t.features,n=-1,r=a.length;++n<r;)ca(a[n].geometry,e)}},hs={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var a=t.coordinates,n=-1,r=a.length;++n<r;)t=a[n],e.point(t[0],t[1],t[2])},LineString:function(t,e){da(t.coordinates,e,0)},MultiLineString:function(t,e){for(var a=t.coordinates,n=-1,r=a.length;++n<r;)da(a[n],e,0)},Polygon:function(t,e){fa(t.coordinates,e)},MultiPolygon:function(t,e){for(var a=t.coordinates,n=-1,r=a.length;++n<r;)fa(a[n],e)},GeometryCollection:function(t,e){for(var a=t.geometries,n=-1,r=a.length;++n<r;)ca(a[n],e)}};Wo.geo.area=function(t){return ps=0,Wo.geo.stream(t,vs),ps};var ps,gs=new sa,vs={sphere:function(){ps+=4*Tl},point:x,lineStart:x,lineEnd:x,polygonStart:function(){gs.reset(),vs.lineStart=ha},polygonEnd:function(){var t=2*gs;ps+=0>t?4*Tl+t:t,vs.lineStart=vs.lineEnd=vs.point=x}};Wo.geo.bounds=function(){function t(t,e){m.push(b=[c=t,f=t]),d>e&&(d=e),e>h&&(h=e)}function e(e,a){var n=pa([e*_l,a*_l]);if(y){var r=va(y,n),i=[r[1],-r[0],0],o=va(i,r);ma(o),o=ba(o);var s=e-p,u=s>0?1:-1,g=o[0]*Il*u,v=ul(s)>180;if(v^(g>u*p&&u*e>g)){var x=o[1]*Il;x>h&&(h=x)}else if(g=(g+360)%360-180,v^(g>u*p&&u*e>g)){var x=-o[1]*Il;d>x&&(d=x)}else d>a&&(d=a),a>h&&(h=a);v?p>e?l(c,e)>l(c,f)&&(f=e):l(e,f)>l(c,f)&&(c=e):f>=c?(c>e&&(c=e),e>f&&(f=e)):e>p?l(c,e)>l(c,f)&&(f=e):l(e,f)>l(c,f)&&(c=e)
}else t(e,a);y=n,p=e}function a(){A.point=e}function n(){b[0]=c,b[1]=f,A.point=t,y=null}function r(t,a){if(y){var n=t-p;x+=ul(n)>180?n+(n>0?360:-360):n}else g=t,v=a;vs.point(t,a),e(t,a)}function i(){vs.lineStart()}function o(){r(g,v),vs.lineEnd(),ul(x)>Dl&&(c=-(f=180)),b[0]=c,b[1]=f,y=null}function l(t,e){return(e-=t)<0?e+360:e}function s(t,e){return t[0]-e[0]}function u(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var c,d,f,h,p,g,v,y,x,m,b,A={point:t,lineStart:a,lineEnd:n,polygonStart:function(){A.point=r,A.lineStart=i,A.lineEnd=o,x=0,vs.polygonStart()},polygonEnd:function(){vs.polygonEnd(),A.point=t,A.lineStart=a,A.lineEnd=n,0>gs?(c=-(f=180),d=-(h=90)):x>Dl?h=90:-Dl>x&&(d=-90),b[0]=c,b[1]=f}};return function(t){h=f=-(c=d=1/0),m=[],Wo.geo.stream(t,A);var e=m.length;if(e){m.sort(s);for(var a,n=1,r=m[0],i=[r];e>n;++n)a=m[n],u(a[0],r)||u(a[1],r)?(l(r[0],a[1])>l(r[0],r[1])&&(r[1]=a[1]),l(a[0],r[1])>l(r[0],r[1])&&(r[0]=a[0])):i.push(r=a);for(var o,a,p=-1/0,e=i.length-1,n=0,r=i[e];e>=n;r=a,++n)a=i[n],(o=l(r[1],a[0]))>p&&(p=o,c=a[0],f=r[1])}return m=b=null,1/0===c||1/0===d?[[0/0,0/0],[0/0,0/0]]:[[c,d],[f,h]]}}(),Wo.geo.centroid=function(t){ys=xs=ms=bs=As=Ms=ks=ws=Ss=Cs=Ts=0,Wo.geo.stream(t,Ls);var e=Ss,a=Cs,n=Ts,r=e*e+a*a+n*n;return Pl>r&&(e=Ms,a=ks,n=ws,Dl>xs&&(e=ms,a=bs,n=As),r=e*e+a*a+n*n,Pl>r)?[0/0,0/0]:[Math.atan2(a,e)*Il,te(n/Math.sqrt(r))*Il]};var ys,xs,ms,bs,As,Ms,ks,ws,Ss,Cs,Ts,Ls={sphere:x,point:Ma,lineStart:wa,lineEnd:Sa,polygonStart:function(){Ls.lineStart=Ca},polygonEnd:function(){Ls.lineStart=wa}},Ns=Pa(Ta,Fa,za,[-Tl,-Tl/2]),Ds=1e9;Wo.geo.clipExtent=function(){var t,e,a,n,r,i,o={stream:function(t){return r&&(r.valid=!1),r=i(t),r.valid=!0,r},extent:function(l){return arguments.length?(i=Ya(t=+l[0][0],e=+l[0][1],a=+l[1][0],n=+l[1][1]),r&&(r.valid=!1,r=null),o):[[t,e],[a,n]]}};return o.extent([[0,0],[960,500]])},(Wo.geo.conicEqualArea=function(){return Ja(qa)}).raw=qa,Wo.geo.albers=function(){return Wo.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Wo.geo.albersUsa=function(){function t(t){var i=t[0],o=t[1];return e=null,a(i,o),e||(n(i,o),e)||r(i,o),e}var e,a,n,r,i=Wo.geo.albers(),o=Wo.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=Wo.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s={point:function(t,a){e=[t,a]}};return t.invert=function(t){var e=i.scale(),a=i.translate(),n=(t[0]-a[0])/e,r=(t[1]-a[1])/e;return(r>=.12&&.234>r&&n>=-.425&&-.214>n?o:r>=.166&&.234>r&&n>=-.214&&-.115>n?l:i).invert(t)},t.stream=function(t){var e=i.stream(t),a=o.stream(t),n=l.stream(t);return{point:function(t,r){e.point(t,r),a.point(t,r),n.point(t,r)},sphere:function(){e.sphere(),a.sphere(),n.sphere()},lineStart:function(){e.lineStart(),a.lineStart(),n.lineStart()},lineEnd:function(){e.lineEnd(),a.lineEnd(),n.lineEnd()},polygonStart:function(){e.polygonStart(),a.polygonStart(),n.polygonStart()},polygonEnd:function(){e.polygonEnd(),a.polygonEnd(),n.polygonEnd()}}},t.precision=function(e){return arguments.length?(i.precision(e),o.precision(e),l.precision(e),t):i.precision()},t.scale=function(e){return arguments.length?(i.scale(e),o.scale(.35*e),l.scale(e),t.translate(i.translate())):i.scale()},t.translate=function(e){if(!arguments.length)return i.translate();var u=i.scale(),c=+e[0],d=+e[1];return a=i.translate(e).clipExtent([[c-.455*u,d-.238*u],[c+.455*u,d+.238*u]]).stream(s).point,n=o.translate([c-.307*u,d+.201*u]).clipExtent([[c-.425*u+Dl,d+.12*u+Dl],[c-.214*u-Dl,d+.234*u-Dl]]).stream(s).point,r=l.translate([c-.205*u,d+.212*u]).clipExtent([[c-.214*u+Dl,d+.166*u+Dl],[c-.115*u-Dl,d+.234*u-Dl]]).stream(s).point,t},t.scale(1070)};var Ps,_s,Is,Vs,Fs,Os,zs={point:x,lineStart:x,lineEnd:x,polygonStart:function(){_s=0,zs.lineStart=Xa},polygonEnd:function(){zs.lineStart=zs.lineEnd=zs.point=x,Ps+=ul(_s/2)}},Gs={point:Ua,lineStart:x,lineEnd:x,polygonStart:x,polygonEnd:x},Rs={point:Wa,lineStart:$a,lineEnd:Za,polygonStart:function(){Rs.lineStart=Ka},polygonEnd:function(){Rs.point=Wa,Rs.lineStart=$a,Rs.lineEnd=Za}};Wo.geo.path=function(){function t(t){return t&&("function"==typeof l&&i.pointRadius(+l.apply(this,arguments)),o&&o.valid||(o=r(i)),Wo.geo.stream(t,o)),i.result()}function e(){return o=null,t}var a,n,r,i,o,l=4.5;return t.area=function(t){return Ps=0,Wo.geo.stream(t,r(zs)),Ps},t.centroid=function(t){return ms=bs=As=Ms=ks=ws=Ss=Cs=Ts=0,Wo.geo.stream(t,r(Rs)),Ts?[Ss/Ts,Cs/Ts]:ws?[Ms/ws,ks/ws]:As?[ms/As,bs/As]:[0/0,0/0]},t.bounds=function(t){return Fs=Os=-(Is=Vs=1/0),Wo.geo.stream(t,r(Gs)),[[Is,Vs],[Fs,Os]]},t.projection=function(t){return arguments.length?(r=(a=t)?t.stream||en(t):Ce,e()):a},t.context=function(t){return arguments.length?(i=null==(n=t)?new Ha:new Qa(t),"function"!=typeof l&&i.pointRadius(l),e()):n},t.pointRadius=function(e){return arguments.length?(l="function"==typeof e?e:(i.pointRadius(+e),+e),t):l},t.projection(Wo.geo.albersUsa()).context(null)},Wo.geo.transform=function(t){return{stream:function(e){var a=new an(e);for(var n in t)a[n]=t[n];return a}}},an.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Wo.geo.projection=rn,Wo.geo.projectionMutator=on,(Wo.geo.equirectangular=function(){return rn(sn)}).raw=sn.invert=sn,Wo.geo.rotation=function(t){function e(e){return e=t(e[0]*_l,e[1]*_l),e[0]*=Il,e[1]*=Il,e}return t=cn(t[0]%360*_l,t[1]*_l,t.length>2?t[2]*_l:0),e.invert=function(e){return e=t.invert(e[0]*_l,e[1]*_l),e[0]*=Il,e[1]*=Il,e},e},un.invert=sn,Wo.geo.circle=function(){function t(){var t="function"==typeof n?n.apply(this,arguments):n,e=cn(-t[0]*_l,-t[1]*_l,0).invert,r=[];return a(null,null,1,{point:function(t,a){r.push(t=e(t,a)),t[0]*=Il,t[1]*=Il}}),{type:"Polygon",coordinates:[r]}}var e,a,n=[0,0],r=6;return t.origin=function(e){return arguments.length?(n=e,t):n},t.angle=function(n){return arguments.length?(a=pn((e=+n)*_l,r*_l),t):e},t.precision=function(n){return arguments.length?(a=pn(e*_l,(r=+n)*_l),t):r},t.angle(90)},Wo.geo.distance=function(t,e){var a,n=(e[0]-t[0])*_l,r=t[1]*_l,i=e[1]*_l,o=Math.sin(n),l=Math.cos(n),s=Math.sin(r),u=Math.cos(r),c=Math.sin(i),d=Math.cos(i);return Math.atan2(Math.sqrt((a=d*o)*a+(a=u*c-s*d*l)*a),s*c+u*d*l)},Wo.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return Wo.range(Math.ceil(i/v)*v,r,v).map(f).concat(Wo.range(Math.ceil(u/y)*y,s,y).map(h)).concat(Wo.range(Math.ceil(n/p)*p,a,p).filter(function(t){return ul(t%v)>Dl}).map(c)).concat(Wo.range(Math.ceil(l/g)*g,o,g).filter(function(t){return ul(t%y)>Dl}).map(d))}var a,n,r,i,o,l,s,u,c,d,f,h,p=10,g=p,v=90,y=360,x=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[f(i).concat(h(s).slice(1),f(r).reverse().slice(1),h(u).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(i=+e[0][0],r=+e[1][0],u=+e[0][1],s=+e[1][1],i>r&&(e=i,i=r,r=e),u>s&&(e=u,u=s,s=e),t.precision(x)):[[i,u],[r,s]]},t.minorExtent=function(e){return arguments.length?(n=+e[0][0],a=+e[1][0],l=+e[0][1],o=+e[1][1],n>a&&(e=n,n=a,a=e),l>o&&(e=l,l=o,o=e),t.precision(x)):[[n,l],[a,o]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(v=+e[0],y=+e[1],t):[v,y]},t.minorStep=function(e){return arguments.length?(p=+e[0],g=+e[1],t):[p,g]},t.precision=function(e){return arguments.length?(x=+e,c=vn(l,o,90),d=yn(n,a,x),f=vn(u,s,90),h=yn(i,r,x),t):x},t.majorExtent([[-180,-90+Dl],[180,90-Dl]]).minorExtent([[-180,-80-Dl],[180,80+Dl]])},Wo.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||n.apply(this,arguments),a||r.apply(this,arguments)]}}var e,a,n=xn,r=mn;return t.distance=function(){return Wo.geo.distance(e||n.apply(this,arguments),a||r.apply(this,arguments))},t.source=function(a){return arguments.length?(n=a,e="function"==typeof a?null:a,t):n},t.target=function(e){return arguments.length?(r=e,a="function"==typeof e?null:e,t):r},t.precision=function(){return arguments.length?t:0},t},Wo.geo.interpolate=function(t,e){return bn(t[0]*_l,t[1]*_l,e[0]*_l,e[1]*_l)},Wo.geo.length=function(t){return Es=0,Wo.geo.stream(t,Ys),Es};var Es,Ys={sphere:x,point:x,lineStart:An,lineEnd:x,polygonStart:x,polygonEnd:x},Bs=Mn(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(Wo.geo.azimuthalEqualArea=function(){return rn(Bs)}).raw=Bs;var Js=Mn(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},Ce);(Wo.geo.azimuthalEquidistant=function(){return rn(Js)}).raw=Js,(Wo.geo.conicConformal=function(){return Ja(kn)}).raw=kn,(Wo.geo.conicEquidistant=function(){return Ja(wn)}).raw=wn;var qs=Mn(function(t){return 1/t},Math.atan);(Wo.geo.gnomonic=function(){return rn(qs)}).raw=qs,Sn.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Nl]},(Wo.geo.mercator=function(){return Cn(Sn)}).raw=Sn;var Xs=Mn(function(){return 1},Math.asin);(Wo.geo.orthographic=function(){return rn(Xs)}).raw=Xs;var Us=Mn(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(Wo.geo.stereographic=function(){return rn(Us)}).raw=Us,Tn.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Nl]},(Wo.geo.transverseMercator=function(){var t=Cn(Tn),e=t.center,a=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return t?a([t[0],t[1],t.length>2?t[2]+90:90]):(t=a(),[t[0],t[1],t[2]-90])},a([0,0,90])}).raw=Tn,Wo.geom={},Wo.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,r=Se(a),i=Se(n),o=t.length,l=[],s=[];for(e=0;o>e;e++)l.push([+r.call(this,t[e],e),+i.call(this,t[e],e),e]);for(l.sort(Pn),e=0;o>e;e++)s.push([l[e][0],-l[e][1]]);var u=Dn(l),c=Dn(s),d=c[0]===u[0],f=c[c.length-1]===u[u.length-1],h=[];for(e=u.length-1;e>=0;--e)h.push(t[l[u[e]][2]]);for(e=+d;e<c.length-f;++e)h.push(t[l[c[e]][2]]);return h}var a=Ln,n=Nn;return arguments.length?e(t):(e.x=function(t){return arguments.length?(a=t,e):a},e.y=function(t){return arguments.length?(n=t,e):n},e)},Wo.geom.polygon=function(t){return pl(t,Hs),t};var Hs=Wo.geom.polygon.prototype=[];Hs.area=function(){for(var t,e=-1,a=this.length,n=this[a-1],r=0;++e<a;)t=n,n=this[e],r+=t[1]*n[0]-t[0]*n[1];return.5*r},Hs.centroid=function(t){var e,a,n=-1,r=this.length,i=0,o=0,l=this[r-1];for(arguments.length||(t=-1/(6*this.area()));++n<r;)e=l,l=this[n],a=e[0]*l[1]-l[0]*e[1],i+=(e[0]+l[0])*a,o+=(e[1]+l[1])*a;return[i*t,o*t]},Hs.clip=function(t){for(var e,a,n,r,i,o,l=Vn(t),s=-1,u=this.length-Vn(this),c=this[u-1];++s<u;){for(e=t.slice(),t.length=0,r=this[s],i=e[(n=e.length-l)-1],a=-1;++a<n;)o=e[a],_n(o,c,r)?(_n(i,c,r)||t.push(In(i,o,c,r)),t.push(o)):_n(i,c,r)&&t.push(In(i,o,c,r)),i=o;l&&t.push(t[0]),c=r}return t};var js,Ws,$s,Zs,Ks,Qs=[],tu=[];Bn.prototype.prepare=function(){for(var t,e=this.edges,a=e.length;a--;)t=e[a].edge,t.b&&t.a||e.splice(a,1);return e.sort(qn),e.length},tr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},er.prototype={insert:function(t,e){var a,n,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;a=t}else this._?(t=ir(this._),e.P=null,e.N=t,t.P=t.L=e,a=t):(e.P=e.N=null,this._=e,a=null);for(e.L=e.R=null,e.U=a,e.C=!0,t=e;a&&a.C;)n=a.U,a===n.L?(r=n.R,r&&r.C?(a.C=r.C=!1,n.C=!0,t=n):(t===a.R&&(nr(this,a),t=a,a=t.U),a.C=!1,n.C=!0,rr(this,n))):(r=n.L,r&&r.C?(a.C=r.C=!1,n.C=!0,t=n):(t===a.L&&(rr(this,a),t=a,a=t.U),a.C=!1,n.C=!0,nr(this,n))),a=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,a,n,r=t.U,i=t.L,o=t.R;if(a=i?o?ir(o):i:o,r?r.L===t?r.L=a:r.R=a:this._=a,i&&o?(n=a.C,a.C=t.C,a.L=i,i.U=a,a!==o?(r=a.U,a.U=t.U,t=a.R,r.L=t,a.R=o,o.U=a):(a.U=r,r=a,t=a.R)):(n=t.C,t=a),t&&(t.U=r),!n){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===r.L){if(e=r.R,e.C&&(e.C=!1,r.C=!0,nr(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,rr(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,nr(this,r),t=this._;break}}else if(e=r.L,e.C&&(e.C=!1,r.C=!0,rr(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,nr(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,rr(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}},Wo.geom.voronoi=function(t){function e(t){var e=new Array(t.length),n=l[0][0],r=l[0][1],i=l[1][0],o=l[1][1];return or(a(t),l).cells.forEach(function(a,l){var s=a.edges,u=a.site,c=e[l]=s.length?s.map(function(t){var e=t.start();return[e.x,e.y]}):u.x>=n&&u.x<=i&&u.y>=r&&u.y<=o?[[n,o],[i,o],[i,r],[n,r]]:[];c.point=t[l]}),e}function a(t){return t.map(function(t,e){return{x:Math.round(i(t,e)/Dl)*Dl,y:Math.round(o(t,e)/Dl)*Dl,i:e}})}var n=Ln,r=Nn,i=n,o=r,l=eu;return t?e(t):(e.links=function(t){return or(a(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return or(a(t)).cells.forEach(function(a,n){for(var r,i,o=a.site,l=a.edges.sort(qn),s=-1,u=l.length,c=l[u-1].edge,d=c.l===o?c.r:c.l;++s<u;)r=c,i=d,c=l[s].edge,d=c.l===o?c.r:c.l,n<i.i&&n<d.i&&sr(o,i,d)<0&&e.push([t[n],t[i.i],t[d.i]])}),e},e.x=function(t){return arguments.length?(i=Se(n=t),e):n},e.y=function(t){return arguments.length?(o=Se(r=t),e):r},e.clipExtent=function(t){return arguments.length?(l=null==t?eu:t,e):l===eu?null:l},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):l===eu?null:l&&l[1]},e)};var eu=[[-1e6,-1e6],[1e6,1e6]];Wo.geom.delaunay=function(t){return Wo.geom.voronoi().triangles(t)},Wo.geom.quadtree=function(t,e,a,n,r){function i(t){function i(t,e,a,n,r,i,o,l){if(!isNaN(a)&&!isNaN(n))if(t.leaf){var s=t.x,c=t.y;if(null!=s)if(ul(s-a)+ul(c-n)<.01)u(t,e,a,n,r,i,o,l);else{var d=t.point;t.x=t.y=t.point=null,u(t,d,s,c,r,i,o,l),u(t,e,a,n,r,i,o,l)}else t.x=a,t.y=n,t.point=e}else u(t,e,a,n,r,i,o,l)}function u(t,e,a,n,r,o,l,s){var u=.5*(r+l),c=.5*(o+s),d=a>=u,f=n>=c,h=(f<<1)+d;t.leaf=!1,t=t.nodes[h]||(t.nodes[h]=dr()),d?r=u:l=u,f?o=c:s=c,i(t,e,a,n,r,o,l,s)}var c,d,f,h,p,g,v,y,x,m=Se(l),b=Se(s);if(null!=e)g=e,v=a,y=n,x=r;else if(y=x=-(g=v=1/0),d=[],f=[],p=t.length,o)for(h=0;p>h;++h)c=t[h],c.x<g&&(g=c.x),c.y<v&&(v=c.y),c.x>y&&(y=c.x),c.y>x&&(x=c.y),d.push(c.x),f.push(c.y);else for(h=0;p>h;++h){var A=+m(c=t[h],h),M=+b(c,h);g>A&&(g=A),v>M&&(v=M),A>y&&(y=A),M>x&&(x=M),d.push(A),f.push(M)}var k=y-g,w=x-v;k>w?x=v+k:y=g+w;var S=dr();if(S.add=function(t){i(S,t,+m(t,++h),+b(t,h),g,v,y,x)},S.visit=function(t){fr(t,S,g,v,y,x)},h=-1,null==e){for(;++h<p;)i(S,t[h],d[h],f[h],g,v,y,x);--h}else t.forEach(S.add);return d=f=t=c=null,S}var o,l=Ln,s=Nn;return(o=arguments.length)?(l=ur,s=cr,3===o&&(r=a,n=e,a=e=0),i(t)):(i.x=function(t){return arguments.length?(l=t,i):l},i.y=function(t){return arguments.length?(s=t,i):s},i.extent=function(t){return arguments.length?(null==t?e=a=n=r=null:(e=+t[0][0],a=+t[0][1],n=+t[1][0],r=+t[1][1]),i):null==e?null:[[e,a],[n,r]]},i.size=function(t){return arguments.length?(null==t?e=a=n=r=null:(e=a=0,n=+t[0],r=+t[1]),i):null==e?null:[n-e,r-a]},i)},Wo.interpolateRgb=hr,Wo.interpolateObject=pr,Wo.interpolateNumber=gr,Wo.interpolateString=vr;var au=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,nu=new RegExp(au.source,"g");Wo.interpolate=yr,Wo.interpolators=[function(t,e){var a=typeof e;return("string"===a?jl.has(e)||/^(#|rgb\(|hsl\()/.test(e)?hr:vr:e instanceof ie?hr:Array.isArray(e)?xr:"object"===a&&isNaN(e)?pr:gr)(t,e)}],Wo.interpolateArray=xr;var ru=function(){return Ce},iu=Wo.map({linear:ru,poly:Sr,quad:function(){return Mr},cubic:function(){return kr},sin:function(){return Cr},exp:function(){return Tr},circle:function(){return Lr},elastic:Nr,back:Dr,bounce:function(){return Pr}}),ou=Wo.map({"in":Ce,out:br,"in-out":Ar,"out-in":function(t){return Ar(br(t))}});Wo.ease=function(t){var e=t.indexOf("-"),a=e>=0?t.slice(0,e):t,n=e>=0?t.slice(e+1):"in";return a=iu.get(a)||ru,n=ou.get(n)||Ce,mr(n(a.apply(null,$o.call(arguments,1))))},Wo.interpolateHcl=_r,Wo.interpolateHsl=Ir,Wo.interpolateLab=Vr,Wo.interpolateRound=Fr,Wo.transform=function(t){var e=Ko.createElementNS(Wo.ns.prefix.svg,"g");return(Wo.transform=function(t){if(null!=t){e.setAttribute("transform",t);var a=e.transform.baseVal.consolidate()}return new Or(a?a.matrix:lu)})(t)},Or.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var lu={a:1,b:0,c:0,d:1,e:0,f:0};Wo.interpolateTransform=Er,Wo.layout={},Wo.layout.bundle=function(){return function(t){for(var e=[],a=-1,n=t.length;++a<n;)e.push(Jr(t[a]));return e}},Wo.layout.chord=function(){function t(){var t,u,d,f,h,p={},g=[],v=Wo.range(i),y=[];for(a=[],n=[],t=0,f=-1;++f<i;){for(u=0,h=-1;++h<i;)u+=r[f][h];g.push(u),y.push(Wo.range(i)),t+=u}for(o&&v.sort(function(t,e){return o(g[t],g[e])}),l&&y.forEach(function(t,e){t.sort(function(t,a){return l(r[e][t],r[e][a])})}),t=(Ll-c*i)/t,u=0,f=-1;++f<i;){for(d=u,h=-1;++h<i;){var x=v[f],m=y[x][h],b=r[x][m],A=u,M=u+=b*t;p[x+"-"+m]={index:x,subindex:m,startAngle:A,endAngle:M,value:b}}n[x]={index:x,startAngle:d,endAngle:u,value:(u-d)/t},u+=c}for(f=-1;++f<i;)for(h=f-1;++h<i;){var k=p[f+"-"+h],w=p[h+"-"+f];(k.value||w.value)&&a.push(k.value<w.value?{source:w,target:k}:{source:k,target:w})}s&&e()}function e(){a.sort(function(t,e){return s((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var a,n,r,i,o,l,s,u={},c=0;return u.matrix=function(t){return arguments.length?(i=(r=t)&&r.length,a=n=null,u):r},u.padding=function(t){return arguments.length?(c=t,a=n=null,u):c},u.sortGroups=function(t){return arguments.length?(o=t,a=n=null,u):o},u.sortSubgroups=function(t){return arguments.length?(l=t,a=null,u):l},u.sortChords=function(t){return arguments.length?(s=t,a&&e(),u):s},u.chords=function(){return a||t(),a},u.groups=function(){return n||t(),n},u},Wo.layout.force=function(){function t(t){return function(e,a,n,r){if(e.point!==t){var i=e.cx-t.x,o=e.cy-t.y,l=r-a,s=i*i+o*o;if(s>l*l/v){if(p>s){var u=e.charge/s;t.px-=i*u,t.py-=o*u}return!0}if(e.point&&s&&p>s){var u=e.pointCharge/s;t.px-=i*u,t.py-=o*u}}return!e.charge}}function e(t){t.px=Wo.event.x,t.py=Wo.event.y,l.resume()}var a,n,r,i,o,l={},s=Wo.dispatch("start","tick","end"),u=[1,1],c=.9,d=su,f=uu,h=-30,p=cu,g=.1,v=.64,y=[],x=[];return l.tick=function(){if((n*=.99)<.005)return s.end({type:"end",alpha:n=0}),!0;var e,a,l,d,f,p,v,m,b,A=y.length,M=x.length;for(a=0;M>a;++a)l=x[a],d=l.source,f=l.target,m=f.x-d.x,b=f.y-d.y,(p=m*m+b*b)&&(p=n*i[a]*((p=Math.sqrt(p))-r[a])/p,m*=p,b*=p,f.x-=m*(v=d.weight/(f.weight+d.weight)),f.y-=b*v,d.x+=m*(v=1-v),d.y+=b*v);if((v=n*g)&&(m=u[0]/2,b=u[1]/2,a=-1,v))for(;++a<A;)l=y[a],l.x+=(m-l.x)*v,l.y+=(b-l.y)*v;if(h)for($r(e=Wo.geom.quadtree(y),n,o),a=-1;++a<A;)(l=y[a]).fixed||e.visit(t(l));for(a=-1;++a<A;)l=y[a],l.fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*c,l.y-=(l.py-(l.py=l.y))*c);s.tick({type:"tick",alpha:n})},l.nodes=function(t){return arguments.length?(y=t,l):y},l.links=function(t){return arguments.length?(x=t,l):x},l.size=function(t){return arguments.length?(u=t,l):u},l.linkDistance=function(t){return arguments.length?(d="function"==typeof t?t:+t,l):d},l.distance=l.linkDistance,l.linkStrength=function(t){return arguments.length?(f="function"==typeof t?t:+t,l):f},l.friction=function(t){return arguments.length?(c=+t,l):c},l.charge=function(t){return arguments.length?(h="function"==typeof t?t:+t,l):h},l.chargeDistance=function(t){return arguments.length?(p=t*t,l):Math.sqrt(p)},l.gravity=function(t){return arguments.length?(g=+t,l):g},l.theta=function(t){return arguments.length?(v=t*t,l):Math.sqrt(v)},l.alpha=function(t){return arguments.length?(t=+t,n?n=t>0?t:0:t>0&&(s.start({type:"start",alpha:n=t}),Wo.timer(l.tick)),l):n},l.start=function(){function t(t,n){if(!a){for(a=new Array(s),l=0;s>l;++l)a[l]=[];for(l=0;u>l;++l){var r=x[l];a[r.source.index].push(r.target),a[r.target.index].push(r.source)}}for(var i,o=a[e],l=-1,u=o.length;++l<u;)if(!isNaN(i=o[l][t]))return i;return Math.random()*n}var e,a,n,s=y.length,c=x.length,p=u[0],g=u[1];for(e=0;s>e;++e)(n=y[e]).index=e,n.weight=0;for(e=0;c>e;++e)n=x[e],"number"==typeof n.source&&(n.source=y[n.source]),"number"==typeof n.target&&(n.target=y[n.target]),++n.source.weight,++n.target.weight;for(e=0;s>e;++e)n=y[e],isNaN(n.x)&&(n.x=t("x",p)),isNaN(n.y)&&(n.y=t("y",g)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);if(r=[],"function"==typeof d)for(e=0;c>e;++e)r[e]=+d.call(this,x[e],e);else for(e=0;c>e;++e)r[e]=d;if(i=[],"function"==typeof f)for(e=0;c>e;++e)i[e]=+f.call(this,x[e],e);else for(e=0;c>e;++e)i[e]=f;if(o=[],"function"==typeof h)for(e=0;s>e;++e)o[e]=+h.call(this,y[e],e);else for(e=0;s>e;++e)o[e]=h;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){return a||(a=Wo.behavior.drag().origin(Ce).on("dragstart.force",Ur).on("drag.force",e).on("dragend.force",Hr)),arguments.length?void this.on("mouseover.force",jr).on("mouseout.force",Wr).call(a):a},Wo.rebind(l,s,"on")};var su=20,uu=1,cu=1/0;Wo.layout.hierarchy=function(){function t(r){var i,o=[r],l=[];for(r.depth=0;null!=(i=o.pop());)if(l.push(i),(u=a.call(t,i,i.depth))&&(s=u.length)){for(var s,u,c;--s>=0;)o.push(c=u[s]),c.parent=i,c.depth=i.depth+1;n&&(i.value=0),i.children=u}else n&&(i.value=+n.call(t,i,i.depth)||0),delete i.children;return Qr(r,function(t){var a,r;e&&(a=t.children)&&a.sort(e),n&&(r=t.parent)&&(r.value+=t.value)}),l}var e=ai,a=ti,n=ei;return t.sort=function(a){return arguments.length?(e=a,t):e},t.children=function(e){return arguments.length?(a=e,t):a},t.value=function(e){return arguments.length?(n=e,t):n},t.revalue=function(e){return n&&(Kr(e,function(t){t.children&&(t.value=0)}),Qr(e,function(e){var a;e.children||(e.value=+n.call(t,e,e.depth)||0),(a=e.parent)&&(a.value+=e.value)})),e},t},Wo.layout.partition=function(){function t(e,a,n,r){var i=e.children;if(e.x=a,e.y=e.depth*r,e.dx=n,e.dy=r,i&&(o=i.length)){var o,l,s,u=-1;for(n=e.value?n/e.value:0;++u<o;)t(l=i[u],a,s=l.value*n,r),a+=s}}function e(t){var a=t.children,n=0;if(a&&(r=a.length))for(var r,i=-1;++i<r;)n=Math.max(n,e(a[i]));return 1+n}function a(a,i){var o=n.call(this,a,i);return t(o[0],0,r[0],r[1]/e(o[0])),o}var n=Wo.layout.hierarchy(),r=[1,1];return a.size=function(t){return arguments.length?(r=t,a):r},Zr(a,n)},Wo.layout.pie=function(){function t(i){var o=i.map(function(a,n){return+e.call(t,a,n)}),l=+("function"==typeof n?n.apply(this,arguments):n),s=(("function"==typeof r?r.apply(this,arguments):r)-l)/Wo.sum(o),u=Wo.range(i.length);null!=a&&u.sort(a===du?function(t,e){return o[e]-o[t]}:function(t,e){return a(i[t],i[e])});var c=[];return u.forEach(function(t){var e;c[t]={data:i[t],value:e=o[t],startAngle:l,endAngle:l+=e*s}}),c}var e=Number,a=du,n=0,r=Ll;return t.value=function(a){return arguments.length?(e=a,t):e},t.sort=function(e){return arguments.length?(a=e,t):a},t.startAngle=function(e){return arguments.length?(n=e,t):n},t.endAngle=function(e){return arguments.length?(r=e,t):r},t};var du={};Wo.layout.stack=function(){function t(l,s){if(!(f=l.length))return l;var u=l.map(function(a,n){return e.call(t,a,n)}),c=u.map(function(e){return e.map(function(e,a){return[i.call(t,e,a),o.call(t,e,a)]})}),d=a.call(t,c,s);u=Wo.permute(u,d),c=Wo.permute(c,d);var f,h,p,g,v=n.call(t,c,s),y=u[0].length;for(p=0;y>p;++p)for(r.call(t,u[0][p],g=v[p],c[0][p][1]),h=1;f>h;++h)r.call(t,u[h][p],g+=c[h-1][p][1],c[h][p][1]);return l}var e=Ce,a=li,n=si,r=oi,i=ri,o=ii;return t.values=function(a){return arguments.length?(e=a,t):e},t.order=function(e){return arguments.length?(a="function"==typeof e?e:fu.get(e)||li,t):a},t.offset=function(e){return arguments.length?(n="function"==typeof e?e:hu.get(e)||si,t):n},t.x=function(e){return arguments.length?(i=e,t):i},t.y=function(e){return arguments.length?(o=e,t):o},t.out=function(e){return arguments.length?(r=e,t):r},t};var fu=Wo.map({"inside-out":function(t){var e,a,n=t.length,r=t.map(ui),i=t.map(ci),o=Wo.range(n).sort(function(t,e){return r[t]-r[e]}),l=0,s=0,u=[],c=[];for(e=0;n>e;++e)a=o[e],s>l?(l+=i[a],u.push(a)):(s+=i[a],c.push(a));return c.reverse().concat(u)},reverse:function(t){return Wo.range(t.length).reverse()},"default":li}),hu=Wo.map({silhouette:function(t){var e,a,n,r=t.length,i=t[0].length,o=[],l=0,s=[];for(a=0;i>a;++a){for(e=0,n=0;r>e;e++)n+=t[e][a][1];n>l&&(l=n),o.push(n)}for(a=0;i>a;++a)s[a]=(l-o[a])/2;return s},wiggle:function(t){var e,a,n,r,i,o,l,s,u,c=t.length,d=t[0],f=d.length,h=[];for(h[0]=s=u=0,a=1;f>a;++a){for(e=0,r=0;c>e;++e)r+=t[e][a][1];for(e=0,i=0,l=d[a][0]-d[a-1][0];c>e;++e){for(n=0,o=(t[e][a][1]-t[e][a-1][1])/(2*l);e>n;++n)o+=(t[n][a][1]-t[n][a-1][1])/l;i+=o*t[e][a][1]}h[a]=s-=r?i/r*l:0,u>s&&(u=s)}for(a=0;f>a;++a)h[a]-=u;return h},expand:function(t){var e,a,n,r=t.length,i=t[0].length,o=1/r,l=[];for(a=0;i>a;++a){for(e=0,n=0;r>e;e++)n+=t[e][a][1];if(n)for(e=0;r>e;e++)t[e][a][1]/=n;else for(e=0;r>e;e++)t[e][a][1]=o}for(a=0;i>a;++a)l[a]=0;return l},zero:si});Wo.layout.histogram=function(){function t(t,i){for(var o,l,s=[],u=t.map(a,this),c=n.call(this,u,i),d=r.call(this,c,u,i),i=-1,f=u.length,h=d.length-1,p=e?1:1/f;++i<h;)o=s[i]=[],o.dx=d[i+1]-(o.x=d[i]),o.y=0;if(h>0)for(i=-1;++i<f;)l=u[i],l>=c[0]&&l<=c[1]&&(o=s[Wo.bisect(d,l,1,h)-1],o.y+=p,o.push(t[i]));return s}var e=!0,a=Number,n=pi,r=fi;return t.value=function(e){return arguments.length?(a=e,t):a},t.range=function(e){return arguments.length?(n=Se(e),t):n},t.bins=function(e){return arguments.length?(r="number"==typeof e?function(t){return hi(t,e)}:Se(e),t):r},t.frequency=function(a){return arguments.length?(e=!!a,t):e},t},Wo.layout.pack=function(){function t(t,i){var o=a.call(this,t,i),l=o[0],s=r[0],u=r[1],c=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(l.x=l.y=0,Qr(l,function(t){t.r=+c(t.value)}),Qr(l,mi),n){var d=n*(e?1:Math.max(2*l.r/s,2*l.r/u))/2;Qr(l,function(t){t.r+=d}),Qr(l,mi),Qr(l,function(t){t.r-=d})}return Mi(l,s/2,u/2,e?1:1/Math.max(2*l.r/s,2*l.r/u)),o}var e,a=Wo.layout.hierarchy().sort(gi),n=0,r=[1,1];return t.size=function(e){return arguments.length?(r=e,t):r},t.radius=function(a){return arguments.length?(e=null==a||"function"==typeof a?a:+a,t):e},t.padding=function(e){return arguments.length?(n=+e,t):n},Zr(t,a)},Wo.layout.tree=function(){function t(t,r){var c=o.call(this,t,r),d=c[0],f=e(d);if(Qr(f,a),f.parent.m=-f.z,Kr(f,n),u)Kr(d,i);else{var h=d,p=d,g=d;Kr(d,function(t){t.x<h.x&&(h=t),t.x>p.x&&(p=t),t.depth>g.depth&&(g=t)});var v=l(h,p)/2-h.x,y=s[0]/(p.x+l(p,h)/2+v),x=s[1]/(g.depth||1);Kr(d,function(t){t.x=(t.x+v)*y,t.y=t.depth*x})}return c}function e(t){for(var e,a={A:null,children:[t]},n=[a];null!=(e=n.pop());)for(var r,i=e.children,o=0,l=i.length;l>o;++o)n.push((i[o]=r={_:i[o],parent:e,children:(r=i[o].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=r);return a.children[0]}function a(t){var e=t.children,a=t.parent.children,n=t.i?a[t.i-1]:null;if(e.length){Li(t);var i=(e[0].z+e[e.length-1].z)/2;n?(t.z=n.z+l(t._,n._),t.m=t.z-i):t.z=i}else n&&(t.z=n.z+l(t._,n._));t.parent.A=r(t,n,t.parent.A||a[0])}function n(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function r(t,e,a){if(e){for(var n,r=t,i=t,o=e,s=r.parent.children[0],u=r.m,c=i.m,d=o.m,f=s.m;o=Ci(o),r=Si(r),o&&r;)s=Si(s),i=Ci(i),i.a=t,n=o.z+d-r.z-u+l(o._,r._),n>0&&(Ti(Ni(o,t,a),t,n),u+=n,c+=n),d+=o.m,u+=r.m,f+=s.m,c+=i.m;o&&!Ci(i)&&(i.t=o,i.m+=d-c),r&&!Si(s)&&(s.t=r,s.m+=u-f,a=t)}return a}function i(t){t.x*=s[0],t.y=t.depth*s[1]}var o=Wo.layout.hierarchy().sort(null).value(null),l=wi,s=[1,1],u=null;return t.separation=function(e){return arguments.length?(l=e,t):l},t.size=function(e){return arguments.length?(u=null==(s=e)?i:null,t):u?null:s},t.nodeSize=function(e){return arguments.length?(u=null==(s=e)?null:i,t):u?s:null},Zr(t,o)},Wo.layout.cluster=function(){function t(t,i){var o,l=e.call(this,t,i),s=l[0],u=0;Qr(s,function(t){var e=t.children;e&&e.length?(t.x=Pi(e),t.y=Di(e)):(t.x=o?u+=a(t,o):0,t.y=0,o=t)});var c=_i(s),d=Ii(s),f=c.x-a(c,d)/2,h=d.x+a(d,c)/2;return Qr(s,r?function(t){t.x=(t.x-s.x)*n[0],t.y=(s.y-t.y)*n[1]}:function(t){t.x=(t.x-f)/(h-f)*n[0],t.y=(1-(s.y?t.y/s.y:1))*n[1]}),l}var e=Wo.layout.hierarchy().sort(null).value(null),a=wi,n=[1,1],r=!1;return t.separation=function(e){return arguments.length?(a=e,t):a},t.size=function(e){return arguments.length?(r=null==(n=e),t):r?null:n},t.nodeSize=function(e){return arguments.length?(r=null!=(n=e),t):r?n:null},Zr(t,e)},Wo.layout.treemap=function(){function t(t,e){for(var a,n,r=-1,i=t.length;++r<i;)n=(a=t[r]).value*(0>e?0:e),a.area=isNaN(n)||0>=n?0:n}function e(a){var i=a.children;if(i&&i.length){var o,l,s,u=d(a),c=[],f=i.slice(),p=1/0,g="slice"===h?u.dx:"dice"===h?u.dy:"slice-dice"===h?1&a.depth?u.dy:u.dx:Math.min(u.dx,u.dy);for(t(f,u.dx*u.dy/a.value),c.area=0;(s=f.length)>0;)c.push(o=f[s-1]),c.area+=o.area,"squarify"!==h||(l=n(c,g))<=p?(f.pop(),p=l):(c.area-=c.pop().area,r(c,g,u,!1),g=Math.min(u.dx,u.dy),c.length=c.area=0,p=1/0);c.length&&(r(c,g,u,!0),c.length=c.area=0),i.forEach(e)}}function a(e){var n=e.children;if(n&&n.length){var i,o=d(e),l=n.slice(),s=[];for(t(l,o.dx*o.dy/e.value),s.area=0;i=l.pop();)s.push(i),s.area+=i.area,null!=i.z&&(r(s,i.z?o.dx:o.dy,o,!l.length),s.length=s.area=0);n.forEach(a)}}function n(t,e){for(var a,n=t.area,r=0,i=1/0,o=-1,l=t.length;++o<l;)(a=t[o].area)&&(i>a&&(i=a),a>r&&(r=a));return n*=n,e*=e,n?Math.max(e*r*p/n,n/(e*i*p)):1/0}function r(t,e,a,n){var r,i=-1,o=t.length,l=a.x,u=a.y,c=e?s(t.area/e):0;if(e==a.dx){for((n||c>a.dy)&&(c=a.dy);++i<o;)r=t[i],r.x=l,r.y=u,r.dy=c,l+=r.dx=Math.min(a.x+a.dx-l,c?s(r.area/c):0);r.z=!0,r.dx+=a.x+a.dx-l,a.y+=c,a.dy-=c}else{for((n||c>a.dx)&&(c=a.dx);++i<o;)r=t[i],r.x=l,r.y=u,r.dx=c,u+=r.dy=Math.min(a.y+a.dy-u,c?s(r.area/c):0);r.z=!1,r.dy+=a.y+a.dy-u,a.x+=c,a.dx-=c}}function i(n){var r=o||l(n),i=r[0];return i.x=0,i.y=0,i.dx=u[0],i.dy=u[1],o&&l.revalue(i),t([i],i.dx*i.dy/i.value),(o?a:e)(i),f&&(o=r),r}var o,l=Wo.layout.hierarchy(),s=Math.round,u=[1,1],c=null,d=Vi,f=!1,h="squarify",p=.5*(1+Math.sqrt(5));return i.size=function(t){return arguments.length?(u=t,i):u},i.padding=function(t){function e(e){var a=t.call(i,e,e.depth);return null==a?Vi(e):Fi(e,"number"==typeof a?[a,a,a,a]:a)}function a(e){return Fi(e,t)}if(!arguments.length)return c;var n;return d=null==(c=t)?Vi:"function"==(n=typeof t)?e:"number"===n?(t=[t,t,t,t],a):a,i},i.round=function(t){return arguments.length?(s=t?Math.round:Number,i):s!=Number},i.sticky=function(t){return arguments.length?(f=t,o=null,i):f},i.ratio=function(t){return arguments.length?(p=t,i):p},i.mode=function(t){return arguments.length?(h=t+"",i):h},Zr(i,l)},Wo.random={normal:function(t,e){var a=arguments.length;return 2>a&&(e=1),1>a&&(t=0),function(){var a,n,r;do a=2*Math.random()-1,n=2*Math.random()-1,r=a*a+n*n;while(!r||r>1);return t+e*a*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var t=Wo.random.normal.apply(Wo,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=Wo.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,a=0;t>a;a++)e+=Math.random();return e}}},Wo.scale={};var pu={floor:Ce,ceil:Ce};Wo.scale.linear=function(){return Bi([0,1],[0,1],yr,!1)};var gu={s:1,g:1,p:1,r:1,e:1};Wo.scale.log=function(){return $i(Wo.scale.linear().domain([0,1]),10,!0,[1,10])};var vu=Wo.format(".0e"),yu={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};Wo.scale.pow=function(){return Zi(Wo.scale.linear(),1,[0,1])},Wo.scale.sqrt=function(){return Wo.scale.pow().exponent(.5)},Wo.scale.ordinal=function(){return Qi([],{t:"range",a:[[]]})},Wo.scale.category10=function(){return Wo.scale.ordinal().range(xu)},Wo.scale.category20=function(){return Wo.scale.ordinal().range(mu)},Wo.scale.category20b=function(){return Wo.scale.ordinal().range(bu)
},Wo.scale.category20c=function(){return Wo.scale.ordinal().range(Au)};var xu=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(xe),mu=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(xe),bu=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(xe),Au=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(xe);Wo.scale.quantile=function(){return to([],[])},Wo.scale.quantize=function(){return eo(0,1,[0,1])},Wo.scale.threshold=function(){return ao([.5],[0,1])},Wo.scale.identity=function(){return no([0,1])},Wo.svg={},Wo.svg.arc=function(){function t(){var t=e.apply(this,arguments),i=a.apply(this,arguments),o=n.apply(this,arguments)+Mu,l=r.apply(this,arguments)+Mu,s=(o>l&&(s=o,o=l,l=s),l-o),u=Tl>s?"0":"1",c=Math.cos(o),d=Math.sin(o),f=Math.cos(l),h=Math.sin(l);return s>=ku?t?"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"M0,"+t+"A"+t+","+t+" 0 1,0 0,"+-t+"A"+t+","+t+" 0 1,0 0,"+t+"Z":"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z":t?"M"+i*c+","+i*d+"A"+i+","+i+" 0 "+u+",1 "+i*f+","+i*h+"L"+t*f+","+t*h+"A"+t+","+t+" 0 "+u+",0 "+t*c+","+t*d+"Z":"M"+i*c+","+i*d+"A"+i+","+i+" 0 "+u+",1 "+i*f+","+i*h+"L0,0Z"}var e=ro,a=io,n=oo,r=lo;return t.innerRadius=function(a){return arguments.length?(e=Se(a),t):e},t.outerRadius=function(e){return arguments.length?(a=Se(e),t):a},t.startAngle=function(e){return arguments.length?(n=Se(e),t):n},t.endAngle=function(e){return arguments.length?(r=Se(e),t):r},t.centroid=function(){var t=(e.apply(this,arguments)+a.apply(this,arguments))/2,i=(n.apply(this,arguments)+r.apply(this,arguments))/2+Mu;return[Math.cos(i)*t,Math.sin(i)*t]},t};var Mu=-Nl,ku=Ll-Dl;Wo.svg.line=function(){return so(Ce)};var wu=Wo.map({linear:uo,"linear-closed":co,step:fo,"step-before":ho,"step-after":po,basis:bo,"basis-open":Ao,"basis-closed":Mo,bundle:ko,cardinal:yo,"cardinal-open":go,"cardinal-closed":vo,monotone:No});wu.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Su=[0,2/3,1/3,0],Cu=[0,1/3,2/3,0],Tu=[0,1/6,2/3,1/6];Wo.svg.line.radial=function(){var t=so(Do);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},ho.reverse=po,po.reverse=ho,Wo.svg.area=function(){return Po(Ce)},Wo.svg.area.radial=function(){var t=Po(Do);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},Wo.svg.chord=function(){function t(t,l){var s=e(this,i,t,l),u=e(this,o,t,l);return"M"+s.p0+n(s.r,s.p1,s.a1-s.a0)+(a(s,u)?r(s.r,s.p1,s.r,s.p0):r(s.r,s.p1,u.r,u.p0)+n(u.r,u.p1,u.a1-u.a0)+r(u.r,u.p1,s.r,s.p0))+"Z"}function e(t,e,a,n){var r=e.call(t,a,n),i=l.call(t,r,n),o=s.call(t,r,n)+Mu,c=u.call(t,r,n)+Mu;return{r:i,a0:o,a1:c,p0:[i*Math.cos(o),i*Math.sin(o)],p1:[i*Math.cos(c),i*Math.sin(c)]}}function a(t,e){return t.a0==e.a0&&t.a1==e.a1}function n(t,e,a){return"A"+t+","+t+" 0 "+ +(a>Tl)+",1 "+e}function r(t,e,a,n){return"Q 0,0 "+n}var i=xn,o=mn,l=_o,s=oo,u=lo;return t.radius=function(e){return arguments.length?(l=Se(e),t):l},t.source=function(e){return arguments.length?(i=Se(e),t):i},t.target=function(e){return arguments.length?(o=Se(e),t):o},t.startAngle=function(e){return arguments.length?(s=Se(e),t):s},t.endAngle=function(e){return arguments.length?(u=Se(e),t):u},t},Wo.svg.diagonal=function(){function t(t,r){var i=e.call(this,t,r),o=a.call(this,t,r),l=(i.y+o.y)/2,s=[i,{x:i.x,y:l},{x:o.x,y:l},o];return s=s.map(n),"M"+s[0]+"C"+s[1]+" "+s[2]+" "+s[3]}var e=xn,a=mn,n=Io;return t.source=function(a){return arguments.length?(e=Se(a),t):e},t.target=function(e){return arguments.length?(a=Se(e),t):a},t.projection=function(e){return arguments.length?(n=e,t):n},t},Wo.svg.diagonal.radial=function(){var t=Wo.svg.diagonal(),e=Io,a=t.projection;return t.projection=function(t){return arguments.length?a(Vo(e=t)):e},t},Wo.svg.symbol=function(){function t(t,n){return(Lu.get(e.call(this,t,n))||zo)(a.call(this,t,n))}var e=Oo,a=Fo;return t.type=function(a){return arguments.length?(e=Se(a),t):e},t.size=function(e){return arguments.length?(a=Se(e),t):a},t};var Lu=Wo.map({circle:zo,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*_u)),a=e*_u;return"M0,"+-e+"L"+a+",0 0,"+e+" "+-a+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Pu),a=e*Pu/2;return"M0,"+a+"L"+e+","+-a+" "+-e+","+-a+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Pu),a=e*Pu/2;return"M0,"+-a+"L"+e+","+a+" "+-e+","+a+"Z"}});Wo.svg.symbolTypes=Lu.keys();var Nu,Du,Pu=Math.sqrt(3),_u=Math.tan(30*_l),Iu=[],Vu=0;Iu.call=ml.call,Iu.empty=ml.empty,Iu.node=ml.node,Iu.size=ml.size,Wo.transition=function(t){return arguments.length?Nu?t.transition():t:Ml.transition()},Wo.transition.prototype=Iu,Iu.select=function(t){var e,a,n,r=this.id,i=[];t=S(t);for(var o=-1,l=this.length;++o<l;){i.push(e=[]);for(var s=this[o],u=-1,c=s.length;++u<c;)(n=s[u])&&(a=t.call(n,n.__data__,u,o))?("__data__"in n&&(a.__data__=n.__data__),Yo(a,u,r,n.__transition__[r]),e.push(a)):e.push(null)}return Go(i,r)},Iu.selectAll=function(t){var e,a,n,r,i,o=this.id,l=[];t=C(t);for(var s=-1,u=this.length;++s<u;)for(var c=this[s],d=-1,f=c.length;++d<f;)if(n=c[d]){i=n.__transition__[o],a=t.call(n,n.__data__,d,s),l.push(e=[]);for(var h=-1,p=a.length;++h<p;)(r=a[h])&&Yo(r,h,o,i),e.push(r)}return Go(l,o)},Iu.filter=function(t){var e,a,n,r=[];"function"!=typeof t&&(t=z(t));for(var i=0,o=this.length;o>i;i++){r.push(e=[]);for(var a=this[i],l=0,s=a.length;s>l;l++)(n=a[l])&&t.call(n,n.__data__,l,i)&&e.push(n)}return Go(r,this.id)},Iu.tween=function(t,e){var a=this.id;return arguments.length<2?this.node().__transition__[a].tween.get(t):R(this,null==e?function(e){e.__transition__[a].tween.remove(t)}:function(n){n.__transition__[a].tween.set(t,e)})},Iu.attr=function(t,e){function a(){this.removeAttribute(l)}function n(){this.removeAttributeNS(l.space,l.local)}function r(t){return null==t?a:(t+="",function(){var e,a=this.getAttribute(l);return a!==t&&(e=o(a,t),function(t){this.setAttribute(l,e(t))})})}function i(t){return null==t?n:(t+="",function(){var e,a=this.getAttributeNS(l.space,l.local);return a!==t&&(e=o(a,t),function(t){this.setAttributeNS(l.space,l.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var o="transform"==t?Er:yr,l=Wo.ns.qualify(t);return Ro(this,"attr."+t,e,l.local?i:r)},Iu.attrTween=function(t,e){function a(t,a){var n=e.call(this,t,a,this.getAttribute(r));return n&&function(t){this.setAttribute(r,n(t))}}function n(t,a){var n=e.call(this,t,a,this.getAttributeNS(r.space,r.local));return n&&function(t){this.setAttributeNS(r.space,r.local,n(t))}}var r=Wo.ns.qualify(t);return this.tween("attr."+t,r.local?n:a)},Iu.style=function(t,e,a){function n(){this.style.removeProperty(t)}function r(e){return null==e?n:(e+="",function(){var n,r=tl.getComputedStyle(this,null).getPropertyValue(t);return r!==e&&(n=yr(r,e),function(e){this.style.setProperty(t,n(e),a)})})}var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e="");for(a in t)this.style(a,t[a],e);return this}a=""}return Ro(this,"style."+t,e,r)},Iu.styleTween=function(t,e,a){function n(n,r){var i=e.call(this,n,r,tl.getComputedStyle(this,null).getPropertyValue(t));return i&&function(e){this.style.setProperty(t,i(e),a)}}return arguments.length<3&&(a=""),this.tween("style."+t,n)},Iu.text=function(t){return Ro(this,"text",t,Eo)},Iu.remove=function(){return this.each("end.transition",function(){var t;this.__transition__.count<2&&(t=this.parentNode)&&t.removeChild(this)})},Iu.ease=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].ease:("function"!=typeof t&&(t=Wo.ease.apply(Wo,arguments)),R(this,function(a){a.__transition__[e].ease=t}))},Iu.delay=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].delay:R(this,"function"==typeof t?function(a,n,r){a.__transition__[e].delay=+t.call(a,a.__data__,n,r)}:(t=+t,function(a){a.__transition__[e].delay=t}))},Iu.duration=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].duration:R(this,"function"==typeof t?function(a,n,r){a.__transition__[e].duration=Math.max(1,t.call(a,a.__data__,n,r))}:(t=Math.max(1,t),function(a){a.__transition__[e].duration=t}))},Iu.each=function(t,e){var a=this.id;if(arguments.length<2){var n=Du,r=Nu;Nu=a,R(this,function(e,n,r){Du=e.__transition__[a],t.call(e,e.__data__,n,r)}),Du=n,Nu=r}else R(this,function(n){var r=n.__transition__[a];(r.event||(r.event=Wo.dispatch("start","end"))).on(t,e)});return this},Iu.transition=function(){for(var t,e,a,n,r=this.id,i=++Vu,o=[],l=0,s=this.length;s>l;l++){o.push(t=[]);for(var e=this[l],u=0,c=e.length;c>u;u++)(a=e[u])&&(n=Object.create(a.__transition__[r]),n.delay+=n.duration,Yo(a,u,i,n)),t.push(a)}return Go(o,i)},Wo.svg.axis=function(){function t(t){t.each(function(){var t,u=Wo.select(this),c=this.__chart__||a,d=this.__chart__=a.copy(),f=null==s?d.ticks?d.ticks.apply(d,l):d.domain():s,h=null==e?d.tickFormat?d.tickFormat.apply(d,l):Ce:e,p=u.selectAll(".tick").data(f,d),g=p.enter().insert("g",".domain").attr("class","tick").style("opacity",Dl),v=Wo.transition(p.exit()).style("opacity",Dl).remove(),y=Wo.transition(p.order()).style("opacity",1),x=Math.max(r,0)+o,m=zi(d),b=u.selectAll(".domain").data([0]),A=(b.enter().append("path").attr("class","domain"),Wo.transition(b));g.append("line"),g.append("text");var M,k,w,S,C=g.select("line"),T=y.select("line"),L=p.select("text").text(h),N=g.select("text"),D=y.select("text"),P="top"===n||"left"===n?-1:1;if("bottom"===n||"top"===n?(t=Bo,M="x",w="y",k="x2",S="y2",L.attr("dy",0>P?"0em":".71em").style("text-anchor","middle"),A.attr("d","M"+m[0]+","+P*i+"V0H"+m[1]+"V"+P*i)):(t=Jo,M="y",w="x",k="y2",S="x2",L.attr("dy",".32em").style("text-anchor",0>P?"end":"start"),A.attr("d","M"+P*i+","+m[0]+"H0V"+m[1]+"H"+P*i)),C.attr(S,P*r),N.attr(w,P*x),T.attr(k,0).attr(S,P*r),D.attr(M,0).attr(w,P*x),d.rangeBand){var _=d,I=_.rangeBand()/2;c=d=function(t){return _(t)+I}}else c.rangeBand?c=d:v.call(t,d,c);g.call(t,c,d),y.call(t,d,d)})}var e,a=Wo.scale.linear(),n=Fu,r=6,i=6,o=3,l=[10],s=null;return t.scale=function(e){return arguments.length?(a=e,t):a},t.orient=function(e){return arguments.length?(n=e in Ou?e+"":Fu,t):n},t.ticks=function(){return arguments.length?(l=arguments,t):l},t.tickValues=function(e){return arguments.length?(s=e,t):s},t.tickFormat=function(a){return arguments.length?(e=a,t):e},t.tickSize=function(e){var a=arguments.length;return a?(r=+e,i=+arguments[a-1],t):r},t.innerTickSize=function(e){return arguments.length?(r=+e,t):r},t.outerTickSize=function(e){return arguments.length?(i=+e,t):i},t.tickPadding=function(e){return arguments.length?(o=+e,t):o},t.tickSubdivide=function(){return arguments.length&&t},t};var Fu="bottom",Ou={top:1,right:1,bottom:1,left:1};Wo.svg.brush=function(){function t(i){i.each(function(){var i=Wo.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",r).on("touchstart.brush",r),o=i.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),i.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var l=i.selectAll(".resize").data(p,Ce);l.exit().remove(),l.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return zu[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),l.style("display",t.empty()?"none":null);var c,d=Wo.transition(i),f=Wo.transition(o);s&&(c=zi(s),f.attr("x",c[0]).attr("width",c[1]-c[0]),a(d)),u&&(c=zi(u),f.attr("y",c[0]).attr("height",c[1]-c[0]),n(d)),e(d)})}function e(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+c[+/e$/.test(t)]+","+d[+/^s/.test(t)]+")"})}function a(t){t.select(".extent").attr("x",c[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1]-c[0])}function n(t){t.select(".extent").attr("y",d[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",d[1]-d[0])}function r(){function r(){32==Wo.event.keyCode&&(L||(x=null,D[0]-=c[1],D[1]-=d[1],L=2),A())}function p(){32==Wo.event.keyCode&&2==L&&(D[0]+=c[1],D[1]+=d[1],L=0,A())}function g(){var t=Wo.mouse(b),r=!1;m&&(t[0]+=m[0],t[1]+=m[1]),L||(Wo.event.altKey?(x||(x=[(c[0]+c[1])/2,(d[0]+d[1])/2]),D[0]=c[+(t[0]<x[0])],D[1]=d[+(t[1]<x[1])]):x=null),C&&v(t,s,0)&&(a(w),r=!0),T&&v(t,u,1)&&(n(w),r=!0),r&&(e(w),k({type:"brush",mode:L?"move":"resize"}))}function v(t,e,a){var n,r,l=zi(e),s=l[0],u=l[1],p=D[a],g=a?d:c,v=g[1]-g[0];return L&&(s-=p,u-=v+p),n=(a?h:f)?Math.max(s,Math.min(u,t[a])):t[a],L?r=(n+=p)+v:(x&&(p=Math.max(s,Math.min(u,2*x[a]-n))),n>p?(r=n,n=p):r=p),g[0]!=n||g[1]!=r?(a?o=null:i=null,g[0]=n,g[1]=r,!0):void 0}function y(){g(),w.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),Wo.select("body").style("cursor",null),P.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),N(),k({type:"brushend"})}var x,m,b=this,M=Wo.select(Wo.event.target),k=l.of(b,arguments),w=Wo.select(b),S=M.datum(),C=!/^(n|s)$/.test(S)&&s,T=!/^(e|w)$/.test(S)&&u,L=M.classed("extent"),N=U(),D=Wo.mouse(b),P=Wo.select(tl).on("keydown.brush",r).on("keyup.brush",p);if(Wo.event.changedTouches?P.on("touchmove.brush",g).on("touchend.brush",y):P.on("mousemove.brush",g).on("mouseup.brush",y),w.interrupt().selectAll("*").interrupt(),L)D[0]=c[0]-D[0],D[1]=d[0]-D[1];else if(S){var _=+/w$/.test(S),I=+/^n/.test(S);m=[c[1-_]-D[0],d[1-I]-D[1]],D[0]=c[_],D[1]=d[I]}else Wo.event.altKey&&(x=D.slice());w.style("pointer-events","none").selectAll(".resize").style("display",null),Wo.select("body").style("cursor",M.style("cursor")),k({type:"brushstart"}),g()}var i,o,l=k(t,"brushstart","brush","brushend"),s=null,u=null,c=[0,0],d=[0,0],f=!0,h=!0,p=Gu[0];return t.event=function(t){t.each(function(){var t=l.of(this,arguments),e={x:c,y:d,i:i,j:o},a=this.__chart__||e;this.__chart__=e,Nu?Wo.select(this).transition().each("start.brush",function(){i=a.i,o=a.j,c=a.x,d=a.y,t({type:"brushstart"})}).tween("brush:brush",function(){var a=xr(c,e.x),n=xr(d,e.y);return i=o=null,function(r){c=e.x=a(r),d=e.y=n(r),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){i=e.i,o=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(s=e,p=Gu[!s<<1|!u],t):s},t.y=function(e){return arguments.length?(u=e,p=Gu[!s<<1|!u],t):u},t.clamp=function(e){return arguments.length?(s&&u?(f=!!e[0],h=!!e[1]):s?f=!!e:u&&(h=!!e),t):s&&u?[f,h]:s?f:u?h:null},t.extent=function(e){var a,n,r,l,f;return arguments.length?(s&&(a=e[0],n=e[1],u&&(a=a[0],n=n[0]),i=[a,n],s.invert&&(a=s(a),n=s(n)),a>n&&(f=a,a=n,n=f),(a!=c[0]||n!=c[1])&&(c=[a,n])),u&&(r=e[0],l=e[1],s&&(r=r[1],l=l[1]),o=[r,l],u.invert&&(r=u(r),l=u(l)),r>l&&(f=r,r=l,l=f),(r!=d[0]||l!=d[1])&&(d=[r,l])),t):(s&&(i?(a=i[0],n=i[1]):(a=c[0],n=c[1],s.invert&&(a=s.invert(a),n=s.invert(n)),a>n&&(f=a,a=n,n=f))),u&&(o?(r=o[0],l=o[1]):(r=d[0],l=d[1],u.invert&&(r=u.invert(r),l=u.invert(l)),r>l&&(f=r,r=l,l=f))),s&&u?[[a,r],[n,l]]:s?[a,n]:u&&[r,l])},t.clear=function(){return t.empty()||(c=[0,0],d=[0,0],i=o=null),t},t.empty=function(){return!!s&&c[0]==c[1]||!!u&&d[0]==d[1]},Wo.rebind(t,l,"on")};var zu={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Gu=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Ru=rs.format=cs.timeFormat,Eu=Ru.utc,Yu=Eu("%Y-%m-%dT%H:%M:%S.%LZ");Ru.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?qo:Yu,qo.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},qo.toString=Yu.toString,rs.second=Re(function(t){return new is(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),rs.seconds=rs.second.range,rs.seconds.utc=rs.second.utc.range,rs.minute=Re(function(t){return new is(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),rs.minutes=rs.minute.range,rs.minutes.utc=rs.minute.utc.range,rs.hour=Re(function(t){var e=t.getTimezoneOffset()/60;return new is(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),rs.hours=rs.hour.range,rs.hours.utc=rs.hour.utc.range,rs.month=Re(function(t){return t=rs.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),rs.months=rs.month.range,rs.months.utc=rs.month.utc.range;var Bu=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Ju=[[rs.second,1],[rs.second,5],[rs.second,15],[rs.second,30],[rs.minute,1],[rs.minute,5],[rs.minute,15],[rs.minute,30],[rs.hour,1],[rs.hour,3],[rs.hour,6],[rs.hour,12],[rs.day,1],[rs.day,2],[rs.week,1],[rs.month,1],[rs.month,3],[rs.year,1]],qu=Ru.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Ta]]),Xu={range:function(t,e,a){return Wo.range(Math.ceil(t/a)*a,+e,a).map(Uo)},floor:Ce,ceil:Ce};Ju.year=rs.year,rs.scale=function(){return Xo(Wo.scale.linear(),Ju,qu)};var Uu=Ju.map(function(t){return[t[0].utc,t[1]]}),Hu=Eu.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Ta]]);Uu.year=rs.year.utc,rs.scale.utc=function(){return Xo(Wo.scale.linear(),Uu,Hu)},Wo.text=Te(function(t){return t.responseText}),Wo.json=function(t,e){return Le(t,"application/json",Ho,e)},Wo.html=function(t,e){return Le(t,"text/html",jo,e)},Wo.xml=Te(function(t){return t.responseXML}),"function"==typeof define&&define.amd?define(Wo):"object"==typeof module&&module.exports&&(module.exports=Wo),this.d3=Wo}(),function(t){t.fn.stocCharts=function(e){function a(t){var e={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return"undefined"!=typeof e[t.toLowerCase()]?e[t.toLowerCase()]:!1}function n(t,e){var n=t.indexOf("#");t=-1==n?a(t):t,t=String(t).replace(/[^0-9a-f]/gi,""),t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]),e=e||0;var r,i,o="#";for(i=0;3>i;i++)r=parseInt(t.substr(2*i,2),16),r=Math.round(Math.min(Math.max(0,r+r*e),255)).toString(16),o+=("00"+r).substr(r.length);return o}function r(){v=t(h).width(),y=t(h).height(),x=e,P=t(h).attr("id");var a=P+"_svg";g=d3.select("#"+P).append("svg").attr("width","100%").attr("height","100%").attr("id",P+"-svg").attr("class",a).attr("viewBox","0 0 "+Math.max(v,y)+" "+Math.min(v,y)).attr("preserveAspectRatio","xMinYMin"),d3.select("#tooltipChart").empty()&&X.appendToolTip()}function o(t){var e=t.sort(function(t,e){return parseInt(t)<parseInt(e)});return e}function l(t,e,a,n){var r=t*(Math.PI/180),i=e/Math.tan(r)+n;return i}function s(t,e){var a=t*(Math.PI/180),n=e/Math.tan(a);return n}function u(t){var e=50,a=2,n=60,r=200/1.73,o=(t.length*e,0),u=0,c=0,d=0,f=0,h=0,p=0,g=0,v={},y=[];for(v.arrayOfPolygons=y,i=1;i<=t.length;i++){var x,m,b={},A=[];for(b.coordinates=A,j=0;j<4;j++){0==j?(x=l(n,t[i-1],r,f),m=1==i?s(60,t[i-1]):+h+s(n,t[i-1]),o=x,c=m+a):1==j?(x+=r-2*x,m=1==i?s(60,t[i-1]):+g+s(n,t[i-1]),u=x,d=m+a):2==j?1==i?(x=r,m=0):(x=p,m=g):1==i?(x=0,m=0):(x=f,m=h);var M={x:x,y:m};b.coordinates.push(M)}f=o,h=c,p=u,g=d;var k={name:"Polygon-"+i,Percent:t[i-1],points:b.coordinates};v.arrayOfPolygons.push(k)}return v}function c(t){t.selectAll(".axis").select("path").style("display","none"),t.selectAll(".tick line").style("display","none"),t.selectAll("path.domain").style("display","none")}function d(t){var e=x,a=t.selectAll("text");a.style("font-size",e["font-size"],null),a.style("font-family",e["font-family"]),a.style("font-weight",e["font-weight"]),t.selectAll(".tick").selectAll("text").style("fill",e["tick-font-color"],null),t.selectAll(".title").selectAll("text").style("font-size",e.titleFontSize+"px"),t.selectAll(".legend").selectAll("text").style("fill",e.legendTextColor)}var f={attachWaterMark:function(){h.parent().css("background-repeat"," no-repeat"),h.parent().css("background-position","bottom right")}},h=t(this),p=t(h).attr("id");f.attachWaterMark(h);var g,v,y,x,m,b,A,M,S,C,T,L,N,D,P,_={left:10,right:35,top:5,bottom:35,scale:5},I=d3.time.format("%Y-%m-%d"),V=(d3.time.format("%b "),50),_={left:10,right:35,top:10,bottom:35,scale:50,areaLeft:60},F={drawYAxis:function(){var e=d3.select(".yaxis").append("svg").attr("width",40).attr("height",t(h).height());e.append("g").attr("class","y axis agnitio").attr("transform","translate(8,"+_.top+")").attr("stroke","black").attr("fill","none").call(m)},drawMulitpleLineChartWithSquare:function(e){for(var a,n,e=t.extend({lineArray:[],squareArray:[]},e),r=e.lineArray,i=e.squareArray,o=0;o<r.length;o++){var l=r[o],s=l.yFieldName,u=d3.extent(l.data,function(t){return t[s]});0==o?(a=u[0],n=u[1]):(a>u[0]&&(a=u[0]),n<u[1]&&(n=u[1]))}A.domain([a,n+3]);for(var o=0;o<r.length;o++){var l=r[o],c={};for(key in l)c[key]=l[key];H.drawLine(c)}for(var o=0;o<i.length;o++){var d=i[o],f={};for(key in d)f[key]=d[key];Z.squareChart(f)}}},O={getValueToPercentageArray:function(t){for(var e=[],a=0,n=0;n<t.length;n++)a+=t[n];for(var n=0;n<t.length;n++)e.push(t[n]/a*100);return e}},G={getLegendPositionArray:function(t,e,a){for(var n=6,r=.7*e,i=10,o=.05*a,l=[],s=10,u=0,c=0,d=0;d<t.length;d++){var f=t[d].toString(),h={x:0,y:0,endPos:0},p=0,g=.08*e,v=.05*e;30>g&&(g=30),20>v&&(v=20),p=0==d?g:l[d-1].endPos;var y=p+s+f.length*n+i+v;y>r&&(u++,p=g,y=p+s+f.length*n+i+v,c=u*o),h.x=p,h.y=c,h.endPos=y,h.textPos=p+s+i-5,l.push(h)}return l},showHorizontalLegend:function(t,e,a,n,r){for(var i=0,o=0;o<a.length;o++)i<a[o].toString().length&&(i=a[o].toString().length);i=7.5*i;for(var l,s=[],u={x:0,y:0,textXPos:0},c=5,d=Math.round(.9*t/(c+n+i)),o=0;o<a.length;o++){var u={};l=o%d==0?.025*t:l+c+n+i,u.x=l+3,o%d==0&&0!=o&&(e+=1.5*r),u.y=e,u.textXPos=l+c+n,s.push(u)}return s}},R={appendLabel:function(t,e,a,n,r,i,o){var l="black",s=300;isNaN(i)&&void 0===i||(l=i),isNaN(o)&&void 0===o||(s=o);var u=r.append("text");u.text(t).attr("transform","translate("+e+","+a+") rotate("+n+")").style("fill",l,"important").style("font-weight",500,"important")}},E={getMin:function(t){var e=d3.min(t);return e=0==e?e:0>e?1.5*e:.3*e},getMax:function(t){var e=d3.max(t);return e=0==e?e:e>0?1.3*e:.7*e}},Y={leftMarginController:function(t){for(var e=0,a=0;a<t.length;a++)e<t[a].toString().length&&(e=t[a].toString().length);1>=e&&(e=3);var n=8;return e=(e+1)*n,e+=20}},B={getTickArray:function(t,e,a){var n=[],r=(e-t)/(a-1),i=t;n.push(i),a--;for(var o=1;a>o;o++)i+=r,n.push(i),o==a-1&&n.push(e);return n},getXTickArray:function(t,e,a,n){var r=[],i=13*a,o=n/i,l=t;r.push(l);for(var s=(e-t)/o;e>l;)l=Math.floor(l+s),-1==r.indexOf(l)&&e-1>=l?r.push(l):l++;return r}},J={wrapText:function(t,e){t.each(function(){for(var t,a=d3.select(this),n=a.text().split(/\s+/).reverse(),r=[],i=0,o=1.1,l=a.attr("y"),s=parseFloat(a.attr("dy")),u=a.text(null).append("tspan").attr("x",0).attr("y",l).attr("dy",s+"em");t=n.pop();)r.push(t),u.text(r.join(" ")),u.node().getComputedTextLength()>e&&(r.pop(),u.text(r.join(" ")),r=[t],u=a.append("tspan").attr("x",0).attr("y",l).attr("dy",++i*o+s+"em").text(t))})}},q={showToolTip:function(e,a,n,r,i){var o=e.pageX,l=e.pageY,s=d3.svg.line().x(function(t,e){return f[e]}).y(function(t){return t}).interpolate("closed"),u=t(h).offset().left,c=t(h).offset().top,d=u+a/2,f=[],p=[],v=10,y=10,x=10,m=5,b=10*(n.toString().length+r.toString().length),A=u,M=c;if(d>=o){f[0]=o+v-A,f[1]=o+v+m-A,f[2]=o+v+m-A,f[3]=o+v+m+b-A,f[4]=o+v+m+b-A,f[5]=o+v+m-A,f[6]=o+v+m-A,p[0]=l-y-M,p[1]=l-y-m-M,p[2]=l-y-x-M,p[3]=l-y-x-M,p[4]=l-y+x-M,p[5]=l-y+x-M,p[6]=l-y+m-M;{g.append("path").attr("d",s(p)).attr("class","toolTipPath").attr("stroke",i).attr("stroke-width",2).attr("fill","#104162").style("opacity",1)}g.append("text").attr("x",o+v+m-A+b/2-7*(r.toString().length+n.toString().length)/2).attr("y",l-M-y).text(n+"  "+r).attr("id","toolTipText").attr("dy",".3em").attr("fill","white")}else{f[0]=o-v-A,f[1]=o-v-m-A,f[2]=o-v-m-A,f[3]=o-v-m-b-A,f[4]=o-v-m-b-A,f[5]=o-v-m-A,f[6]=o-v-m-A,p[0]=l-y-M,p[1]=l-y-m-M,p[2]=l-y-x-M,p[3]=l-y-x-M,p[4]=l-y+x-M,p[5]=l-y+x-M,p[6]=l-y+m-M;{g.append("path").attr("d",s(p)).attr("class","toolTipPath").attr("stroke",i).attr("stroke-width",2).attr("fill","#104162").style("opacity",1)}g.append("text").attr("x",o-v-m-A-b/2-7*(r.toString().length+n.toString().length)/2).attr("y",l-M-y).text(n+"  "+r).attr("id","toolTipText").attr("dy",".3em").attr("fill","white")}},hideTooTip:function(){g.select(".toolTipPath").remove(),g.select("#toolTipText").remove()}},X={appendToolTip:function(){var e='<div id="tooltipChart" style="z-index:999999;float:none;display:none; margin:0px; padding:0px; position:absolute; width:150px;"><div id="textContainer" style="width:150px; background-color:rgba(197,198,197,0.7); border-radius:5px; font-family:calibri; float:left; font-size:11px; padding:10px;">	<div class="xVal" style="text-align:center; font-size:13px;border-bottom:solid 1px #7b7b7b;background:url(http://stocinn.github.io/stocweb/img/tooltip-heading-bg.jpg) repeat-x;border-top-left-radius:5px; margin-top:-10px; margin-left:-10px;  margin-right:-10px;border-top-right-radius:7px; padding:5px 10px;">14 jan</div><div id="y-label" class="y-label label1" style="width:60%;display:none; font-weight:bold; float:left; text-align:left; padding:3px 0;">Auto Loans</div><div  class="yVal label1" style="width:40%; float:right;display:none; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label2" style="width:60%; float:left;display:none;font-weight:bold; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label2" style="width:40%;display:none; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label3" style="width:60%; float:left;font-weight:bold; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label3" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label4" style="width:60%; float:left;font-weight:bold; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label4" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label5" style="width:60%; float:left;font-weight:bold; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label5" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label6" style="width:60%; float:left; font-weight:bold;text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label6" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>	</div>	<div id="rightHandIcon" style="position: relative; bottom:1px; height:31px; width:52px;	 background:url(http://stocinn.github.io/stocweb/img/toolTips-arrow.png) no-repeat;opacity:0.7; clear:both; float:right; bottom:0px; right:8px;">	 </div>	<div id="leftHandIcon" style="position: relative; bottom:1px; height:31px; width:52px;	 background:url(http://grafitome.github.io/img/toolTips-arrow-left.png) no-repeat;opacity:0.7; clear:both; float:left; bottom:0px; left:8px;">	 </div></div>';t("body").append(e)},appendToolTipOld:function(){var e="<div id='tooltipChart' style='display:none;position:absolute;background:rgba(0, 0, 0, 0.8); width:120px;  min-height: 40px; z-index:99999999 !important;box-shadow: inset 0 0 40px #222221;float:left; border-radius:5px; font-family: Calibri,Candara,Segoe,Segoe UI,Optima,Arial,sans-serif;  color:white; text-shadow: 1px 0 1px #000;    '><div class='arrow' style='position: absolute;margin-left: -8px;font-size: 24px;color:#272726; text-shadow:none; top: 7px;'><i class='fa fa-caret-left'></i></div><div id='textContainer'><div   style='clear:both;width:100%;padding:2px 5px '><div style='width:50%;float:left;' class='xVal'></div></div><div  class='yContainer1 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label'  style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal' style='width:45%;margin-left:5%;float:left;'></div></div></div></div></div>";
t("body").append(e)},showToolTip:function(e,a,n,r,i,o){var l,s=e.pageX;l=isNaN(o)?e.pageY:o;var u;u=a;var c;c=n;var d=t("#tooltipChart");t(d).find(".xVal").html(""),t(d).find(".xVal").html(c),t(d).find(".y-label").html(""),t(d).find(".yVal").html(""),t(d).find(".yVal").hide(),t(d).find(".y-label").hide();for(var f=0;f<i.length;f++){var p=i[f],g=f+1,v=".y-label.label"+g,y=".yVal.label"+g;t(d).find(v).html(p.headingName),t(d).find(y).html(p.headingVal),t(d).find(y).show(),t(d).find(v).show()}var x=s;if(t(".ps-scrollbar-x-rail"))try{x+=parseInt(t(".ps-scrollbar-x-rail").css("left").replace("px",""))}catch(m){}var b=t("body").find("#tooltipChart"),A=(t(b).find("#textContainer"),l-.98*t(b).height()),M=t(h).offset().left,k=.5*t(h).width();x>=M+k?(t(b).find("#rightHandIcon").show(),t(b).find("#leftHandIcon").hide(),x-=t(b).width()):(t(b).find("#rightHandIcon").hide(),t(b).find("#leftHandIcon").show()),t(b).css("left",x),t(b).css("top",A),t(b).show()},hideTooTip:function(){t("#tooltipChart").find(".yVal").html(""),d3.select("#tooltipChart").style("display","none")},showToolTipForBarWithMultipleLine:function(e,a,n,r,i,o){{var l,s=e.pageX;e.pageY-t(h).find("svg").offset().top-10}l=n,t("#draggLineToolTip").find(".xVal").html(r?"":l),o?t("#draggLineToolTip").find("#tooltip-dragger").show():t("#draggLineToolTip").find("#tooltip-dragger").hide(),d3.select("#draggLineToolTip").selectAll(".yDiv").style("display","none");var u=1;for(key in a){{t(".yContainer"+u).show()}d3.select("#y-label"+u).html(key+" "),d3.select("#yVal"+u).html(" "+a[key]),u++}var c=s+_.left;if(t(".ps-scrollbar-x-rail"))try{c+=parseInt(t(".ps-scrollbar-x-rail").css("left").replace("px",""))}catch(d){}var f=t("body").find("#draggLineToolTip"),p=t(f).find("#textContainer");t(window).width()-c<t("body").find("#draggLineToolTip").width()?(c-=t(f).width(),t(f).css("-ms-transform","rotate(-180deg) translate(15px)"),t(f).css("-webkit-transform","rotate(-180deg) translate(15px)"),t(f).css("transform","rotate(-180deg) translate(15px)"),t(p).css("-ms-transform"," translateY(10px) rotate(180deg)"),t(p).css("-webkit-transform","translateY(10px)  rotate(180deg)"),t(p).css("transform","translateY(10px) rotate(180deg)")):(t(f).css("-ms-transform",""),t(f).css("-webkit-transform",""),t(f).css("transform",""),t(p).css("-ms-transform",""),t(p).css("-webkit-transform",""),t(p).css("transform",""));var g=e.pageY-t(h).find("#draggLineToolTip").height()/2;null!=i?t("body").find("#draggLineToolTip").css("left",c):t("body").find("#draggLineToolTip").css("left",c-5),t("body").find("#draggLineToolTip").css("top",g-20),t("body").find("#draggLineToolTip").show()},hideMulitpleLineBarToolTip:function(){d3.select("#draggLineToolTip").style("display","none")},appendToolTipForBarWithMultipleLine:function(){var e="<div id='draggLineToolTip' style='display:none;position:absolute;background:rgba(0, 0, 0, 0.8); width:120px;  min-height: 40px; z-index:99999999 !important;box-shadow: inset 0 0 40px #222221;float:left; border-radius:5px; font-family: Calibri,Candara,Segoe,Segoe UI,Optima,Arial,sans-serif;  color:white; text-shadow: 1px 0 1px #000;    '><div  id='tooltip-dragger' style='position: absolute;margin-left: -8px; border-left:solid 1px #000; min-height:250px; top:-100px;'></div><div class='arrow' style='position: absolute;margin-left: -8px;font-size: 24px;color:#272726; text-shadow:none; top: 7px;'><i class='fa fa-caret-left'></i></div><div id='textContainer'><div   style='clear:both;width:100%;padding:2px 5px '><div style='width:50%;float:left;' class='xVal'></div></div><div  class='yContainer1 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label1'  style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal1' style='width:42%;float:left;margin-left:8%;'></div></div><div  class='yContainer2 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label2' style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal2' style='width:42%;float:left;margin-left:8%;'></div></div><div  class='yContainer3 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label3' style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal3' style='width:42%;float:left;margin-left:8%;'></div></div><div  class='yContainer4 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label4' style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal4' style='width:42%;float:left;margin-left:8%;'></div></div><div  class='yContainer5 yDiv' style='clear:both;width:100%;padding:5px'><label id='y-label5' style='width:50%;float:left;'>Value</label><div class='yVal' id='yVal5' style='width:42%;float:left;margin-left:8%;'></div></div></div></div></div>";t("body").append(e)}},U={init:function(t,e,a,n,r,i){var o=Math.ceil(.15*e),l=Math.ceil(.5*e),s=Math.ceil(e/o),u=Math.ceil(a/l);t.selectAll(".hline").data(d3.range(s)).enter().append("line").attr("class","horizontalGridLine").attr("y1",function(t){return t*o+6}).attr("y2",function(t){return t*o+6}).attr("x1",function(){return 0}).attr("x2",function(){return a}).style("stroke",i).style("stroke-width",.3).attr("transform","translate("+n+","+r+")"),t.selectAll(".vline").data(d3.range(u)).enter().append("line").attr("class","verticalGridLine").attr("x1",function(t){return t*l}).attr("x2",function(t){return t*l}).attr("y1",function(){return 0}).attr("y2",function(){return e}).style("stroke",i).style("stroke-width",.3).attr("transform","translate("+n+","+r+")")}},H={drawLine:function(e){var a,e=t.extend({color:"red",axisColor:"blue",data:[],xFieldName:"",yFieldName:"",showAllTicks:!1,formatDate:"%b %d"},e);a=0==e.data.length?T:e.data;var n,r;if(n=""==e.xFieldName?N:e.xFieldName,r=""==e.yFieldName?D:e.yFieldName,0==t(h).find(".axis").length){var i=d3.time.format(e.formatDate);e.showAllTicks&&b.ticks(d3.time.days,1).tickFormat(i).tickSize(0).tickPadding(8),b.tickFormat(i).tickSize(0).tickPadding(8),g.append("g").attr("class","x axis").attr("transform","translate(0,"+(y-_.scale+10)+")").attr("stroke",e.axisColor).attr("fill","none").call(b).selectAll(".tick").each(function(t){var e=new Date(t);e=convertDateIntoYYMMDD(e),g.append("line").attr("class","horizontalGridLine").attr("x1",function(){return M(I.parse(e))}).attr("x2",function(){return M(I.parse(e))}).attr("y1",0).attr("y2",y-_.scale+10).attr("stroke","#F2F3F3")}),g.append("g").attr("class","y axis").attr("transform","translate("+(v-_.scale+10)+",3)").attr("fill",e.axisColor).call(m)}{var o=d3.svg.line().interpolate("linear").x(function(t){return M(I.parse(t[n]))+5}).y(function(t){return A(t[r])-10}),l=t(h).attr("id")+"_line"+D;g.append("path").attr("d",o(a)).attr("stroke",e.color).attr("class",l).attr("stroke-width","2").attr("fill","none").on("mouseover",function(){attachToolTip.showToolTip(d3.event)}).on("mouseleave",function(){attachToolTip.hideToolTip(d3.event)})}},drawBarWithMultipleLineAndCircle:function(e){function a(t,e){return(H=d3.svg.line().interpolate(t).x(function(t){return M(t.x)}).y(function(t){var e=I[t.name];return e(t.y)}))(e)}var e=t.extend({data:[],xAxis:[],marginLeft:40,marginRight:40,marginTop:60},e),n=e.xAxis.ticks;X.appendToolTipForBarWithMultipleLine();var r=e.data,i=[];i=d3.keys(e.data);var o=d3.scale.ordinal(),l=[],s=[];for(key in r){var u=r[key];l.push(u.color),s.push(u.data)}o.domain(i),o.range(l);for(var c=0,d=o.domain().map(function(t){return{name:t,values:r[t].data.map(function(a,n){return{x:n,y:a,timeIndex:e.xAxis.ticks[n],name:t,indicationLabel:r[t].indicationLabel}}),chartType:r[t].chartType,lineType:r[t].lineType}}),f={},p=0;p<d.length;p++)f[d[p].name]="legend-"+p;for(var k=[],w=0;w<d[0].values.length;w++){for(var u={},T=0;T<i.length;T++)u[i[T]]=d[T].values[w].y+":"+d[T].values[w].indicationLabel;u.x=w,u.timeIndex=e.xAxis.ticks[w],k.push(u)}C=1.4*C,y-=1.5*e.marginTop;for(var L=!1,N=0,D=0,P=40,_=40,I={},p=0;p<i.length;p++){L=!L,L?D=D+e.marginRight+P:N=N+e.marginLeft+P,S=d3.min(r[i[p]].data,function(t){return t}),C=d3.max(r[i[p]].data,function(t){return t}),C=1.5*C,A=d3.scale.linear().domain([S,C]).range([y,0]),I[i[p]]=A;var V=B.getTickArray(S,C,5),F=g.append("g").attr("class","y axis").attr("transform",function(){return L?(m=d3.svg.axis().scale(A).orient("right").tickValues(V).tickSize(5,0),"translate("+(v-D)+","+e.marginTop+")"):(m=d3.svg.axis().scale(A).orient("left").tickValues(V).tickSize(5,0),"translate("+N+","+e.marginTop+")")}).attr("stroke",e.axisColor).attr("fill","none").call(m);if(F.selectAll("text").text(function(t){return t+" "+r[i[p]].unit}).style("fill",r[i[p]].color),L){var O=y/2+2*r[i[p]].indicationLabel.length;F.append("text").text(function(){return r[i[p]].indicationLabel}).attr("transform","translate("+(P+_)+","+O+") rotate(-90)").style("fill",r[i[p]].color)}else{var O=y/2+2*r[i[p]].indicationLabel.length;F.append("text").text(function(){return r[i[p]].indicationLabel}).attr("transform","translate("+(-P-_/2)+","+O+") rotate(-90)").style("fill",r[i[p]].color)}0==p&&F.selectAll(".tick").each(function(t){g.append("line").attr("class","horizontalGridLine").attr("x1",N).attr("x2",v-D).attr("y1",function(){return A(t)}).attr("y2",function(){return A(t)}).attr("stroke","#F2F3F3")}).style("display",function(){return e.hideAxis?"none":"block"})}v-=N;var z=g.append("g").attr("transform","translate("+(N-40)+","+e.marginTop+")").attr("class","grouping");M=d3.scale.linear().range([N,v-D]);var G=d3.min(d,function(t){return d3.min(t.values,function(t){return t.x})}),R=d3.max(d,function(t){return d3.max(t.values,function(t){return t.x})});M.domain([G,R]);for(var E=0,c=0;c<n.length;c++)E<n[c].toString().length&&(E=n[c].toString().length);b=d3.svg.axis().scale(M).orient("bottom").tickValues(B.getXTickArray(0,n.length-1,E,v-D-N));var Y=g.append("g").attr("class","x axis").attr("transform","translate("+(N-40)+","+(y+e.marginTop)+")").attr("stroke",e.axisColor).attr("fill","none").call(b);Y.selectAll("text").text(function(t){return n[t]}).style("fill",x.legendTextColor);var J=d.filter(function(t){return"bar"==t.chartType}),q=v/J[0].values.length;q/=2;var U=z.selectAll(".bar").data(J[0].values).enter().append("rect").attr("class",function(t){return"multichart bar "+f[t.name]+" pos_"+Math.floor(M(t.x))}).attr("width",q).attr("height",function(){return 0}).attr("x",function(){return 0}).attr("y",function(t){var e=I[t.name];return e(t.y)});U.transition().duration(1e3).attr("x",function(t){return M(t.x)-q/2}).attr("height",function(t){var e=I[t.name];return y-e(t.y)}).attr("fill",function(t){return o(t.name)});var H,j=z.selectAll("g.multipleLineGrouping").data(d.filter(function(t){return"bar"!=t.chartType})).enter().append("g").attr("class","multipleLineGrouping"),W=j.append("path").attr("d",function(t){return a(t.lineType,t.values)}).attr("class",function(t){return"multipleLine "+f[t.name]+" pos_"+Math.floor(M(t.x))}).attr("stroke",function(t){return o(t.name)}).attr("fill","none"),$=W.node().getTotalLength();W.attr("stroke-dasharray",function(t){for(var e=3,a=2*e,n=e;$>a;)n+=","+e+","+e,a+=2*e;return dottedLineParam=r[t.name].isDottedLine?n+","+$:$+","+$,dottedLineParam}).attr("stroke-dashoffset",$).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0),j.selectAll("circle.multipleLineCircle").data(function(t){return t.values}).enter().append("circle").attr("class",function(t){return"multichart  multipleLineCircle "+f[t.name]+" pos_"+Math.floor(M(t.x))}).attr("cx",function(t){return M(t.x)}).attr("cy",function(t){var e=I[t.name];return e(t.y)}).attr("r","3").attr("fill",function(t){return o(t.name)});var Z=(v-D)/o.domain().slice().length;Z=N+Z;var K=z.selectAll(".legend").data(o.domain().slice().reverse()).enter().append("g").attr("transform",function(t,e){return"translate("+Z*(e+1)/2+",0)"}),Q=18,te=10,ee=0,ae=ee+Q+te;K.append("rect").attr("x",ee).attr("width",12).attr("height",12).style("fill",o).attr("class",function(t){return"legend-rect "+f[t]}).on("click",function(e){if(-1!=d3.select(this).attr("class").indexOf("disable")){var a="legend-rect";d3.select(this).attr("class",a),d3.select(this).style("fill",o),g.select(".legend-text."+f[e]).style("text-decoration","none"),t(h).find(".multipleLineCircle."+f[e]).show();var n=g.selectAll(".multipleLine."+f[e]);n.transition().duration(1e3).ease("linear").attr("stroke-dashoffset",0),g.selectAll(".bar."+f[e]).transition().duration(1e3).attr("y",function(t){return A(t.y)}).attr("height",function(t){return y-A(t.y)})}else{t(this).addClass("disable");var a=t(this).attr("class");a+="  disable",d3.select(this).attr("class",a),d3.select(this).style("fill","grey"),g.select(".legend-text."+f[e]).style("text-decoration","line-through"),t(h).find(".multipleLineCircle."+f[e]).hide();var n=g.selectAll(".multipleLine."+f[e]);n.transition().duration(1e3).ease("linear").attr("stroke-dashoffset",$),g.selectAll(".bar."+f[e]).transition().duration(1e3).attr("y",A(S)).attr("height",0)}}),K.append("text").attr("x",ae).attr("y",6).attr("dy",".35em").style("text-anchor","start").attr("class",function(t){return"legend-text  "+f[t]}).text(function(t){return t}).style("fill",x.legendTextColor),d3.selectAll(".multichart").on("mouseover",function(){var e=t(this).attr("class").split(" "),a=e[e.length-1];d3.selectAll("."+a).attr("stroke","blue");for(var n,r=d3.selectAll("circle."+a).attr("cx"),o=Math.floor(Math.floor(M.invert(r))),l=0;l<k.length;l++)k[l].x==o&&(n=k[l]);if(void 0!==n){for(var s="",u={},l=0;l<i.length;l++){var c=i[l],d=n[c].split(":")[0],f=n[c].split(":")[1];s+=c+" : "+d+" : "+f+" ",u[f]=d}X.showToolTipForBarWithMultipleLine(d3.event,u,n.timeIndex,!1,r,!0)}else X.hideMulitpleLineBarToolTip()}).on("mouseout",function(){d3.selectAll(".multichart").attr("stroke",""),X.hideMulitpleLineBarToolTip()})}},W={drawBrushing:function(e){function a(){var t=d3.mouse(this);s=l.append("g").attr("transform","translate(0,"+_.top+")").attr("class","brushedArea").append("rect").attr("class","brushedArea").attr("x",t[0]).attr("y",A(C)).attr("width",0).attr("height",function(){return d}).style("fill","rgba(1,1,1,.3)"),p=t[0],l.on("mousemove",i),f=!0}function n(){return o}function r(){if(f=!1,g){g=!1;for(var a=n(),r=0,i=0,o=!1,s=!1,d=0;d<a.length;d++){{a[d]}u==d&&(r=d,console.error("*** matched**"),o=!0),c==d&&(i=d,s=!0,console.error("*** matched ending**"))}o&&s&&(a=a.slice(r,i+1),i>r+3?(t(h).find("svg g").empty(),t(h).find(".brushedArea").remove(),l.on("mousemove",null),l.on("mousedown",null),l.on("mouseup",null),e(a)):(alert("further  zooming is not feasible"),t(h).find(".brushedArea").remove()))}}function i(){if(console.log("Mosuemove"),f){t(h).find("#tooltipChart").hide();var e=d3.mouse(this),a=e[0]-p;s.attr("width",a),u=Math.round(M.invert(e[1])),c=Math.round(M.invert(e[0])),console.log(Math.round(M.invert(e[1]))+":::"+Math.round(M.invert(e[0]))),g=!0}}var o=data,l=d3.select("."+t(h).attr("id")+"_svg");l.on("mousedown",a).on("mouseup",r);var s,u,c,d=y-_.scale,f=!1,p=0,g=!1}},$={barChart:function(e){var a,e=t.extend({color:"red",axisColor:"blue",data:[],hideYAxis:!1,widthOfBar:"",formatDate:"%b %d",showAllTicks:!1,yFieldName:"",textonBar:!1,yFieldName:"",padding:0,attachBrushEvent:!1,xAxisIndicationLabel:"",yAxisIndicationLabel:""},e);a=0==e.data.length?T:e.data;var n;n=""==e.yFieldName?D:e.yFieldName;var r;r=""==e.widthOfBar?Math.floor((v-_.scale)/a.length):e.widthOfBar;var i=t(h).attr("id"),o=i+"_rect_"+n;if(0==t(h).find(".axis").length){var l=d3.time.format(e.formatDate);e.showAllTicks&&b.ticks(d3.time.days,1).tickFormat(l).tickSize(0).tickPadding(8),b.tickFormat(l).tickSize(0).tickPadding(8);var s=g.append("g").attr("class","x axis").attr("transform","translate(0,"+(y-_.scale+10)+")").attr("stroke",e.axisColor).attr("fill","none").call(b);s.selectAll(".tick").each(function(t){var e=new Date(t);e=convertDateIntoYYMMDD(e),g.append("line").attr("class","horizontalGridLine").attr("x1",function(){return M(I.parse(e))}).attr("x2",function(){return M(I.parse(e))}).attr("y1",0).attr("y2",y-_.scale+10).attr("stroke","#F2F3F3")});var u=g.append("g").attr("class","y axis").attr("transform","translate("+(v-_.scale+10)+",3)").attr("stroke",e.axisColor).attr("fill","none").call(m);u.selectAll(".tick").each(function(t){g.append("line").attr("class","horizontalGridLine").attr("x1",0).attr("x2",v-_.scale+10).attr("y1",function(){return A(t)+3}).attr("y2",function(){return A(t)+3}).attr("stroke","#F2F3F3")}).style("display",function(){return e.hideAxis?"none":"block"})}var c=g.selectAll("."+o).data(a).enter().append("rect").attr("class",o).attr("x",function(t){return M(I.parse(t[N]))+e.padding}).attr("y",function(t){return A(t[n])}).attr("width",r).attr("height",function(){return A(C)}).on("mouseover",function(t){var e=t[n];d3.select(this).attr("fill","red");var a=I.parse(t[N]),r=convertDateIntoYYMMDD(a);attachToolTip.showToolTip(d3.event,e,r,void 0)}).on("mouseleave",function(t){t[n];d3.select(this).attr("fill",e.color),attachToolTip.hideTooTip()});c.transition().duration(2e3).attr("height",function(t){return y-_.scale-A(t[n])}).attr("fill",e.color),e.textonBar&&g.selectAll(".barText").data(a).enter().append("text").text(function(t){return parseInt(t[n])}).attr("x",function(t){return M(I.parse(t[N]))+2.5}).attr("y",function(t){return A(t[n])+20}),e.attachBrushEvent&&W.drawBrushing(a)},mulipleBarChart:function(e){for(var a,n,e=t.extend({barChartArray:[]},e),r=e.barChartArray,i=0;i<r.length;i++){var o=r[i],l=o.yFieldName,s=d3.extent(o.data,function(t){return t[l]});0==i?(a=s[0],n=s[1]):(a>s[0]&&(a=s[0]),n<s[1]&&(n=s[1]))}A.domain([a,n+3]);for(var i=0;i<r.length;i++){var o=r[i],u={};for(key in o)u[key]=o[key];this.barChart(u)}},stackedBarChart:function(e){function a(a,r){o=d3.keys(n[0]).filter(function(t){var a;return a=t!=e.xFieldName&&void 0==r[t]&&"groupedData"!=t&&"total"!=t});var s=n;s.forEach(function(t){var e=0;t.groupedData=o.map(function(a){return{x:t[N],y0:e,y1:e+=+t[a],name:a,exactYVal:t[a]}}),t.total=t.groupedData[t.groupedData.length-1].y1}),C=d3.max(s,function(t){return t.total}),S=d3.min(s,function(t){return t.total}),C=1.5*C;var u=d3.scale.linear().domain([0,C]).range([y,0]);m=d3.svg.axis().scale(u).orient("right").ticks(4).tickSize(5,0).tickFormat(d3.format(".2s")),g.select(".y.axis").call(m).selectAll(".tick").each(function(t){g.selectAll(".horizontalGridLine").attr("x1",0).attr("x2",v).attr("y1",function(){return u(t)}).attr("y2",function(){return u(t)}).attr("stroke","#F2F3F3")}).style("display",function(){return e.hideAxis?"none":"block"});var f=g.selectAll("g.stack-grouping").data(s).enter().append("g").attr("class","stack-grouping"),h=f.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(t){return M(t.x)}).attr("y",function(){return u(0)}).attr("class",function(t){return l[t.name]+" bar"}).attr("width",M.rangeBand()).attr("height",function(){return 0}).style("fill",function(t){return i[t.name]}).on("mousemove",function(t){d3.select(this).attr("fill","yellow");var a=[{headingName:e.columnHeadingArray[t.name],headingVal:t.exactYVal}];X.showToolTip(d3.event,"",t.x,!1,a,.9*d3.event.pageY)}).on("mouseleave",function(){var e=d3.select(this);d3.select(this).attr("fill",t(e).parents("g").attr("fill")),X.hideTooTip()});h.transition().duration(2e3).attr("height",function(t){return u(t.y0)-u(t.y1)}).attr("y",function(t){return u(t.y1)}).attr("fill",function(t){return i[t.name]}),c(g),d(g)}var e=t.extend({data:[],xFieldName:"",widthOfBar:"",axisColor:"black",hideAxis:!1,showAllTicks:!1,redrawing:!0,columnHeadingArray:[],xAxisIndicationLabel:"",yAxisIndicationLabel:""},e);v=v-V-_.left,y-=.25*y;var n=e.data;N=e.xFieldName;var r,i=(d3.layout.stack(),e.colorArray);r=""==e.widthOfBar?Math.floor(v/data.length):e.widthOfBar;for(var o=d3.keys(n[0]).filter(function(t){return t!=e.xFieldName}),l={},s=0;s<o.length;s++)l[o[s]]="legend-"+s;var u=n;u.forEach(function(t){var e=0;t.groupedData=o.map(function(a){return{x:t[N],y0:e,y1:e+=+t[a],name:a,exactYVal:t[a]}}),t.total=t.groupedData[t.groupedData.length-1].y1});for(var f=0;f<u.length;f++){u[f].groupedData}C=d3.max(u,function(t){return t.total}),S=d3.min(u,function(t){return t.total}),C=1.5*C,A=d3.scale.linear().domain([0,C]).range([y,0]),g=g.append("g").attr("transform","translate(0,"+_.top+")"),M=d3.scale.ordinal().rangeRoundBands([0,v],.1),M.domain(u.map(function(t){return t[N]})),b=d3.svg.axis().scale(M).orient("bottom"),m=d3.svg.axis().scale(A).orient("right").ticks(4).tickSize(5,0).tickFormat(d3.format(".2s"));var p=g.append("g").attr("class","x axis").attr("transform","translate(0,"+y+")").attr("fill","none").call(b);p.selectAll("text").attr("transform","translate(0,15) rotate(0)"),p.selectAll("text").call(J.wrapText,M.rangeBand());var k=g.append("g").attr("class","y axis").attr("transform","translate("+v+",0)").attr("fill","none").call(m);if(k.selectAll(".tick").each(function(){}).style("display",function(){return e.hideAxis?"none":"block"}),""!=e.xAxisIndicationLabel){var w=20,T=(_.scale-w/3,y+_.scale-w,y+_.scale+w,6),L=e.xAxisIndicationLabel.toString().length*T,D=.2*y,P=v/2-L/2;R.appendLabel(e.xAxisIndicationLabel,P,D,0,p,x.xLabelColor,600)}if(""!=e.yAxisIndicationLabel){var I=40,F=y/2-20,O=F+I,z=(v+_.scale-_.left+10,g.append("g").attr("transform","translate("+(v+V-_.left+5)+","+(O+30)+")"));R.appendLabel(e.yAxisIndicationLabel,0,.4*-(O+30),90,z,x.yLabelColor,600)}var G=g.selectAll("g.stack-grouping").data(u).enter().append("g").attr("class","stack-grouping"),E=G.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(t){return M(t.x)}).attr("y",function(){return A(0)}).attr("class",function(t){return l[t.name]+" bar"}).attr("width",M.rangeBand()).attr("height",function(){return 0}).style("fill",function(t){return i[t.name]}).on("mousemove",function(t){d3.select(this).attr("fill","yellow");var a=[{headingName:e.columnHeadingArray[t.name],headingVal:t.exactYVal}];X.showToolTip(d3.event,"",t.x,!1,a,.9*d3.event.pageY)}).on("mouseleave",function(){var e=d3.select(this);d3.select(this).attr("fill",t(e).parents("g").attr("fill")),X.hideTooTip()});E.transition().duration(1e3).attr("height",function(t){return A(t.y0)-A(t.y1)}).attr("y",function(t){return A(t.y1)});var Y=d3.keys(i),B=g.selectAll(".legend").data(Y).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate("+_.left+","+(10+20*e)+")"}),q=18,U=10,H=0,j=H+q+U,W={};B.append("rect").attr("x",H).attr("width",18).attr("height",18).style("fill",function(t){return i[t]}).on("click",function(e){var n=!1;t("rect."+l[e]).length>1?(n=!0,W[e]=e,d3.select(this).style("text-decoration","grey"),d3.select(".legend-text."+l[e]).style("text-decoration","line-through")):(n=!1,delete W[e],d3.select(this).style("fill",i[e]),d3.select(".legend-text."+l[e]).style("text-decoration","none")),t(h).find("rect.bar").remove(),t(h).find("g.stack-grouping").remove(),a(e,W)}),B.append("text").attr("x",j).attr("y",9).attr("dy",".35em").style("text-anchor","start").attr("class",function(t){return"legend-text  "+l[t]}).text(function(t){return t}),c(g),d(g)},groupedBarChart:function(e){function a(t,a){s=d3.keys(l[0]).filter(function(t){var n;return n=t!=e.xFieldName&&void 0==a[t]&&"groupedData"!=t&&"timeIndex"!=t});l.forEach(function(t,e){t.groupedData=s.map(function(e){return{xVal:e,yVal:t[e],xFieldName:t[N]}}),t.timeIndex=e}),C=d3.max(i,function(t){return d3.max(t.groupedData,function(t){return t.yVal})}),C=1.5*C,A.domain([0,C]),m=d3.svg.axis().scale(A).orient("right").ticks(4).tickSize(5,0),k.domain(s).rangeRoundBands([0,p.rangeBand()]),g.selectAll(".y.axis").call(m);{var n=g.selectAll("g.bar-grouping").data(l).enter().append("g").attr("class","bar-grouping").attr("transform",function(){return"translate("+p(0)+",0)"});n.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(t){return k(t.xVal)}).attr("y",function(t){return A(t.yVal)}).attr("class",function(t){return"groupBar "+u[t.xVal]}).attr("fill",function(t){return e.colors[t.xVal]}).attr("width",k.rangeBand()/1.2).attr("height",function(t){return y-A(t.yVal)}).attr("xFieldVal",function(t){return t.xFieldVal}).on("mousemove",function(t){d3.select(this).attr("fill","yellow");var a=(d3.select(this).attr("xFieldVal"),[{headingName:t.xVal,headingVal:t.yVal}]);X.showToolTip(d3.event,"",e.xAxisfactor+" "+t.xFieldName,!1,a,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);d3.select(this).attr("fill",function(t){return e.colors[t.xVal]}),X.hideTooTip()})}n.transition().duration(function(t,e){return 190*e}).attr("transform",function(t){return"translate("+p(t.timeIndex)+",0)"}),c(g),d(g)}var e=t.extend({data:[],xFieldName:"",widthOfBar:"",axisColor:"#a7a7a7",hideAxis:!1,yIndicationLabel:"Value"},e),n=45;v=v-V-_.left,y=y-n-_.top;var r,i=(d3.layout.stack(),[]),o="";o=d3.scale.category20;var l=(e.colors,e.data);N=e.xFieldName,r=""==e.widthOfBar?Math.floor(v/l.length):e.widthOfBar;var s=d3.keys(l[0]).filter(function(t){return t!=e.xFieldName});l.forEach(function(t,e){t.groupedData=s.map(function(a){return{xVal:a,yVal:t[a],timeIndex:e,xFieldVal:t[N]}}),t.timeIndex=e}),U.init(g,y,v,_.left,.2*y,x.gridLineColor);for(var u={},f=0;f<s.length;f++)u[s[f]]="legend-"+f;i=l,M=d3.time.scale().range([0,v],.5),M.domain(d3.extent(l,function(t){return t.timeIndex}));var p=d3.scale.ordinal().rangeRoundBands([15,v],.5),k=d3.scale.ordinal();p.domain(i.map(function(t){return t.timeIndex})),k.domain(s).rangeRoundBands([0,p.rangeBand()]),A=d3.scale.linear().range([y,0]),C=d3.max(i,function(t){return d3.max(t.groupedData,function(t){return t.yVal})}),C=1.5*C,A.domain([0,C]),g=g.append("g").attr("transform","translate("+_.left+","+_.top+")");for(var w=0,S=[],T=0;T<i.length;T++)S[T]=i[T][N],w<S[T].toString().length&&(w=S[T].toString().length);b=d3.svg.axis().scale(p).orient("bottom").tickValues(B.getXTickArray(0,S.length,w,v)),m=d3.svg.axis().scale(A).orient("right").ticks(4).tickSize(5,0);var L=g.append("g").attr("class","x axis").attr("transform","translate(0,"+y+")").attr("fill",e.axisColor).attr("fill","none").call(b);L.selectAll("text").text(function(t){return S[t]}).attr("fill","black");var D=g.append("g").attr("class","y axis").attr("transform","translate(5,0)").attr("fill",e.axisColor).attr("fill","none");D.call(m).selectAll(".tick").each(function(){}).style("display",function(){return e.hideAxis?"none":"block"});{var P=y/1.5+e.yAxisfactor.length/2*5;1.2*_.right}R.appendLabel(e.yAxisfactor,5,P,-90,g,x.yLabelColor,600);var I=6,F=e.xAxisfactor.length*I,O=v/2-F/2,z=n-5;R.appendLabel(e.xAxisfactor,O,z,0,L,x.xLabelColor,600);var I=9,E=(v+V+_.left)/2-e.title.length*I/2,Y=g.append("g").attr("class","title");R.appendLabel(e.title,E,_.top,0,Y,x.chartTitleColor,800);var J=g.selectAll("g.bar-grouping").data(i).enter().append("g").attr("class","bar-grouping").attr("transform",function(t){return"translate("+p(t.timeIndex)+",0)"}),q=J.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(){return k(0)}).attr("y",function(){return A(0)}).attr("class",function(t){return"groupBar "+u[t.xVal]}).attr("fill",function(t){return e.colors[t.xVal]}).attr("width",k.rangeBand()/1.2).attr("height",function(t){return y-A(t.yVal)}).on("mousemove",function(t){d3.select(this).attr("fill","yellow");var a=[{headingName:t.xVal,headingVal:t.yVal}];X.showToolTip(d3.event,"",e.xAxisfactor+" "+t.xFieldVal,!1,a,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);d3.select(this).attr("fill",function(t){return e.colors[t.xVal]}),X.hideTooTip()});q.transition().duration(function(t,e){return 600*e}).attr("x",function(t){return k(t.xVal)}).attr("y",function(t){return A(t.yVal)});for(var H=0,f=0;f<s.length;f++)H=H<s[f].length?s[f].length:H;{var j=10,W=10,$={},Z=G.showHorizontalLegend(v,0,s,j,W),K=g.append("g").attr("class","legend").attr("transform","translate("+(_.left+20)+","+(_.top+15)+")");K.selectAll(".rect").data(s).enter().append("rect").attr("id","legendRectangle").attr("width",j).attr("height",W).attr("x",function(t,e){return Z[e].x}).attr("y",function(t,e){return Z[e].y}).style("fill",function(t){return e.colors[t]}).attr("index",function(t,e){return e}).on("click",function(n){{var r=!1;parseInt(d3.select(this).attr("index"))}g.selectAll("rect."+u[n]).empty()?(r=!1,delete $[n],d3.select(this).style("fill",function(t){return e.colors[t]}),g.select(".legend-text."+u[n]).style("text-decoration","none")):(r=!0,$[n]=n,d3.select(this).style("fill","grey"),g.select(".legend-text."+u[n]).style("text-decoration","line-through")),t(h).find("rect.groupBar").remove(),t(h).find(".bar-grouping").remove(),a(n,$)}),K.selectAll(".text").data(s).enter().append("text").attr("class",function(t){return"legend-text  "+u[t]}).attr("id",function(t,e){return"text"+e}).attr("x",function(t,e){return Z[e].textXPos}).attr("y",function(t,e){return Z[e].y}).text(function(t,e){return s[e]}).attr("dy",".7em")}c(g),d(g)},groupedBar2DChart:function(e,a){function n(t,a){u=d3.keys(s[0]).filter(function(t){var n;return n=t!=e.xFieldName&&void 0==a[t]&&"groupedData"!=t&&"timeIndex"!=t}),s.forEach(function(t,e){t.groupedData=u.map(function(e){return{xVal:e,yVal:t[e],xFieldName:t[N]}}),t.timeIndex=e});var n,i=s,o=d3.max(i,function(t){return d3.max(t.groupedData,function(t){return t.yVal})}),l=d3.min(i,function(t){return d3.min(t.groupedData,function(t){return t.yVal})});n=isNaN(r)?Math.ceil((o+l)/2):r,o=1.9*o,A.domain([l,o]),m=d3.svg.axis().scale(A).orient("right").ticks(4).tickSize(5,0),w.domain(u).rangeRoundBands([0,k.rangeBand()]),g.selectAll(".horizontalGridLine").remove();var h=B.getTickArray(T,C,5);m.tickValues(h),g.selectAll(".y.axis").call(m).selectAll(".tick").each(function(){}).style("display",function(){return e.hideAxis?"none":"block"});{var p=g.selectAll("g.bar-grouping").data(i).enter().append("g").attr("class","bar-grouping").attr("transform",function(){return"translate("+k(0)+",0)"});p.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(t){return w(t.xVal)}).attr("y",function(t){return A(A(t.yVal)>=A(n)?n:t.yVal)}).attr("class",function(t){return"groupBar "+f[t.xVal]}).attr("fill",function(t){return e.colors[t.xVal]}).attr("width",w.rangeBand()/1.2).attr("height",function(t){return A(t.yVal)>=A(n)?A(t.yVal)-A(n):A(n)-A(t.yVal)}).on("mousemove",function(t){d3.select(this).attr("fill","yellow");var a=[{headingName:t.xVal,headingVal:t.yVal}];X.showToolTip(d3.event,"",e.xAxisfactor+" "+t.xFieldName,!1,a,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);d3.select(this).attr("fill",function(t){return e.colors[t.xVal]}),X.hideTooTip()})}p.transition().duration(function(t,e){return 190*e}).attr("transform",function(t){return"translate("+k(t.timeIndex)+",0)"}),c(g),d(g)}var r,e=t.extend({data:[],xFieldName:"",widthOfBar:"",axisColor:"#a7a7a7",hideAxis:!1,yIndicationLabel:"Value",midVal:""},e);r=isNaN(a)?"":a,v=v-V-_.left,y-=V,y=.9*y;var i,o=(d3.layout.stack(),[]),l="";l=d3.scale.category20;var s=(e.colors,e.data);N=e.xFieldName,i=""==e.widthOfBar?Math.floor(v/s.length):e.widthOfBar;var u=d3.keys(s[0]).filter(function(t){return t!=e.xFieldName});s.forEach(function(t,e){t.groupedData=u.map(function(e){return{xVal:e,yVal:t[e],xFieldVal:t[N]}}),t.timeIndex=e});for(var f={},p=0;p<u.length;p++)f[u[p]]="legend-"+p;o=s,M=d3.time.scale().range([0,v],.5),M.domain(d3.extent(s,function(t){return t.timeIndex}));var k=d3.scale.ordinal().rangeRoundBands([0,v],.5),w=d3.scale.ordinal();k.domain(o.map(function(t){return t.timeIndex})),w.domain(u).rangeRoundBands([0,k.rangeBand()]),A=d3.scale.linear().range([y,0]),C=d3.max(o,function(t){return d3.max(t.groupedData,function(t){return t.yVal})});var S,T=d3.min(o,function(t){return d3.min(t.groupedData,function(t){return t.yVal})});S=isNaN(r)?Math.ceil((C+T)/2):r,C=1.9*C,A.domain([T,C]),g=g.append("g").attr("transform","translate("+_.left+","+_.top+")");for(var L=0,D=[],P=0;P<o.length;P++)D[P]=o[P][N],L<D[P].toString().length&&(L=D[P].toString().length);b=d3.svg.axis().scale(k).orient("bottom").tickValues(B.getXTickArray(0,D.length,L,v)),m=d3.svg.axis().scale(A).orient("right").ticks(4).tickSize(5,0);
var I=g.append("g").attr("class","x axis").attr("transform","translate(0,"+y+")").attr("fill",e.axisColor).attr("fill","none");I.call(b).selectAll("text").text(function(t){return D[t]}).attr("fill","black");var F=g.append("g").attr("class","y axis").attr("transform","translate("+v+",0)").attr("fill",e.axisColor).attr("fill","none"),O=B.getTickArray(T,C,5);-1==O.indexOf(S)&&O.push(S),m.tickValues(O),F.call(m).selectAll(".tick").each(function(){}).style("display",function(){return e.hideAxis?"none":"block"});var z=y/1.5+e.yAxisfactor.length/2*5,G=1.2*_.right;R.appendLabel(e.yAxisfactor,G,z,-90,F,x.yLabelColor,600);var E=6,Y=e.xAxisfactor.length*E,J=v/2-Y/2,q=.15*y;R.appendLabel(e.xAxisfactor,J,q,0,I,x.xLabelColor,600);var E=9,U=(v+V+_.left)/2-e.title.length*E/2,H=g.append("g").attr("class","title");R.appendLabel(e.title,U,.06*y,0,H,x.chartTitleColor,800);var j=g.selectAll("g.bar-grouping").data(o).enter().append("g").attr("class","bar-grouping").attr("transform",function(t){return"translate("+k(t.timeIndex)+",0)"}),W=j.selectAll("rect").data(function(t){return t.groupedData}).enter().append("rect").attr("x",function(){return w(0)}).attr("y",function(){return A(S)}).attr("class",function(t){return"groupBar "+f[t.xVal]}).attr("fill",function(t){return e.colors[t.xVal]}).attr("width",w.rangeBand()/1.2).attr("height",function(t){return A(t.yVal)>A(S)?A(t.yVal)-A(S):A(S)-A(t.yVal)}).on("mousemove",function(t){d3.select(this).attr("fill","yellow");var a=[{headingName:t.xVal,headingVal:t.yVal}];X.showToolTip(d3.event,"",e.xAxisfactor+" "+t.xFieldVal,!1,a,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);d3.select(this).attr("fill",function(t){return e.colors[t.xVal]}),X.hideTooTip()});W.transition().duration(function(t,e){return 600*e}).attr("x",function(t){return w(t.xVal)}).attr("y",function(t){return A(A(t.yVal)>A(S)?S:t.yVal)});var $=g.selectAll(".legend").data(u).enter().append("g").attr("class","legend").attr("transform",function(t,e){return"translate(0,"+(10+20*e)+")"}),Z=10,K=10,Q=0,te=Q+Z+K,ee={};$.append("rect").attr("x",Q).attr("width",10).attr("height",10).style("fill",function(t){return e.colors[t]}).attr("index",function(t,e){return e}).on("click",function(a){{var r=!1;parseInt(d3.select(this).attr("index"))}g.selectAll("rect."+f[a]).empty()?(r=!1,delete ee[a],d3.select(this).style("fill",function(t){return e.colors[t]}),g.select(".legend-text."+f[a]).style("text-decoration","none")):(r=!0,ee[a]=a,d3.select(this).style("fill","grey"),g.select(".legend-text."+f[a]).style("text-decoration","line-through")),t(h).find("rect.groupBar").remove(),t(h).find(".bar-grouping").remove(),n(a,ee)}),$.append("text").attr("x",te).attr("y",4).attr("dy",".35em").style("text-anchor","start").attr("class",function(t){return"legend-text  "+f[t]}).text(function(t){return t}),c(g),d(g)},cricketAnalysis:function(t){for(var e={left:.1*v,right:.1*v,bottom:.2*y,top:.2*y,chartSeparator:5,xScalePaddingTop:.1*y,yScalePaddingLeft:.08*v},a=v-e.left-e.right,n=y-e.top-e.bottom,r=n+e.chartSeparator,i=e.bottom/3,o=r+i+e.chartSeparator,l=(e.bottom-i,t.data.tital),s=t.data.titalColor,u=t.data.yData,c=t.data.xData,d=t.data.xDatacolor,f=t.data.specialXData,h=t.data.specialDataLabel,p=t.data.specialData,x=t.data.specialXDataColor,k=t.data.specialXDataLabel,w=t.data.xLabelColor,S=t.data.yLabel,C=t.data.specialDataLabelOfWicket,T=(t.colorArray,t.xFieldName,t.yFieldName,t.axisColor),L=t.data.textColor,N=t.data["font-style"],D=10,P=30,_=50,I=14,V=14,F=14,O=[],z=u.length>c.length?u:c,G=0;G<z.length;G++){var R={};u[G]&&(R.y=u[G]),c[G]&&(R.x=c[G]),f[G]&&(R.specialX=f[G]),R.timeIndex=G,O.push(R)}M=d3.scale.linear().range([0,a]);var E=(d3.min(O,function(t){return t.x}),d3.max(O,function(t){return t.x}));M.domain([0,E]),A=d3.scale.linear().range([n,5.5]);var Y=(d3.min(O,function(t){return t.y}),d3.max(O,function(t){return t.y}));Y=1.5*Y,A.domain([0,Y]),g=g.append("g").attr("transform","translate("+e.left+","+e.top+")"),b=d3.svg.axis().scale(M).orient("bottom").ticks(10),m=d3.svg.axis().scale(A).orient("left").tickValues(d3.range(3,Y,Y/4));var B=d3.select("body").append("div").style("background","rgba(0,0,0,.6)").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("color","white").style("padding","5px").text("a simple tooltip"),J=(g.append("g").attr("class","GridLineLImage"),g.append("g").attr("class","tital-Group-of-team").attr("transform","translate("+-e.yScalePaddingLeft+","+-e.top/1.5+")")),q=J.append("svg:defs").append("svg:linearGradient").attr("id","gradientTital").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(45)");q.append("stop").attr("offset","0").attr("stop-color","#0e0c1a"),q.append("stop").attr("offset","0.5").attr("stop-color","#414463"),q.append("stop").attr("offset","1").attr("stop-color","#0e0c1a"),J.append("rect").attr("width",a+e.yScalePaddingLeft+15).attr("height",e.top/1.7).attr("fill","url(#gradientTital)"),J.append("text").attr("x",30).attr("y",30).style("font-size","22").style("fill",s).style("font-family",N).text(l[0]+" v "+l[1]);{var X=g.append("g").attr("class","over-axis-grouping");X.append("rect").attr("class","over-axis-heading").attr("x",-e.yScalePaddingLeft).attr("y",r).attr("height",i).attr("width",e.yScalePaddingLeft).attr("fill","#131e4c")}X.append("text").attr("x",-e.yScalePaddingLeft/2).attr("y",r+i/2).attr("dy",".35em").attr("text-anchor","middle").text("OVERS").attr("fill",w).style("font-weight",400).style("font-family","Arial Black");var U=X.append("g").attr("class","over-scale-group").attr("transform","translate(0,"+r+")"),H=U.append("svg:defs").append("svg:linearGradient").attr("id","gradientOverAxis").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(90)");H.append("stop").attr("offset","0").attr("stop-color","#182051"),H.append("stop").attr("offset","0.5").attr("stop-color","#8289b5"),H.append("stop").attr("offset",".8").attr("stop-color","#182051"),U.append("rect").attr("x",0).attr("y",0).attr("width",a+15).attr("height",i).attr("fill","url(#gradientOverAxis)");var j=U.call(b);d3.select(".over-scale-group").attr("fill","none"),j.selectAll("text").attr("dy",".35em").text(function(t){return 0==parseInt(t)?"":t}).attr("transform","translate(0,"+i/6+")").style("fill","white").style("font-family",N);{var W=g.append("g").attr("class","wicket-axis");W.append("rect").attr("class","wicket-axis-heading").attr("x",-e.yScalePaddingLeft).attr("y",o).attr("height",3*i).attr("width",e.yScalePaddingLeft).attr("fill","#9c9ca6")}W.append("image").attr("x",-e.yScalePaddingLeft/1.5).attr("y",o).attr("width",P).attr("height",_).attr("xlink:href",C);var $=W.append("g").attr("class","wicket-scale-group").attr("transform","translate(0,"+o+")");$.append("rect").attr("class","show-wicket-in-over").attr("x",0).attr("y",0).attr("width",a+15).attr("height",2*i).attr("fill","#9c9ca6");var Z=[],K=[];for(key in p)for(nestedKey in p[key])for(batsman in p[key][nestedKey])K.push(batsman),Z.push(key);$.selectAll("img").data(K).enter().append("image").attr("value",function(t){return t}).attr("x",function(t,e){return M(Z[e])-5}).attr("y",function(t,e){for(var a=0,n=e;n>=0;n--)Z[n]==Z[e]&&a++;return 1.1*a*D-D}).attr("width",D).attr("height",D).attr("fill","red").attr("xlink:href",h).on("mouseover",function(){t:for(key in p)for(nestedKey in p[key])for(batsman in p[key][nestedKey])if(batsman==d3.select(this).attr("value"))break t;B.style("visibility","visible").style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px").text(d3.select(this).attr("value")+" "+p[key][nestedKey][batsman])}).on("mouseout",function(){B.style("visibility","hidden")});var Q=g.append("g").attr("class","y axis").attr("transform","translate("+-e.yScalePaddingLeft+",0)").attr("stroke",T).attr("fill","none");m.tickSize(0,50);var te=Q.append("svg:defs").append("svg:linearGradient").attr("id","gradientYAxis").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(45)");te.append("stop").attr("offset","0").attr("stop-color","#9c9ca6"),te.append("stop").attr("offset","0.5").attr("stop-color","#ffffff"),te.append("stop").attr("offset","1").attr("stop-color","#9c9ca6"),Q.append("rect").attr("class","run-axis").attr("x",0).attr("y",0).style("stroke","none").attr("height",n).attr("width",e.yScalePaddingLeft).attr("fill","url(#gradientYAxis)");var ee=Q.call(m);ee.selectAll("text").attr("transform","translate("+e.yScalePaddingLeft+",0)").style("fill",L);var ae=g.append("g").attr("class","yaxislabel").attr("transform","translate("+2*-e.yScalePaddingLeft+","+2*e.bottom+")");ae.append("text").attr("x",0).attr("y",n/2.25).text(S).style("font-size","20").attr("transform","rotate(-90)").style("fill",L).style("font-family",N);var ne=a/(O.length-1)*.5,re=g.append("g").attr("class","simple-line").attr("transform","translate(0,0)");re.append("line").attr("y1",function(){return 0}).attr("y2",function(){return n}).attr("x1",function(){return 0}).attr("x2",function(){return 0}).style("stroke","gray");var ie=g.append("g").attr("class","bar-rectangle").attr("transform","translate(0,0)"),oe=ie.append("svg:defs").append("svg:linearGradient").attr("id","gradientBar").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(45)");oe.append("stop").attr("offset","0").attr("stop-color","#9c9ca6"),oe.append("stop").attr("offset","0.5").attr("stop-color","#ffffff"),oe.append("stop").attr("offset","1").attr("stop-color","#0e0c1a"),ie.append("rect").attr("class","run-bar").attr("x",0).attr("y",0).style("stroke","none").attr("height",n).attr("width",a+15).attr("fill","url(#gradientBar)");var le={init:function(t,e,a,n,r,i){var o=Math.ceil(.2*e),l=Math.ceil(e/o);t.selectAll(".hline").data(d3.range(l)).enter().append("line").attr("y1",function(t){return t*o+6}).attr("y2",function(t){return t*o+6}).attr("x1",function(){return 0}).attr("x2",function(){return a}).style("stroke",i).style("opacity",.5).attr("transform","translate("+n+","+r+")")}};le.init(g,n,a,e.xScalePaddingLeft,e.xScalePaddingTop,"#353b37");var se=g.append("g").attr("class","legend-grouping").attr("transform","translate("+e.yScalePaddingLeft/4+",3)");se.append("rect").attr("width",I).attr("height",V).attr("fill",x),se.append("text").attr("x",V+3).attr("y",V/2).style("font-size !important",F).style("fill",L).style("font-family",N).text(k);{var ue=g.append("g").attr("class","bar-grouping").attr("transform","translate(0,0)"),ce=ue.selectAll(".runs-bar").data(O).enter().append("rect").attr("class","runs-bar").attr("x",function(t){return M(t.x)-ne/2}).attr("y",function(t){return A(t.y)+ne/2-5.5}).attr("width",ne).attr("height",function(){return 0}).attr("fill",function(t){return-1==f.indexOf(t.x)?d:x}).style("z-index",51);ue.selectAll("circle").data(O).enter().append("circle").attr("class","runs-bar").attr("cx",function(t){return M(t.x)}).attr("cy",function(t){return A(t.y)+ne/2-5.5}).attr("r",ne/2).attr("fill",function(t){return-1==f.indexOf(t.x)?d:x}).style("z-index",1)}ce.transition().duration(1e3).attr("height",function(t){return A(0)-A(t.y)}),g.selectAll("text").style("font-weight",500)},bulletBar:function(t){for(var e=t.title,a=t.xAxisLabel,n=t.yAxisLabel,r=t.yAxisData,i=t.xAxisData1,o=t.xAxisData2,l=t.colorOfData1,s=t.colorOfData2,u=t.xAxisLabelData1,f=t.xAxisLabelData2,h=Y.leftMarginController(r),p={left:h,right:h,bottom:45,top:.1*y,chartSeparator:10,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},m=v-p.left-p.right,b=y-p.top-p.bottom,A=b/i.length*.5,M=[],k=0;k<r.length;k++)M[k]=k;U.init(g,b,m,p.left,p.top,x.gridLineColor);var w=g.append("g").attr("class","main-group").attr("transform","translate("+p.left+","+p.top+")"),S=d3.min(d3.min(i)<d3.min(o)?i:o),C=d3.max(d3.max(i)>d3.max(o)?i:o);C=0==C?maxData1+2:C>0?1.2*C:.8*C,0==S?S-=2:S=0>S?1.5*S:.1*S;var T=d3.scale.linear().domain([C,S]).range([0,.5*m]),L=d3.svg.axis().scale(T).orient("bottom").ticks(5),N=w.append("g").attr("id","xAxis").attr("class","xAxis").attr("fill","none").attr("transform","translate(0,"+b+")").call(L);N.selectAll("text").style("font-size",13).attr("fill","black");var D=d3.scale.linear().domain([S,C]).range([.5*m,m]),P=d3.svg.axis().scale(D).orient("bottom").ticks(5),_=w.append("g").attr("id","xAxis").attr("class","xAxis").attr("fill","none").attr("transform","translate(0,"+b+")").call(P);_.selectAll("text").style("font-size",13).attr("fill","black");var I=d3.scale.linear().domain([0,r.length-1]).range([b-.5*A,.5*A]),V=d3.svg.axis().scale(I).orient("left").tickValues(M);w.append("g").attr("id","yAxis").attr("class","yAxis").attr("fill","none").attr("transform","translate(0,0)").call(V).selectAll("text").text(function(t){return r[t]});var F=d3.scale.linear().domain([0,r.length-1]).range([b-.5*A,.5*A]),O=d3.svg.axis().scale(F).orient("left").tickValues(M);w.append("g").attr("id","yAxis").attr("class","yAxis").attr("fill","none").attr("transform","translate("+(m+.5*p.right)+",0)").call(O).selectAll("text").text(function(t){return r[t]});var z=w.selectAll(".rect").data(i).enter().append("rect").attr("x",function(){return T(S)}).attr("y",function(t,e){return I(e)-A/2}).attr("height",A).attr("width",function(){return 0}).attr("index",function(t,e){return e}).attr("fill",l).on("mousemove",function(){var t=parseInt(d3.select(this).attr("index")),e=r[t];e=n+" "+e;var o=i[t],l=[{headingName:u+" "+a,headingVal:o}];X.showToolTip(d3.event,"",e,!1,l,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()});z.transition().duration(1500).attr("x",function(t){return T(t)}).attr("width",function(t){return T(S)-T(t)-2});var G=w.selectAll(".rect").data(o).enter().append("rect").attr("x",function(){return D(S)+2}).attr("y",function(t,e){return I(e)-A/2}).attr("height",A).attr("width",function(){return 0}).attr("index",function(t,e){return e}).attr("fill",s).on("mousemove",function(){var t=parseInt(d3.select(this).attr("index")),e=r[t];e=n+" "+e;var i=o[t],l=[{headingName:f+" "+a,headingVal:i}];X.showToolTip(d3.event,"",e,!1,l,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()});G.transition().duration(1500).attr("width",function(t){return D(t)-T(S)-2});var E=6,B=n.length*E,J=b/2+B/2,q=-p.left+15,H=m+.7*p.left;R.appendLabel(n,q,J,-90,w,x.yLabelColor,600),R.appendLabel(n,H,J,-90,w,x.yLabelColor,600);var j=u.length*E,W=m/4-j/2,$=f.length*E,Z=.75*m-$/2,K=b+(p.bottom-5);R.appendLabel(u,W,K,0,w,x.xLabelColor,600),R.appendLabel(f,Z,K,0,w,x.xLabelColor,600);var E=8,Q=v/2-e.length*E/2,te=g.append("g").attr("class","title");R.appendLabel(e,Q,.35*p.top,0,te,x.chartTitleColor,800),c(g),d(g)},setYSclae:function(t,e){var a,n,r=d3.extent(data,function(e){return e[t]}),i=d3.extent(data,function(t){return t[e]}),o=r[0],l=r[1],s=i[0],u=i[1];a=o>s?s:o,n=l>u?l:u,S=a,C=n,A.domain([S,C])},barWithLogo:function(e){v=t(h).width(),y=.7*t(h).height(),P=t(h).attr("id"),t("#"+P).empty();var a=P+"_svg";g=d3.select("#"+P).append("svg").attr("width","100%").attr("height",y).attr("class",a).attr("viewBox","0 0 "+Math.max(v,y)+" "+Math.min(v,y)).attr("preserveAspectRatio","xMinYMin");for(var n=e.data.title,r=(e.data.titalColor,e.data.yData),i=e.data.xData,o=e.data.imagePathArray,l=e.data.xData,s=e.data.color,u=e.data.xIndicationLabel,f=e.data.yIndicationLabel,k=Y.leftMarginController(r),w={left:k,right:.05*v,bottom:.05*y,top:.07*y,chartSeparator:5},T=v-w.left-w.right,L=y-w.top-w.bottom,N=T/r.length*.5,D=[],_=r.length>i.length?r:i,I=[],V=0;V<_.length;V++){var F={timeIndex:V,x:i[V],y:r[V],imagePath:o[V],name:l[V]};D.push(F),I.push(V)}M=d3.scale.linear().range([.5*N,T-.5*N]);var O=(D[0].timeIndex,D[D.length-1].timeIndex);M.domain([0,O]),A=d3.scale.linear().range([L,0]),S=E.getMin(r),C=E.getMax(r),A.domain([0,C]);var z=8,G=v/2-n.length*z/2,J=g.append("g").attr("class","title");R.appendLabel(n,G,.06*y,0,J,x.chartTitleColor,800),g=g.append("g").attr("transform","translate("+w.left+","+w.top+")");var z=7,q=f.toString().length*z,U=L/2+q/2,H=-w.left+15;R.appendLabel(f,H,U,-90,g,x.yLabelColor,600),b=d3.svg.axis().scale(M).orient("bottom").ticks(10),m=d3.svg.axis().scale(A).orient("left").tickValues(B.getTickArray(S,C,6));var j=(g.append("g").attr("class","x axis").attr("transform","translate(0,"+L+")"),g.append("g").attr("class","y axis").attr("transform","translate(0,0)"));b.tickValues(I),j.call(m);var W=g.append("g").attr("class","bar-grouping"),$=W.selectAll(".bar").data(D).enter().append("rect").attr("width",N).attr("height",function(){return 0}).attr("x",function(t,e){return M(e)-.5*N}).attr("y",function(t){return A(t.y)}).attr("fill",function(){return s}).on("mousemove",function(t){var e=[{headingName:f,headingVal:t.y}];X.showToolTip(d3.event,"",u+" "+t.x,!1,e,.95*d3.event.pageY),d3.select(this).style("fill","yellow")}).on("mouseleave",function(){X.hideTooTip(),d3.select(this).style("fill",s)});$.transition().duration(1e3).attr("height",function(t){return A(0)-A(t.y)});{var Z=d3.select("#"+p).append("div").style("position","absolute").style("margin-left",w.left+"px").style("width",T).style("height",.4*y),K=Z.selectAll(".xScalebar").data(D).enter().append("div").style("width",N).style("height",.2*y).style("left",function(){return 0}).style("position","absolute").style("display","inline-block");K.append("img").style("width",N+"px").style("height",.2*y+"px").attr("src",function(t){return t.imagePath}).on("mousemove",function(t){var e=[{headingName:f,headingVal:t.y}];X.showToolTip(d3.event,"",u+" "+t.x,!1,e,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()})}K.transition().duration(1e3).style("left",function(t,e){return M(e)-.5*N+"px"}),K.append("div").style("width",N).style("height",.1*y).style("margin-top",.05*y).style("color","#a7a7a7").html(function(t){return t.name}).style("word-wrap","break-word"),c(g),d(g)}},Z={squareChart:function(e){var a,e=t.extend({color:"red",axisColor:"blue",data:[],xFieldName:"",yFieldName:"",widthOfSquare:20},e);a=0==e.data.length?T:e.data;var n,r;n=""==e.xFieldName?N:e.xFieldName,r=""==e.yFieldName?D:e.yFieldName;var i=(Math.floor((v-_.scale)/a.length),t(h).attr("id")),o=i+"_square_"+r,l=e.widthOfSquare,s=35;g.selectAll("."+o).data(a).enter().append("rect").attr("class",o).attr("x",function(t){return M(I.parse(t[n]))-l*s/100+7}).attr("y",function(t){return A(t[r])-3*(l*s/100)}).attr("width",l).attr("height",function(){return l}).attr("fill",e.color).on("mouseover",function(t){t[r];d3.select(this).attr("width",l+5).attr("height",l+5),attachToolTip.showToolTip(d3.event)}).on("mouseleave",function(t){t[r];d3.select(this).attr("width",l).attr("height",l),attachToolTip.hideTooTip()}),0==t(h).find(".axis").length&&(g.append("g").attr("class","x axis").attr("transform","translate(0,"+(y-_.scale+10)+")").attr("stroke",e.axisColor).attr("fill","none").call(b),g.append("g").attr("class","y axis").attr("transform","translate("+(v-_.scale+10)+",3)").attr("stroke",e.axisColor).attr("fill","none").call(m))}},K={circleChart:function(e){var a,e=t.extend({color:"red",axisColor:"blue",r:10,data:[]},e);a=0==e.data.length?T:e.data;var n=(Math.floor((v-_.scale)/a.length),t(h).attr("id")),r=n+"_circle";g.selectAll("."+r).data(a).enter().append("circle").attr("class",r).attr("cx",function(t,a){return M(a)+e.r/2}).attr("cy",function(t){return A(t[D])}).attr("r",e.r).attr("fill",e.color).on("mouseover",function(t){console.log(JSON.stringify(t));var a=[{headingName:L.yAxisIndicationLabel,headingVal:t[D]}];X.showToolTip(d3.event,"",t[N],!1,a,.95*d3.event.pageY);t[D];d3.select(this).attr("r",e.r+5),d3.select(this).attr("stroke","cyan"),d3.select(this).attr("stroke-width","2").style("opacity","0.5")}).on("mouseleave",function(t){t[D];d3.select(this).attr("r",e.r),X.hideTooTip(),d3.select(this).attr("stroke","none"),d3.select(this).attr("stroke-width","0").style("opacity","1")}),0==t(h).find(".axis").length&&(g.append("g").attr("class","x axis").attr("transform","translate(0,"+(y-_.scale+7)+")").attr("stroke",e.axisColor).attr("fill","none").call(b).selectAll("text").text(function(t){return a[t][N]}),g.append("g").attr("class","y axis").attr("transform","translate("+(v-_.scale+5)+",3)").attr("stroke",e.axisColor).attr("fill","none").call(m))}};r();var Q={pieChart:function(e){var a,e=t.extend({data:[]},e);a=0==e.data.length?T:e.data;var n=v/2,r=0,i=d3.svg.arc().innerRadius(r).outerRadius(n),o=d3.svg.arc().outerRadius(n+10),l=d3.layout.pie(),s=d3.scale.category20(),u=g.append("svg").attr("width",v).attr("height",y),c=u.selectAll("g.arc").data(l(a)).enter().append("g").attr("class","slice").attr("stroke","white").attr("stroke-width",3).attr("transform","translate("+n+","+n+")").on("mouseover",function(t){d3.select("#piechartTooltip").style("left",d3.event.pageX+"px").style("top",d3.event.pageY+"px").style("opacity",10).select("#value").text(t.value),d3.select(this).attr("stroke","white").transition().duration(100).attr("d",o).attr("stroke-width",10)}).on("mouseout",function(){d3.select("#piechartTooltip").style("opacity",0),d3.select(this).transition().attr("d",i).attr("stroke","white").attr("stroke-width",3)});c.append("path").attr("fill",function(t,e){return s(e)}).attr("d",i)}},te={drawPyramidChart:function(t,e,a,n){var r=-20,i=200;v-=_.scale,y-=_.scale,scaleX=d3.scale.linear().domain([r,i]).range([0,v]),scaleY=d3.scale.linear().domain([0,80]).range([y,0]),color=d3.scale.category10();var l,s=u(o(t)).arrayOfPolygons;l=a?g.append("g").attr("transform","translate("+(v-v/6)+","+(y+y/4)+") rotate(180)"):g.append("g").attr("transform","translate("+v/6+",0)"),l.selectAll("polygon").data(s).enter().append("polygon").attr("points",function(t){return t.points.map(function(t){return[scaleX(t.x),scaleY(t.y)].join(",")}).join(" ")}).attr("fill",function(t,a){return e[a].color}).attr("stroke-width",0).data(s).on("mousemove",function(t,a){var r=[{headingName:n,headingVal:e[a].amount}];X.showToolTip(d3.event,"",e[a].accountName,!1,r,.95*d3.event.pageY)}).on("mouseout",function(){X.hideTooTip()});var c=g.append("g").attr("class","legend").attr("transform",function(){return"translate("+.01*v+",10)"}),d=20,f=10,h=0,p=h+d+f;c.selectAll(".rect").data(e).enter().append("g").append("rect").attr("class","pyramidLegend").attr("width",d).attr("height",d).attr("y",function(t,e){return 1.5*e*d}).attr("fill",function(t,a){return e[a].color}),c.selectAll(".text").data(e).enter().append("text").attr("x",p).attr("y",function(t,e){return 1.5*e*d+d/2}).attr("dy",".35em").attr("class",function(t){return"legend-text  "+t}).attr("fill","white").text(function(t,a){return e[a].accountName})},draw3DPyramidSliceChart:function(t){function e(){return.6*outFactor*2}function a(){var t=180*Math.atan(outFactor/(.6*outFactor))/Math.PI;return t}function n(t){for(var e=0,a=0;a<t.length;a++)e+=t[a];return e}function r(t){for(var e=outFactor,a=[],n=0;n<t.length;n++)a.push(e*t[n]/100),M.push(t[n]);return M.sort(function(t,e){return parseInt(t)<parseInt(e)}),a.sort(function(t,e){return parseInt(t)<parseInt(e)}),a}function i(){return.6*outFactor}function o(t,e,a,r){for(var i=n(e)/Math.sin(t*(Math.PI/180)),o=[],l=0;l<e.length;l++)o.push(i*e[l]/i-r*e[l]/i);return o}function l(t,e){var a=t*Math.cos(e*(Math.PI/180));return a}function s(t,e,a){var r=n(e),i=n(a),o=Math.sin(r/(i-t)),l=180*o/Math.PI;return l}function u(t,e){console.log("  Angle : "+t+" bottomWidth : "+e);var a=t*(Math.PI/180),n=Math.tan(a)*e;return n}function c(t,e,a,n,r,o,c,d,f,h,g,v,y,A,M){var k=t,w=e,S=[];if(1!=A){if(1==r)for(var C=0;5>C;C++){0==C?e-=a:1==C?e+=a:2==C?0==v?(t-=i(),e-=o):(t=p,e=x-y):3==C?(t+=l(d,s(o,h,c)+T,g,a),e-=d,p=t,x=e):4==C&&(t=k,e=w-a);var L=e,N=t;S.push(JSON.parse('{"x":'+N+',"y":'+L+',"value":'+M+"}"))}else if(2==r)for(var C=0;5>C;C++){0==C?e-=a:1==C?e+=a:2==C?0==v?(t+=i(),e-=o):(t=m,e=b-y):3==C?(t-=l(d,s(o,h,c)+T,g,a),e-=d,D.push(t),P.push(e),m=t,b=e):4==C&&(t=k,e=w-a);var L=e,N=t;S.push(JSON.parse('{"x":'+N+',"y":'+L+',"value":'+M+"}"))}else if(3==r&&1!=A)for(var _,I,C=0;5>C;C++){0==C?(_=t,e-=a,I=e):1==C?(t=p,e=x):2==C?(t+=k-p,e-=I-x):3==C?(t=m,e=b):4==C&&(t=k,e=w-a);var L=e,N=t;S.push(JSON.parse('{"x":'+N+',"y":'+L+',"value":'+M+"}"))}}else{var V=t-p,F=u(f,V);if(1==r)for(var C=0;5>C;C++){0==C?(e-=F,k=t,w=e):1==C?e+=F:2==C?0==v?(t-=i(),e-=o):(t=p,e=x-y):3==C&&(t=k,e=w);var L=e,N=t;S.push(JSON.parse('{"x":'+N+',"y":'+L+',"value":'+M+"}"))}else if(2==r)for(var C=0;4>C;C++){0==C?(e-=F,k=t,w=e):1==C?e+=F:2==C?(t=m,e=b-y):3==C&&(t=k,e=w,D.push(t),P.push(e),b=e);var L=e,N=t;S.push(JSON.parse('{"x":'+N+',"y":'+L+',"value":'+M+"}"))}else if(3==r&&1!=A)for(var _,I,C=0;5>C;C++){0==C?(_=t,e-=a,I=e):1==C?(t=p,e=x):2==C?(t+=k-p,e-=I-x):3==C?(t=m,e=b):4==C&&(t=k,e=w-a);var L=e,N=t;S.push(JSON.parse('{"x":'+N+',"y":'+L+',"value":'+M+"}"))}}return S}function d(t,e,a,n){for(var r=[],i=0;3>i;i++){0==i?(t=t,e+=a/2):1==i?t+=.3*outFactor/2:2==i&&(t+=.025*outFactor,e+=.025*outFactor);var o=e,l=t;r.push(JSON.parse('{"x":'+l+',"y":'+o+',"value":'+n+"}"))}return r}var f=O.getValueToPercentageArray(t.data),h=y>v?v:y;outFactor=.6*h;var p,x,m,b,A=10,M=[],k=r(f),w=a(),S=30,C=o(w,k,0,S),T=0,L=t.colorArray,N=[{x:0,y:400},{x:0,y:400},{x:0,y:400},{x:0,y:400},{x:0,y:400}],D=[],P=[],_=0,I=0;v>y?(_=(v-outFactor)/2,I=0):(_=0,I=(y-outFactor)/2.1);for(var V=({x:(h-e())/2,y:(h-e())/2},d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear")),F=g.append("g").attr("transform","translate("+.13*v+","+.02*-y+")"),z=.3*h+.1*h,G=h,R=(k[0],d3.scale.category20c(),G),E=0,Y=A,B=0,J=0;J<k.length;J++){J==k.length-1&&(B=1);{F.append("path").attr("d",V(N)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(2e3).ease("linear").attr("d",V(c(z,R,k[J],f,1,S,C,C[J],w,k,E,J,Y,B,M[J]))).style("opacity",.7).attr("stroke","white").attr("stroke-width",1).attr("fill",function(){return L[J]}),F.append("path").attr("d",V(N)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(1500).ease("linear").attr("d",V(c(z,R,k[J],f,2,S,C,C[J],w,k,E,J,Y,B,M[J]))).attr("stroke","white").style("opacity",.5).attr("stroke-width",.5).attr("fill",function(){return L[J]}),F.append("path").attr("d",V(N)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(1e3).ease("linear").attr("d",V(c(z,R,k[J],f,3,S,C,C[J],w,k,E,J,Y,B,M[J]))).style("opacity",.3).attr("stroke","white").attr("stroke-width",.3).attr("fill",function(){return L[J]})}R=G-k[J]-A,G=R,E=k[J]}for(var q=outFactor<200?"10px":"12px",X=0;X<D.length;X++)F.append("path").attr("x",outFactor).attr("y",outFactor).transition().delay(function(){return 600*X}).ease("bounce").attr("d",V(d(D[X],P[X],k[X],M[X]))).attr("stroke",function(){return L[X]}).attr("stroke-width",1).attr("fill","none"),F.append("text").attr("x",outFactor).attr("y",outFactor).transition().delay(function(){return 600*X}).ease("bounce").attr("x",D[X]+.15*outFactor).attr("y",P[X]+.1*outFactor+k[X]/2).text(t.labels[X]+":"+t.data[X]+" "+t.unit).attr("font-family","sans-serif").attr("font-size",q).attr("fill",L[X])},draw3DPyramidChartWithoutSlice:function(t){function e(){return.6*outFactor*2}function a(){var t=180*Math.atan(outFactor/(.6*outFactor))/Math.PI;return t}function n(t){for(var e=0,a=0;a<t.length;a++)e+=t[a];return e}function r(t){for(var e=outFactor,a=[],n=0;n<t.length;n++)a.push(e*t[n]/100),M.push(t[n]);return M.sort(function(t,e){return parseInt(t)<parseInt(e)}),a.sort(function(t,e){return parseInt(t)<parseInt(e)}),a}function i(){return.6*outFactor}function o(t,e,a,r){for(var i=n(e)/Math.sin(t*(Math.PI/180)),o=[],l=0;l<e.length;l++)o.push(i*e[l]/i-r*e[l]/i);return o}function l(t,e){var a=t*Math.cos(e*(Math.PI/180));return a}function s(t,e,a){var r=n(e),i=n(a),o=Math.sin(r/(i-t)),l=180*o/Math.PI;return l}function u(t,e){console.log("  Angle : "+t+" bottomWidth : "+e);var a=t*(Math.PI/180),n=Math.tan(a)*e;return n}function c(t,e,a,n,r,o,c,d,f,h,g,v,y,A,M){var k=t,w=e,S=[];if(1!=A){if(1==r)for(var C=0;5>C;C++){0==C?e-=a:1==C?e+=a:2==C?0==v?(t-=i(),e-=o):(t=p,e=x-y):3==C?(t+=l(d,s(o,h,c)+T,g,a),e-=d,p=t,x=e):4==C&&(t=k,e=w-a);var L=e,N=t;S.push(JSON.parse('{"x":'+N+',"y":'+L+',"value":'+M+"}"))}else if(2==r)for(var C=0;5>C;C++){0==C?e-=a:1==C?e+=a:2==C?0==v?(t+=i(),e-=o):(t=m,e=b-y):3==C?(t-=l(d,s(o,h,c)+T,g,a),e-=d,D.push(t),P.push(e),m=t,b=e):4==C&&(t=k,e=w-a);var L=e,N=t;S.push(JSON.parse('{"x":'+N+',"y":'+L+',"value":'+M+"}"))}else if(3==r&&1!=A)for(var _,I,C=0;5>C;C++){0==C?(_=t,e-=a,I=e):1==C?(t=p,e=x):2==C?(t+=k-p,e-=I-x):3==C?(t=m,e=b):4==C&&(t=k,e=w-a);var L=e,N=t;S.push(JSON.parse('{"x":'+N+',"y":'+L+',"value":'+M+"}"))}}else{var V=t-p,F=u(f,V);if(1==r)for(var C=0;5>C;C++){0==C?(e-=F,k=t,w=e):1==C?e+=F:2==C?0==v?(t-=i(),e-=o):(t=p,e=x-y):3==C&&(t=k,e=w);var L=e,N=t;S.push(JSON.parse('{"x":'+N+',"y":'+L+',"value":'+M+"}"))}else if(2==r)for(var C=0;4>C;C++){0==C?(e-=F,k=t,w=e):1==C?e+=F:2==C?(t=m,e=b-y):3==C&&(t=k,e=w,D.push(t),P.push(e),b=e);var L=e,N=t;S.push(JSON.parse('{"x":'+N+',"y":'+L+',"value":'+M+"}"))}else if(3==r&&1!=A)for(var _,I,C=0;5>C;C++){0==C?(_=t,e-=a,I=e):1==C?(t=p,e=x):2==C?(t+=k-p,e-=I-x):3==C?(t=m,e=b):4==C&&(t=k,e=w-a);var L=e,N=t;S.push(JSON.parse('{"x":'+N+',"y":'+L+',"value":'+M+"}"))}}return S}function d(t,e,a,n){for(var r=[],i=0;3>i;i++){0==i?(t=t,e+=a/2):1==i?t+=.3*outFactor/2:2==i&&(t+=.025*outFactor,e+=.025*outFactor);var o=e,l=t;r.push(JSON.parse('{"x":'+l+',"y":'+o+',"value":'+n+"}"))}return r}var f=O.getValueToPercentageArray(t.data),h=y>v?v:y;outFactor=.6*h;var p,x,m,b,A=0,M=[],k=r(f),w=a(),S=30,C=o(w,k,0,S),T=0,L=t.colorArray,N=[{x:0,y:400},{x:0,y:400},{x:0,y:400},{x:0,y:400},{x:0,y:400}],D=[],P=[],_=0,I=0;v>y?(_=(v-outFactor)/2,I=0):(_=0,I=(y-outFactor)/2.1);for(var V=({x:(h-e())/2,y:(h-e())/2},d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear")),F=g.append("g").attr("transform","translate("+.1*v+","+.05*-y+")"),z=.3*h+.1*h,G=h,R=(k[0],d3.scale.category20c(),G),E=0,Y=A,B=0,J=0;J<k.length;J++){J==k.length-1&&(B=1);{F.append("path").attr("d",V(N)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(2e3).ease("linear").attr("d",V(c(z,R,k[J],f,1,S,C,C[J],w,k,E,J,Y,B,M[J]))).style("opacity",.7).attr("stroke","white").attr("stroke-width",1).attr("fill",function(){return L[J]}),F.append("path").attr("d",V(N)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(1500).ease("linear").attr("d",V(c(z,R,k[J],f,2,S,C,C[J],w,k,E,J,Y,B,M[J]))).attr("stroke","white").style("opacity",.5).attr("stroke-width",.5).attr("fill",function(){return L[J]}),F.append("path").attr("d",V(N)).style("opacity",0).attr("fill",function(){return"white"}).transition().duration(1e3).ease("linear").attr("d",V(c(z,R,k[J],f,3,S,C,C[J],w,k,E,J,Y,B,M[J]))).style("opacity",.3).attr("stroke","white").attr("stroke-width",.3).attr("fill",function(){return L[J]})}R=G-k[J]-A,G=R,E=k[J]}for(var q=outFactor<200?"10px":"12px",X=0;X<D.length;X++)F.append("path").attr("x",outFactor).attr("y",outFactor).transition().delay(function(){return 600*X}).ease("bounce").attr("d",V(d(D[X],P[X],k[X],M[X]))).attr("stroke",function(){return L[X]}).attr("stroke-width",1).attr("fill","none"),F.append("text").attr("x",outFactor).attr("y",outFactor).transition().delay(function(){return 600*X}).ease("bounce").attr("x",D[X]+.15*outFactor+3*X).attr("y",P[X]+.1*outFactor+k[X]/2-3*X).text(t.labels[X]+":"+t.data[X]+" "+t.unit).attr("font-family","sans-serif").attr("font-size",q).attr("fill",L[X])}},ee={drawRadarChart:function(t,e,a){var n=v>y?y:v,r=.1*v,i=.1*y,o=0;v>y?(r=Math.round(v-y)/3,o=r):(i=Math.round(y-v)/3,o=i);var l={radius:10,w:n-o,h:n-o,factor:1,factorLegend:.85,levels:3,maxValue:0,radians:2*Math.PI,opacityArea:0,ToRight:5,TranslateX:r,TranslateY:i,ExtraWidthX:100,ExtraWidthY:100,color:d3.scale.category20()};if("undefined"!=typeof a)for(var s in a)"undefined"!=typeof a[s]&&(l[s]=a[s]);l.maxValue=Math.max(l.maxValue,d3.max(e,function(t){return d3.max(t.map(function(t){return t.value
}))}));for(var u,c=e[0].map(function(t){return t.axis}),f=c.length,h=l.factor*Math.min(l.w/2,l.h/2),p=d3.format(""),m=g.append("svg:g").attr("width",l.w+l.ExtraWidthX).attr("height",l.h+l.ExtraWidthY).append("g").attr("transform","translate("+.3*v+","+l.TranslateY+")"),b=0;b<l.levels;b++){var A=l.factor*h*((b+1)/l.levels);m.selectAll(".levels").data(c).enter().append("svg:line").attr("x1",function(t,e){return A*(1-l.factor*Math.sin(e*l.radians/f))}).attr("y1",function(t,e){return A*(1-l.factor*Math.cos(e*l.radians/f))}).attr("x2",function(t,e){return A*(1-l.factor*Math.sin((e+1)*l.radians/f))}).attr("y2",function(t,e){return A*(1-l.factor*Math.cos((e+1)*l.radians/f))}).attr("class","line").style("stroke","grey").style("stroke-opacity","3.75").style("stroke-width","0.5px").attr("transform","translate("+(l.w/2-A)+", "+(l.h/2-A)+")")}for(var b=0;b<l.levels;b++){var A=l.factor*h*((b+1)/l.levels);m.selectAll(".levels").data([0]).enter().append("svg:text").attr("x",function(){return A*(1-l.factor*Math.sin(0))}).attr("y",function(){return A*(1-l.factor*Math.cos(0))}).attr("class","legend").style("font-family","sans-serif").style("font-size","12px").attr("transform","translate("+(l.w/2-A+l.ToRight)+", "+(l.h/2-A)+")").style("fill",x["font-color"]).text(p((b+1)*l.maxValue/l.levels))}series=0;var M=m.selectAll(".axis").data(c).enter().append("g").attr("class","axis");M.append("line").attr("x1",l.w/2).attr("y1",l.h/2).attr("x2",function(t,e){return l.w/2*(1-l.factor*Math.sin(e*l.radians/f))}).attr("y2",function(t,e){return l.h/2*(1-l.factor*Math.cos(e*l.radians/f))}).attr("class","line").style("stroke","grey").style("stroke-width","1px"),M.append("text").attr("class","legend").text(function(t){return t}).style("font-family","sans-serif").style("font-size","11px").attr("text-anchor","middle").attr("dy","1.5em").attr("transform",function(){return"translate(0, -10)"}).style("fill",x["font-color"]).attr("x",function(t,e){return l.w/2*(1-l.factorLegend*Math.sin(e*l.radians/f))-60*Math.sin(e*l.radians/f)}).attr("y",function(t,e){return l.h/2*(1-Math.cos(e*l.radians/f))-20*Math.cos(e*l.radians/f)}),e.forEach(function(t){dataValues=[],m.selectAll(".nodes").data(t,function(t,e){dataValues.push([l.w/2*(1-parseFloat(Math.max(t.value,0))/l.maxValue*l.factor*Math.sin(e*l.radians/f)),l.h/2*(1-parseFloat(Math.max(t.value,0))/l.maxValue*l.factor*Math.cos(e*l.radians/f))])}),dataValues.push(dataValues[0]),m.selectAll(".area").data([dataValues]).enter().append("polygon").attr("class","radar-chart-serie"+series).style("stroke-width","2px").style("stroke",l.color(series)).attr("points",function(t){for(var e="",a=0;a<t.length;a++)e=e+t[a][0]+","+t[a][1]+" ";return e}).style("fill",function(){return l.color(series)}).style("fill-opacity",l.opacityArea).on("mouseover",function(){z="polygon."+d3.select(this).attr("class"),m.selectAll("polygon").transition(200).style("fill-opacity",.1),m.selectAll(z).transition(200).style("fill-opacity",.9)}).on("mouseout",function(){m.selectAll("polygon").transition(200).style("fill-opacity",l.opacityArea)}),series++}),series=0,e.forEach(function(t){m.selectAll(".nodes").data(t).enter().append("svg:circle").attr("class","radar-chart-serie"+series).attr("r",l.radius).attr("alt",function(t){return Math.max(t.value,0)}).attr("cx",function(t,e){return dataValues.push([l.w/2*(1-parseFloat(Math.max(t.value,0))/l.maxValue*l.factor*Math.sin(e*l.radians/f)),l.h/2*(1-parseFloat(Math.max(t.value,0))/l.maxValue*l.factor*Math.cos(e*l.radians/f))]),l.w/2*(1-Math.max(t.value,0)/l.maxValue*l.factor*Math.sin(e*l.radians/f))}).attr("cy",function(t,e){return l.h/2*(1-Math.max(t.value,0)/l.maxValue*l.factor*Math.cos(e*l.radians/f))}).attr("data-id",function(t){return t.axis}).style("fill",l.color(series)).style("fill-opacity",1.9).on("mouseover",function(t){newX=parseFloat(d3.select(this).attr("cx"))-10,newY=parseFloat(d3.select(this).attr("cy"))-5,u.attr("x",newX).attr("y",newY).text(p(t.value)).transition(100).style("opacity",1),z="polygon."+d3.select(this).attr("class"),m.selectAll("polygon").transition(100).style("fill-opacity",.1),m.selectAll(z).transition(200).style("fill-opacity",.7)}).on("mouseout",function(){u.transition(200).style("opacity",0),m.selectAll("polygon").transition(200).style("fill-opacity",l.opacityArea)}).append("svg:title").text(function(t){return Math.max(t.value,0)}).style("fill",x["font-color"]),series++}),u=m.append("text").style("opacity",0).style("font-family","sans-serif").style("font-size","13px"),d(g)}},ae={drawCombinationalChart:function(t){function e(){var t=d3.svg.line().x(function(t,e){return q(G[e])}).y(function(t,e){return H(k.dataOfLine1[e])}),e=W.selectAll(".path").data([k.xAxisData]).enter().append("path").attr("d",t).attr("stroke",function(){return k.color[0]}).attr("stroke-width",3).attr("fill","none"),n=e.node().getTotalLength();e.attr("stroke-dasharray",function(){return n+","+n}).attr("stroke-dashoffset",n).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0);var r=W.selectAll("rect").data(k.xAxisData).enter().append("rect").attr("class","country1").attr("value",function(t,e){return e}).attr("fill",function(t,e){return k.dataOfLine1[e]<0?"red":k.color[0]}).attr("x",0).attr("y",0).attr("width",function(t,e){return k.dataOfLine1[e]<0?b+1:b}).attr("height",function(t,e){return k.dataOfLine1[e]<0?b+1:b}).on("mouseover",function(){he.style("visibility","visible"),oe.style("visibility","visible").style("display","none"),a(d3.event,d3.select(this).attr("value"))}).on("mouseout",function(){he.style("visibility","hidden"),oe.style("visibility","hidden"),X.hideTooTip()});r.transition().duration(2400).attr("x",function(t,e){return q(G[e])-b/2}).attr("y",function(t,e){return H(k.dataOfLine1[e])-b/2});var i=d3.svg.line().x(function(t,e){return console.log("years="+k.xAxisData[e]),q(G[e])}).y(function(t,e){return console.log("dataOfLine2"+k.dataOfLine2[e]),H(k.dataOfLine2[e])}).interpolate("cardinal"),o=W.selectAll(".path").data([k.xAxisData]).enter().append("path").attr("d",i).attr("stroke",k.color[1]).attr("stroke-width",3).attr("fill","none"),n=o.node().getTotalLength();o.attr("stroke-dasharray",function(){return n+","+n}).attr("stroke-dashoffset",n).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0);var l=W.selectAll("circle").data(k.xAxisData).enter().append("circle").attr("class","country2").attr("value",function(t,e){return e}).attr("fill",function(t,e){return k.dataOfLine2[e]<0?"red":k.color[1]}).attr("cx",0).attr("cy",0).attr("r",function(t,e){return k.dataOfLine2[e]<0?m+1:m}).on("mouseover",function(){he.style("visibility","visible"),oe.style("visibility","visible").style("display","none"),a(d3.event,d3.select(this).attr("value"))}).on("mouseout",function(){he.style("visibility","hidden"),oe.style("visibility","hidden"),X.hideTooTip()});l.transition().duration(2400).attr("cx",function(t,e){return q(G[e])}).attr("cy",function(t,e){return H(k.dataOfLine2[e])})}function a(t,e){L=0,F=k.xAxisData[e],n(e,t),z=[k.PieData.Data1[e],k.PieData.Data2[e]],r()}function n(t,e){var a;a=k.dataOfLine1[t]>k.dataOfLine2[t]?k.xAxisData[t]+"=>"+k.labelLine1+" "+k.yLabel+" "+k.dataOfLine1[t]+"<br>"+k.xAxisData[t]+"=>"+k.labelLine2+" "+k.yLabel+" "+k.dataOfLine2[t]:k.xAxisData[t]+"=>"+k.labelLine2+" "+k.yLabel+" "+k.dataOfLine2[t]+"<br>"+k.xAxisData[t]+"=>"+k.labelLine1+" "+k.yLabel+" "+k.dataOfLine1[t];var n=[{headingName:k.labelLine2+" "+k.yLabel,headingVal:k.dataOfLine2[t]},{headingName:k.labelLine1+" "+k.yLabel,headingVal:k.dataOfLine1[t]}];X.showToolTip(e,"",k.xAxisData[t],!1,n,.95*d3.event.pageY)}function r(){d3.select("#dountGroup").remove();var t=W.append("g").attr("id","dountGroup").attr("transform","translate("+_.left+","+_.top+")"),e=d3.layout.pie().sort(null).value(function(t){return 0>t?0:t}),a=t.selectAll(".arc").data(e(z)).enter().append("g").attr("value",function(t,e){return 0==e?k.labelLine1:k.labelLine2}).attr("fill",function(t,e){return k.color[e]}).on("mouseover",function(){return d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=8;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var a=Math.sin(t.midAngle)*e,n=-Math.cos(t.midAngle)*e;return"translate("+a+","+n+")"}),oe.style("visibility","visible")}).on("mousemove",function(){s(d3.select(this).attr("value"))}).on("mouseout",function(){return d3.select(this).transition().duration(500).ease("bounce").attr("transform","translate(0,0)"),oe.style("visibility","hidden")});a.append("path").attr("d",$).transition().duration(1500).attrTween("d",i)}function i(t){var e=d3.interpolate({startAngle:-180*O,endAngle:-180*O},t);return function(t){return $(e(t))}}function o(){var t;t=d3.min(k.dataOfLine1)<d3.min(k.dataOfLine2)?k.dataOfLine1:k.dataOfLine2,T=E.getMin(t),t=d3.max(k.dataOfLine1)>d3.max(k.dataOfLine2)?k.dataOfLine1:k.dataOfLine2,C=1.4*E.getMax(t)}function l(){var t=j.append("g").attr("id","legendGroup").attr("class","legend").attr("transform","translate("+(2*_.left+1.5*N)+","+(2*_.top-A)+")");t.selectAll("rect").data(k.color).enter().append("rect").attr("class","legend").attr("fill",function(t,e){return k.color[e]}).attr("y",function(t,e){return 2*e*A}).attr("width",A).attr("height",A),t.selectAll("text").data(k.color).enter().append("text").attr("x",function(){return A+3}).attr("y",function(t,e){return 0==e?A:3*A}).style("font-size",12).style("font-family","calibri").style("font-style","italic").text(function(t,e){return 0==e?k.labelLine1+" "+k.yLabel:k.labelLine2+" "+k.yLabel})}function s(t){var e;e=t==k.labelLine1?F+"=>"+k.labelLine1+" "+k.pieDataFactor+" "+z[0]:F+"=>"+k.labelLine2+" "+k.pieDataFactor+" "+z[1],oe.style("z-index",1).style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px").text(e)}function u(){var t,e,a,n,r=W.append("g").attr("id","clickedSymbolGroup").attr("transform","translate(0,0)"),i=[];for(key in k.clickedInfo)i.push(k.xAxisData.indexOf(parseInt(key)));r.selectAll("img").data(i).enter().append("image").attr("value",function(t){return k.xAxisData[t]}).attr("x",function(t){return q(t)-y/2}).attr("y",function(r,o){t=f(k.xAxisData[r]),e=k.dataOfLine1[t],a=k.dataOfLine2[t],n=e>a?e:a;for(var l=0,s=o;s>=0;s--)i[s]==i[o]&&++l;return H(n)-1.5*y*l}).attr("width",y).attr("height",y).attr("xlink:href",k.clickedSybmol).on("click",function(){h(d3.select(this).attr("value"))})}function f(t){for(var e=0;e<k.xAxisData.length&&k.xAxisData[e]!=t;e++);return e}function h(t){d3.select("#innerDiv").text(k.clickedInfo[t]),le.style("visibility","visible"),le.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+10+"px"),oe.style("visibility","hidden")}var v,y,m,b,A,M=p,k=t,w=parseInt(d3.select("#"+M).style("width")),S=parseInt(d3.select("#"+M).style("height"));301>S?(y=10,m=3,b=5,A=7):(y=18,m=5,b=8,A=12);for(var C,T,L,N,D,P=Y.leftMarginController(k.dataOfLine1),_={top:.1*S,right:.05*w,bottom:45,left:P},I=w-_.left-_.right,V=S-_.top-_.bottom,F=(d3.select("#"+M),k.xAxisData[0]),O=Math.PI/180,z=[k.PieData.Data1[0],k.PieData.Data2[0]],G=[],J=0;J<k.xAxisData.length;J++)G[J]=J;o();var q=d3.scale.linear().domain([0,k.xAxisData.length-1]).range([0,I]),H=d3.scale.linear().domain([T,C]).range([V,0]),j=(d3.select("#"+M),g);U.init(g,V,I,_.left,_.top,x.gridLineColor);var W=j.append("g").attr("id","combinationalGroup").attr("transform","translate("+_.left+","+_.top+")");N=_.top,D=N-.6*N;var $=d3.svg.arc().innerRadius(D).outerRadius(N);r(),l(),u();var Z=7.5,K=w/2-k.title.length*Z/2,Q=g.append("g").attr("class","title");R.appendLabel(k.title,K,_.top/2,0,Q,x.chartTitleColor,800);var Z=6,te=k.xAxisLabel.toString().length*Z,ee=V+(_.bottom-5),ae=I/2-te/2;R.appendLabel(k.xAxisLabel,ae,ee,0,W,x.xLabelColor,600);var ne=k.yLabel.toString().length*Z,re=V/2+ne/2,ie=-_.left+15;R.appendLabel(k.yLabel,ie,re,-90,W,x.yLabelColor,600);var oe=d3.select("body").append("div").style("background","rgba(0,0,0,.6)").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("color","white").style("padding","5px").text("a simple tooltip").style("display","none"),le=d3.select("body").attr("id","outerDiv").append("div").style("width","200px").style("background","#1f77b4").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("padding","2px").style("box-shadow","0 0 10px #ccc").style("color","white").style("font-size",15).text("NEWS");le.append("img").attr("id","closeButton").style("float","right").style("margin-top","-10px").style("margin-right","-10px").attr("src","http://stocinn.github.io/stocweb/img/cross.png").on("click",function(){le.style("visibility","hidden")}),le.append("div").attr("id","innerDiv").style("padding","5px 10px 5px 10px").style("font-size",12).style("color","black").style("background","#fff").text("inner box"),e();for(var se=0,J=0;J<k.xAxisData.length;J++)se<k.xAxisData[J].toString().length&&(se=k.xAxisData[J].toString().length);var ue=d3.svg.axis().scale(q).orient("bottom").tickValues(B.getXTickArray(0,k.xAxisData.length,se,I)),ce=W.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+V+")").call(ue);ce.selectAll("text").text(function(t){return k.xAxisData[t]}).attr("font-family","calibri");var de=d3.svg.axis().scale(H).orient("left").tickValues(B.getTickArray(T,C,10));W.append("g").attr("id","y axis").attr("class","yAxis").attr("font-size",v).attr("transform","translate( 0 , 0)").call(de),d3.select(".yAxis path").attr("fill","none");var fe=[],he=(d3.svg.line().x(function(){return fe[L++]}).y(function(){return fe[L++]}),j.append("path").data([fe]).attr("stroke","gray").attr("stroke-width",1).attr("fill","none"));c(g),d(g)}},ne={drawDrillDownChart:function(t,e,a){function n(){function n(e,n){var l=e;if("undefined"!=typeof l){o.remove(),o=g.append("svg").attr("width",v).attr("height",1.5*y).append("g").attr("transform","translate("+i+","+.05*y+")"),C=d3.scale.ordinal().rangeRoundBands([i,v-.05*v],.1).domain(l.map(function(t){return t.x}));var s=d3.max(l,function(t){return t.y});s=1.5*s,L=d3.scale.linear().range([y-.08*y,.08*y]).domain([0,s]),N=d3.svg.axis().scale(C).tickSize(5).tickSubdivide(!1),D=d3.svg.axis().scale(L).tickSize(5).orient("left").tickSubdivide(!1);for(var u=l[0].name.length,f=0;f<l.length;f++){var h=l[f].name.length;h>u&&(u=h)}var p=B.getXTickArray(0,l.length,u,v-r.rightMargin);N.tickValues(p);var m=o.append("svg:g").attr("class","x axis").attr("transform","translate(0,"+(y-r.bottomMargin)+")").call(N);m.selectAll("text").text(function(t){return l[t].name});var b=o.append("svg:g").attr("class","y axis").attr("transform","translate("+r.leftMargin+",-35)").call(D);o.selectAll("rect").data(l).enter().append("rect").attr("id",t).on("mousemove",function(t){var e=[{headingName:r.yLabel,headingVal:t.y}];X.showToolTip(d3.event,"",r.xLabel+" "+t.name,!1,e,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}).attr("x",0).attr("y",y).transition().duration(1200).attr("x",function(t){return C(t.x)}).attr("y",function(t){return L(t.y)-r.bottomMargin}).attr("width",C.rangeBand()).attr("height",function(t){return y-L(t.y)}).attr("fill",function(t,e){return n[e]});var A=6,M=r.yLabel.toString().length*A,k=y/2+M/2,w=-i-.5*i;R.appendLabel(r.yLabel,w,k,-90,b,x.xLabelColor,600);var M=r.xLabel.toString().length*A,S=.1*y,P=v/2-M/2;R.appendLabel(r.xLabel,P,S,0,m,x.yLabelColor,600),d3.select(".resetDrillDownBtn").on("click",function(){ne.drawDrillDownChart(t,T,a),d3.select(".resetDrillBtnGroup").style("display","none")}),c(g),d(g)}}var i;i=30>.05*v?30:.05*v;var o=g.append("svg:g").attr("width",v).attr("height",y).attr("class","backtobrand").attr("transform","translate("+i+","+.1*y+")").append("g"),l=[],s=0,u=0,f=0;for(var h in e){u<e[h].data&&(u=e[h].data),f>e[h].data&&(f=e[h].data);var p=e[h].subData,m=[],b=0;for(var A in p){var M=p[A],k={name:A,x:b,y:M};m.push(k),b++}var w={x:s,y:e[h].data,color:e[h].color,subDataColorArray:e[h].subDataColorArray,name:h,subData:m};l.push(w),s++}var S=u;S=1.2*S;var C=d3.scale.ordinal().rangeRoundBands([i,v-.05*v],.1).domain(l.map(function(t,e){return e})),L=d3.scale.linear().range([y-r.topMargin,r.bottomMargin]).domain([0,S]),N=d3.svg.axis().scale(C).tickSize(5).tickSubdivide(!0),D=d3.svg.axis().scale(L).tickSize(5).orient("left").tickSubdivide(!1),P=o.append("svg:g").attr("class","x axis").attr("transform","translate(0,"+(y-r.bottomMargin)+")").call(N);P.selectAll("text").text(function(t){return l[t].name}),P.selectAll("text").call(J.wrapText,40);var I=o.append("svg:g").attr("class","y axis").attr("transform","translate("+r.leftMargin+","+-r.bottomMargin+")").call(D);if(o.selectAll("rect").data(l).enter().append("rect").on("click",function(t){t.subData.length>0?n(t.subData,t.subDataColorArray):alert("dont have sub data"),d3.select(".resetDrillBtnGroup").style("display","block")}).on("mousemove",function(t){var e=[{headingName:r.yLabel,headingVal:t.y}];X.showToolTip(d3.event,"",r.xLabel+" "+t.name,!1,e,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}).attr("x",0).attr("y",y).transition().duration(1200).attr("x",function(t){return C(t.x)}).attr("y",function(t){return L(t.y)-r.bottomMargin}).attr("width",C.rangeBand()).attr("height",function(t){return y-L(t.y)}).attr("fill",function(t){return t.color}).style("cursor",function(t){return t.subData.length>0?"pointer":""}),d3.select(".resetDrillDownBtn").empty()){var V=70,F=30,O=g.append("g").attr("class","resetDrillBtnGroup").attr("transform","translate("+(v-3*r.leftMargin)+","+_.top+")");O.append("rect").attr("width",V).attr("height",F).attr("x","0").attr("y","0").attr("rx","2").attr("ry","2").attr("class","resetDrillDownBtn").on("mouseover",function(){d3.select(".resetDrillDownBtn").style("fill","#7F7FFF")}).on("mouseout",function(){d3.select(this).style("fill","#19a586")}).style("fill","#19a586").style("display","inline-block").style("cursor","pointer"),O.append("text").attr("x",20).attr("y",F/2).attr("dy",".35em").attr("class","resetDrillDownBtn").text("Reset").attr("fill","white"),d3.select(".resetDrillBtnGroup").style("display","none")}var z=6,G=r.yLabel.toString().length*z,E=y/2+G/2,Y=-i;R.appendLabel(r.yLabel,Y,E,-90,I,x.yLabelColor,600);var G=r.xLabel.toString().length*z,q=.1*y,U=v/2-G/2;R.appendLabel(r.xLabel,U,q,0,P,x.xLabelColor,600),c(g),d(g)}var r={topMargin:5,rightMargin:30,bottomMargin:0,leftMargin:10,color:d3.scale.category20(),toolTipLabel:"Drilled Chart",redraw:"false"},i=9,o=v/2-a.title.length*i/2,l=g.append("g").attr("class","title");if(R.appendLabel(a.title,o,.06*y,0,l,x.chartTitleColor,800),"undefined"!=typeof a)for(var s in a)"undefined"!=typeof a[s]&&(r[s]=a[s]);g.selectAll(".tick").empty()?(T=e,y-=.2*y):g.selectAll("g").remove(),n()}},re={variationAnalysis:function(e){var a,n,r,i,o,l=e.data.title,s=e.data.subTitle,u=(e.data.titleColor,e.data.yAxisData),f=e.data.yAxisLabel,p=e.data.xAxisData,m=e.data.xAxisLabel,b=Y.leftMarginController(u),A={left:b,right:.05*v,bottom:45,top:.15*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},M=(t(h).offset().left,t(h).offset().top),k=v-A.left-A.right,w=y-A.top-A.bottom;n=w/(2*u.length),501>v?(i=18,o=8,a=11,r=9):(i=20,o=12,a=14,r=10);for(var S="calibri",C=[],T=[],L=0,N=0;N<p.length;N++)for(var D=0;2>D;D++)0==D?C[L]=p[N][D]:T[L++]=p[N][D];variationMainGroup=g.append("g").attr("class","main-group").attr("transform","translate("+A.left+","+A.top+")");var P=8,_=v/2-l.length*P/2,I=g.append("g").attr("class","title"),V=g.append("g").attr("class","sub-title");R.appendLabel(l,_,A.top/2.8,0,I,x.chartTitleColor,800),_=v/2-s.length*P/2,R.appendLabel(s,_,A.top/1.4,0,V,x.chartTitleColor,600);var F={init:function(t,e,a,n,r,i){var l=Math.ceil(.2*e),s=Math.ceil(a/l);t.selectAll(".vline").data(d3.range(s)).enter().append("line").attr("x1",function(t){return t*(a/o)}).attr("x2",function(t){return t*(a/o)}).attr("y1",function(){return 0}).attr("y2",function(){return e}).style("stroke",i).style("stroke-width",.3).attr("transform","translate("+n+","+r+")")}};F.init(variationMainGroup,w,k,0,0,x.gridLineColor);var O=d3.scale.linear().domain([0,u.length-1]).range([.5*n,w-.5*n]),z=d3.svg.axis().scale(O).orient("left").tickValues(B.getTickArray(0,u.length-1,12)),P=(variationMainGroup.append("g").attr("class","y axis").attr("transform","translate(0,0)").attr("fill","none").call(z).selectAll("text").text(function(t){return u[t]}).attr("fill","black"),7),G=f.toString().length*P,J=w/2+G/2,q=-A.left+15;R.appendLabel(f,q,J,-90,variationMainGroup,x.yLabelColor,600);var U=E.getMin(C);U=U>0?.8*U:1.5*U;var H=E.getMax(T);H=H>0?1.3*H:.8*H;{var j=d3.scale.linear().domain([U,H]).range([0,k]),W=d3.svg.axis().scale(j).orient("bottom");variationMainGroup.append("g").attr("class","x axis").attr("transform","translate(0,"+w+")").attr("font-size",a).attr("fint-family",S).call(W).selectAll("text").attr("fill","black")}d3.select(".x-axis").attr("fill","none");var $=m.toString().length*P,Z=w+(A.bottom-5),K=k/2-$/2;R.appendLabel(m,K,Z,0,variationMainGroup,x.xLabelColor,600);var Q=variationMainGroup.append("g").attr("class","rectangle-group").attr("transform","translate(0,0)"),te=Q.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");te.append("stop").attr("offset","0").attr("stop-color","#00ff73"),te.append("stop").attr("offset","1").attr("stop-color","#00ffe7");var ee=(d3.min(C)+d3.max(T))/2,ae=Q.selectAll("rect").data(T).enter().append("rect").attr("value",function(t,e){return e}).attr("x",function(){return j(ee)}).attr("y",function(t,e){return O(e)-n/2}).attr("width",function(){return 0}).attr("height",n).attr("fill","url(#rectangleGradient)").on("mousemove",function(){var t=d3.event.pageY-(M+A.top);t=Math.round(O.invert(t));var e=p[t][0],a=p[t][1],n=f+"-"+u[t],r=[{headingName:"Min",headingVal:e+" "+m},{headingName:"Max",headingVal:a+" "+m}];X.showToolTip(d3.event,"",n,!1,r,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()});ae.transition().duration(1e3).attr("x",function(t,e){return j(C[e])}).attr("width",function(t,e){return j(T[e])-j(C[e])}),Q.selectAll("text").data(T).enter().append("text").attr("x",function(t,e){return j(C[e])-(C[e].toString().length+m.length)*P}).attr("y",function(t,e){return O(e)+5}).attr("font-family",S).attr("fill",x.yLabelColor).text(function(t,e){return C[e]+" "+m});var ne=variationMainGroup.append("g").attr("class","rectangleTextRightSide").attr("transform","translate(0,0)");ne.selectAll("text").data(T).enter().append("text").attr("x",function(t,e){return j(T[e])+5}).attr("y",function(t,e){return O(e)+5}).attr("font-family",S).attr("fill",x.yLabelColor).text(function(t,e){return T[e]+" "+m}),c(g),d(g)}},ie={drawPieChartWithTransition:function(t){function e(t,e,a,n){n.selectAll(".rect").data(t).enter().append("rect").attr("y",function(t,e){return 2*e*a}).attr("width",a).attr("height",a).attr("fill",function(t,a){return e[a]}),n.selectAll(".text").data(t).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",a+4).attr("y",function(t,e){return 2*e*a+a/1.3}).text(function(t){return t})}function a(t,e,a,n){for(var r=0,i=0;i<a.length;i++)r<a[i].toString().length&&(r=a[i].toString().length);r=7*r;for(var o=[],l={x:0,y:0,textXPos:0},s=5,u=.1*t,c=Math.round(.8*t/(s+n+r)),i=0;i<a.length;i++){var l={};u=i%c==0?.1*t:u+s+n+r,l.x=u,i%c==0&&0!=i&&(e+=2*n),l.y=e,l.textXPos=u+s+n,o.push(l)}return o}function n(t){var e=d3.interpolate({startAngle:-180*h,endAngle:-180*h},t);return function(t){return w(e(t))}}for(var r,i,o=t.key,l=t.value,s=t.label,u=t.color,c=t.legendOrient,f=t.innerRadius,h=Math.PI/180,p=.02*v,x=7,m=0,b=4,A=0;A<o.length;A++)m<o[A].toString().length&&(m=o[A].toString().length);var M;m*=x,i=m+p+b;var k;"left"==c?(r=v-m,k=g.append("g").attr("class","dountPie").attr("transform","translate("+(r/2+m)+","+y/2+")"),M=r/2>y/2?y/2:r/2,M=.92*M):"right"==c?(r=v-m-5,k=g.append("g").attr("class","dountPie").attr("transform","translate("+r/2+","+y/2+")"),M=r/2>y/2?y/2:r/2,M=.92*M):"top"==c?(console.log("top"),k=g.append("g").attr("class","dountPie").attr("transform","translate("+v/2+","+(y/2+2*p)+")"),M=v>y-4*p?y-4*p:v,M=.45*M):(console.log("bottom"),k=g.append("g").attr("class","dountPie").attr("transform","translate("+v/2+","+(y/2-2*p)+")"),M=v>y-4*p?y-4*p:v,M=.45*M);var w=d3.svg.arc().innerRadius(f*M).outerRadius(M),S=(d3.svg.arc().innerRadius(0).outerRadius(M+14),d3.layout.pie().sort(null).value(function(t){return t})),C=k.selectAll(".arc").data(S(l)).enter().append("g").attr("value",function(t,e){return e}).style("fill",function(t,e){return u[e]}).on("mouseover",function(){d3.select(this).attr("value");d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=8;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var a=Math.sin(t.midAngle)*e,n=-Math.cos(t.midAngle)*e;return"translate("+a+","+n+")"}).attr("stroke","white")}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=o[t],a=l[t],n=[{headingName:s,headingVal:a}];X.showToolTip(d3.event,"",e,!1,n,.96*d3.event.pageY)}).on("mouseout",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform","translate(0,0)").attr("stroke","none"),X.hideTooTip()});C.append("path").attr("d",w).transition().duration(1500).attrTween("d",n);var T,L,N;if("left"==c)N=y/2-o.length/2*p*2,T=g.append("g").attr("class","legend").attr("transform","translate(2,"+N+")"),e(o,u,p,T);else if("right"==c)L=r/2+(M+10),N=y/2-o.length/2*p*2,T=g.append("g").attr("class","legend").attr("transform","translate("+L+","+N+")"),e(o,u,p,T);else if("top"==c){L=.15*v,N=5,T=g.append("g").attr("class","legend").attr("transform","translate("+L+","+N+")");{var D=a(.7*v,0,o,p);T.selectAll(".rect").data(D).enter().append("rect").attr("width",p).attr("height",p).attr("x",function(t,e){return D[e].x}).attr("y",function(t,e){return D[e].y}).attr("fill",function(t,e){return u[e]}),T.selectAll(".text").data(D).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",function(t,e){return D[e].textXPos}).attr("y",function(t,e){return D[e].y+p}).text(function(t,e){return o[e]})}}else{L=.15*v,N=y/2-2*p+M+4,T=g.append("g").attr("class","legend").attr("transform","translate("+L+","+N+")");{var D=a(.7*v,0,o,p);T.selectAll(".rect").data(D).enter().append("rect").attr("width",p).attr("height",p).attr("x",function(t,e){return D[e].x}).attr("y",function(t,e){return D[e].y}).attr("fill",function(t,e){return u[e]}),T.selectAll(".text").data(D).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",function(t,e){return D[e].textXPos}).attr("y",function(t,e){return D[e].y+p}).text(function(t,e){return o[e]})}}d(g)},dountChartWithLegend:function(t){function e(t){var e=n(t);b.value.splice(0,0,m.value[e]),b.key.splice(0,0,m.key[e]),b.color.splice(0,0,m.color[e]),m.value.splice(e,1),m.key.splice(e,1),m.color.splice(e,1),o()}function a(t){for(var e=0;e<b.key.length&&b.key[e]!=t;e++);return m.value.splice(0,0,b.value[e]),m.key.splice(0,0,b.key[e]),m.color.splice(0,0,b.color[e]),o(),b.color[e]}function n(t){for(var e=0;e<m.key.length&&m.key[e]!=t;e++);return e}function r(t){for(var e,a=0,n=0;n<m.value.length;n++)m.key[n]==t&&(e=m.value[n]),a+=m.value[n];return Math.round(e/a*100)}function i(t,e){var a=n(t),i=[{headingName:m.label,headingVal:r(t)+"%"}];X.showToolTip(e,"",m.key[a],!1,i,.95*d3.event.pageY)}function o(){g.select("#group").remove(),C=S.append("g").attr("id","group").attr("transform","translate("+(A+w.left+w.right)/2+","+((M+w.top+w.bottom)/2-w.top)+")");var t=C.selectAll(".arc").data(N(m.value)).enter().append("g").attr("value",function(t,e){return m.key[e]}).attr("fill",function(t,e){return m.color[e]}).on("mouseover",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=10;t.midAngle=(t.endAngle+t.startAngle)/2;var a=Math.sin(t.midAngle)*e,n=-Math.cos(t.midAngle)*e;return"translate("+a+","+n+")"})}).on("mousemove",function(){i(d3.select(this).attr("value"),d3.event)}).on("mouseleave",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform","translate(0,0)"),X.hideTooTip()});t.append("path").attr("d",L).transition().duration(1500).attrTween("d",l);try{d(D)}catch(e){}}function l(t){var e=d3.interpolate({startAngle:-180*v,endAngle:-180*v},t);return function(t){return L(e(t))}}var s,u,c,f,h=0,p=0,v=Math.PI/180,y=t.divId,m=t.data,b={key:[],value:[],color:[]},A=parseInt(d3.select("#"+y).style("width")),M=parseInt(d3.select("#"+y).style("height"));301>A||301>M?(c=10,f=6,textSpace=7):401>A||401>M?(c=12,f=9,textSpace=9):601>A||601>M?(c=14,f=10,textSpace=12):(c=15,f=11,textSpace=19);{var k,w={top:.1*M,right:.1*A,bottom:.2*M,left:.1*A},A=A-w.left-w.right,M=M-w.top-w.bottom;m.key.length,d3.select("body").append("div").style("background","rgba(0,0,0,.6)").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("color","white").text("a simple tooltip")}A>M?(s=M/2,k=.05*M):(s=A/2,k=.05*A),u=s-.5*s;var S=(d3.select("#"+y),g),C=S.append("g").attr("id","group").attr("transform","translate("+(A+w.left+w.right)/2+","+((M+w.top+w.bottom)/2-w.top)+")"),T=2*s,L=d3.svg.arc().innerRadius(u).outerRadius(s),N=d3.layout.pie().sort(null).value(function(t){return t});o();var D=S.append("g").attr("transform","translate("+((A+w.left+w.right)/2-s)+","+((M+w.top+w.bottom)/2+s)+")");D.selectAll("rect").data(m.value).enter().append("rect").attr("class","legend").attr("value",function(t,e){return m.key[e]}).attr("fill",function(t,e){return m.color[e]}).attr("x",function(t,e){return e>3?parseInt(e/4)-1+.3*h++*T:.3*e*T}).attr("y",function(t,e){return e>3?2*k:void 0}).attr("width",k).attr("height",k).on("click",function(){"gray"==d3.select(this).attr("fill")?(d3.select(this).attr("fill",a(d3.select(this).attr("value"))),d3.select(this).style("text-decoration","none")):(d3.select(this).attr("fill","gray"),d3.select(this).style("text-decoration","line-through"),e(d3.select(this).attr("value")))});var P=D.selectAll("text").data(m.value).enter().append("text").attr("x",function(t,e){return e>3?parseInt(e/4)-1+.3*p++*T+k+3:.3*e*T+k+3}).attr("y",function(t,e){return e>3?3*k:k}).style("font-family","calibri").style("font-style","italic").text(function(t,e){return m.key[e]});d(g),P.style("fill",x.legendTextColor)},newDountChartWithBarAnalysis:function(t){function e(t){var e=i(s[t].subData);d3.select(".barGroup").remove();var a=C.append("g").attr("class","barGroup").attr("transform","translate("+.55*A+","+I+")"),r=a.selectAll(".rect").data(s[t].subData).enter().append("rect").attr("y",function(t,e){return 2*e*_}).attr("width",0).attr("height",_).attr("rx",.1*_).attr("ry",.1*_).attr("fill",function(t,e){var r=a.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");return r.append("stop").attr("offset","0").attr("stop-color",function(){return n(o[e],.5)}),r.append("stop").attr("offset","1").attr("stop-color",function(){return n(o[e],-.5)}),"url(#rectangleGradient"+e+")"});r.transition().duration(1500).attr("width",function(t){var a=t/e,n=P*a;return n}),a.selectAll(".text").data(s[t].subData).enter().append("text").attr("x",5).attr("y",function(t,e){return 2*e*_+.65*_}).attr("fill","white").text(function(t){return Math.round(t/e*100)+u}),a.selectAll(".text").data(l).enter().append("text").attr("x",function(a,n){var r=s[t].subData[n]/e,i=P*r;return i+=5,i+8*a.toString().length<P?i:P-8*a.toString().length}).attr("y",function(t,e){return 2*e*_+.65*_}).text(function(t){return t})}function a(t){var e=d3.interpolate({startAngle:-180*m,endAngle:-180*m},t);return function(t){return O(e(t))}}function r(t,e,a,n){n.selectAll(".circle").data(t).enter().append("circle").attr("id",function(t,e){return"legend"+e
}).attr("cy",function(t,e){return 4*e*a}).attr("r",a).attr("fill",function(t,a){return e[a]}),n.selectAll(".text").data(t).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",a+4).attr("y",function(t,e){return 4*e*a+a/1.5}).text(function(t){return t})}function i(t){for(var e=0,a=0;a<t.length;a++)e+=t[a];return e}for(var o=t.subDataColor,l=t.subDataKey,s=t.obj,u=t.unit,c=[],f=[],h=[],p=t.title,x=0;x<s.length;x++)c.push(s[x].data),f.push(s[x].color),h.push(s[x].key);for(var m=Math.PI/180,b={left:.02*v,right:.02*v,bottom:.04*y,top:.04*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},A=v-b.left-b.right,M=y-b.top-b.bottom,k=0,w=0;w<h.length;w++)k<h[w].toString().length&&(k=h[w].toString().length);var S=9,k=k*S,C=g.append("g").attr("class","main-group").attr("transform","translate("+b.left+","+b.top+")"),T=.6*A-(k+S);T=.45*T;var L=C.append("g").attr("class","dountGroup").attr("transform","translate("+T+","+M/2+")"),N=M/2>T?T:M/2;N=.9*N;var D=.6*N,P=.45*A,_=2*N/l.length*.5,I=M/2-N,V=C.append("g").attr("class","fixBarGroup").attr("transform","translate("+.55*A+","+I+")");V.append("text").attr("y",-10).attr("id","subDataKey").style("font-size","16px","important").style("font-weight",600,"important").text(s[0].key);var F=(V.selectAll(".rect").data(l).enter().append("rect").attr("y",function(t,e){return 2*e*_}).attr("width",P).attr("height",_).attr("rx",.15*_).attr("ry",.15*_).attr("fill","#f5f5f5").style("style","border:1px solid black;border-radius: 15px;"),!0),O=d3.svg.arc().innerRadius(D).outerRadius(N),z=(d3.svg.arc().innerRadius(D-20).outerRadius(N+20),d3.layout.pie().sort(null).value(function(t){return t})),G=L.selectAll(".arc").data(z(c)).enter().append("g").attr("id",function(t,e){return"arc"+e}).attr("value",function(t,e){return e}).attr("startAngle",function(t){return t.startAngle}).attr("endAngle",function(t){return t.endAngle}).attr("fill",function(t,e){return f[e]}).on("click",function(){var t=parseInt(d3.select(this).attr("value"));g.select("#subDataKey").text(s[t].key),e(t)}).on("mouseover",function(){this.parentNode.appendChild(this);var t=parseInt(d3.select(this).attr("value"));g.select("#legend"+t).attr("r",R+3),F&&(F=!1,d3.select("#legend"+(f.length-1)).attr("r",R),d3.select("#arc"+(f.length-1)).transition().duration(500).ease("linear").attr("stroke",f[t]).attr("stroke-width",1)),d3.select(this).transition().duration(500).ease("bounce").attr("stroke",f[t]).attr("stroke-width",15)}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=p,a=[{headingName:s[t].key,headingVal:s[t].data}];X.showToolTip(d3.event,"",e,!1,a,.9*d3.event.pageY)}).on("mouseleave",function(){var t=parseInt(d3.select(this).attr("value"));d3.select("#legend"+t).attr("r",R),d3.select(this).transition().duration(500).ease("linear").attr("stroke",f[t]).attr("stroke-width",1),X.hideTooTip()});G.append("path").attr("d",O).transition().duration(1500).attrTween("d",a);var R=8,E=T+(N+b.left+20),Y=y/2-h.length/2*R*4;legendGroup=g.append("g").attr("class","legend").attr("transform","translate("+E+","+Y+")"),r(h,f,R,legendGroup),d3.select("#arc"+(f.length-1)).transition().duration(500).ease("linear").attr("stroke",f[f.length-1]).attr("stroke-width",15),d3.select("#legend"+(f.length-1)).attr("r",R+3),e(s.length-1),d(g)},drawDountWithBarChart:function(t){function e(t){var e=n(t);M.value.splice(0,0,y.value[e]),M.key.splice(0,0,y.key[e]),M.color.splice(0,0,y.color[e]),y.value.splice(e,1),y.key.splice(e,1),y.color.splice(e,1),o()}function a(t){for(var e=0;e<M.key.length&&M.key[e]!=t;e++);return y.value.splice(0,0,M.value[e]),y.key.splice(0,0,M.key[e]),y.color.splice(0,0,M.color[e]),o(),M.color[e]}function n(t){for(var e=0;e<y.key.length&&y.key[e]!=t;e++);return e}function r(t){for(var e,a=0,n=0;n<y.value.length;n++)y.key[n]==t&&(e=y.value[n]),a+=y.value[n];return Math.round(e/a*100)}function i(t,e){var a=n(t);d3.event.pageY=d3.event.pageY;var i=[{headingName:y.label,headingVal:y.value[a]+" "+r(t)+"%"}];X.showToolTip(e,"",y.key[a],!1,i,.9*d3.event.pageY)}function o(){g.select("#dountGroup").remove(),T=C.append("g").attr("id","dountGroup").attr("transform","translate("+.4*(k+S.left+S.right)/2+","+((w+S.top+S.bottom)/2-S.bottom)+")");var t=T.selectAll(".arc").data(O(y.value)).enter().append("g").attr("id",function(t,e){return y.key[e]}).attr("value",function(t,e){return y.key[e]}).attr("fill",function(t,e){return y.color[e]}).on("click",function(){s(d3.select(this).attr("value"))}).on("mouseover",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=10;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var a=Math.sin(t.midAngle)*e,n=-Math.cos(t.midAngle)*e;return"translate("+a+","+n+")"})}).on("mousemove",function(){0==A&&(d3.select("#"+y.key[0]).transition().duration(500).ease("bounce").attr("transform","translate(0,0)"),A=1),i(d3.select(this).attr("value"),d3.event)}).on("mouseout",function(){d3.select(this).transition().duration(500).ease("bounce").attr("transform","translate(0,0)"),X.hideTooTip()});t.append("path").attr("d",F).transition().duration(1500).attrTween("d",l)}function l(t){var e=d3.interpolate({startAngle:-180*b,endAngle:-180*b},t);return function(t){return F(e(t))}}function s(t){g.select("#barGroup").remove();var e=C.append("g").attr("id","barGroup").attr("transform","translate("+(.4*(k+S.left+S.right)+S.left)+","+((w+S.top+S.bottom)/2-S.bottom-u/1.5)+")");d3.select("#showCountryGroup").remove();var a=C.append("g").attr("id","showCountryGroup").attr("transform","translate("+(.4*(k+S.left+S.right)+S.left)+","+((w+S.top+S.bottom)/2-S.bottom-u)+")");a.append("text").transition().duration(1500).attr("fill",y.color[n(t)]).style("font-family","calibri").style("font-size",2*f).style("font-style","italic").text(t);var r=d3.scale.linear().domain([0,d3.max(m[t])]).range([0,.32*k]),i=e.selectAll("g").data(m[t]).enter().append("g").attr("transform",function(t,e){return"translate(0,"+e*rectSize*2.6+")"}),o=i.append("rect").attr("width",function(){return 0}).attr("height",1.3*rectSize);o.transition().duration(1500).attr("width",function(e,a){return r(m[t][a])}).attr("fill",function(t,e){return m.color[e]});for(var l=0,s=0;s<m[t].length;s++)l+=m[t][s];i.append("text").transition().duration(1500).attr("x",function(e,a){return r(m[t][a])-2*f}).attr("y",1.3*rectSize/2).attr("dy",".35em").style("font-size",f+2).style("fill",y.textAndLegendColor).style("font-family","calibri").style("font-style","italic").text(function(e,a){return Math.round(m[t][a]/l*100)+"%  "+m.key[a]})}var u,c,f,h,p,v=t.divId,y=t.data,m=t.subDataArray,b=Math.PI/180,A=0,M={key:[],value:[],color:[]},k=parseInt(d3.select("#"+v).style("width")),w=parseInt(d3.select("#"+v).style("height"));301>k||301>w?(f=7,h=6,p=7):401>k||401>w?(f=10,h=9,p=9):601>k||601>w?(f=12,h=10,p=12):(f=14,h=11,p=19);var S={top:.1*w,right:.1*k,bottom:.2*w,left:.1*k},k=k-S.left-S.right,w=w-S.top-S.bottom,C=(d3.select("body").append("div").style("background","rgba(0,0,0,.6)").style("position","absolute").style("visibility","hidden").style("font-family","calibri").style("font-style","normal").style("color","white").text("a simple tooltip"),d3.select("#"+v),g.append("g").attr("transform","translate(0,"+S.top+")")),T=C.append("g").attr("id","dountGroup").attr("transform","translate("+.4*(k+S.left+S.right)/2+","+(S.top+S.bottom)+")");.4*k>w?(u=w/2,rectSize=.06*w):(u=.4*k/2,rectSize=.4*k*.06),c=u-.5*u;var L=C.append("g").attr("id","lineGroup").attr("transform","translate("+(k+S.left+S.right)/2.4+",0)"),N=[0,(w+S.top+S.bottom)/2-S.bottom-u,0,(w+S.top+S.bottom)/2-S.bottom+u],D=0,P=d3.svg.line().x(function(){return N[D++]}).y(function(){return N[D++]}),I=L.append("path").data([N]).attr("stroke","lightgray").attr("stroke-width",1).attr("fill","none");I.attr("d",P);var V=2*u+2*_.right/2.5,F=d3.svg.arc().innerRadius(c).outerRadius(u),O=d3.layout.pie().sort(null).value(function(t){return t});o(),s(y.key[0]),d3.select("#"+y.key[0]).transition().duration(500).ease("bounce").attr("transform",function(t){var e=10;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var a=Math.sin(t.midAngle)*e,n=-Math.cos(t.midAngle)*e;return"translate("+a+","+n+")"});var z=C.append("g").attr("transform","translate("+(.4*(k+S.left+S.right)/2-(u+S.right/2.5))+","+((w+_.top+_.bottom)/2-_.bottom+u+10)+")"),V=2*u+2*S.right/3,R=10,E=10,Y=20,B=0,J=.05*V,q=.05*V,U=G.getLegendPositionArray(y.key,V+.5*V,w);z.selectAll("rect").data(y.key).enter().append("rect").attr("class","legend").attr("value",function(t,e){return y.key[e]}).attr("fill",function(t,e){return y.color[e]}).attr("x",function(t,e){return U[e].x}).attr("y",function(t,e){return U[e].y}).attr("width",R).attr("height",E).on("click",function(){"gray"==d3.select(this).attr("fill")?(d3.select(this).attr("fill",a(d3.select(this).attr("value"))),d3.select(this).style("text-decoration","none")):(d3.select(this).attr("fill","gray"),d3.select(this).style("text-decoration","line-through"),e(d3.select(this).attr("value")))}),B=0,J=0*V+Y,q=0*V,z.selectAll("text").data(y.key).enter().append("text").attr("x",function(t,e){return U[e].textPos}).attr("y",function(t,e){return U[e].y+E}).style("font-size",f).style("fill",y.textAndLegendColor).style("font-style","italic").style("font-family","calibri").text(function(t){return t}),d(g),z.selectAll("text").style("fill",x.legendTextColor)},multipleDountChartAnalysis:function(t){function e(t){var e=d3.interpolate({startAngle:-180*h,endAngle:-180*h},t);return function(t){return T(e(t))}}var a,n,r,i,o={left:.05*v,right:.05*v,bottom:.05*y,top:.05*y,chartSeparator:10,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},l=v-o.left-o.right,s=y-o.top-o.bottom,u=t.data.length,f=1,h=Math.PI/180,p=.015*l,m=1.3*p;r=.8*l/Math.round(u/2)/2<s/2?.8*l/Math.round(u/2)/2:s/2,r=.4*r,i=.75*r;var b=8,A=v/2-t.title.length*b/2,M=g.append("g").attr("class","title");R.appendLabel(t.title,A,o.top,0,M,x.chartTitleColor,800);for(var k,w,S=d3.layout.pie().sort(null).value(function(t){return t}),C=0;u>C;C++){1==u?(a=g.append("g").attr("id","dount-main-group").attr("class","legend").attr("transform","translate("+.8*l/2+","+.5*s+")"),r=s>.8*l?.8*l:s,r=.4*r,i=.75*r):C<Math.round(u/2)?(k=.3*s,a=g.append("g").attr("id","dount-main-group"+C).attr("class","legend").attr("transform","translate("+(.8*l/Math.round(u/2)*(C+1)/2+1.5*C*r)+","+k+")")):(w=u>6?k+4*r:k+3*r,a=g.append("g").attr("id","dount-main-group"+C).attr("class","legend").attr("transform","translate("+(.8*l/Math.round(u/2)*f/2+1.5*(f++-1)*r)+","+w+")"));var T=d3.svg.arc().innerRadius(i).outerRadius(r);n=a.selectAll(".arc").data(S(t.data[C].dountData)).enter().append("g").attr("value",function(t,e){return C+" "+e}).attr("fill",function(e,a){return t.data[C].colorArray[a]}).on("mouseover",function(){{var t=d3.select(this).attr("value");t.split(" ")}d3.select(this).transition().duration(500).ease("bounce").attr("transform",function(t){var e=7;t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var a=Math.sin(t.midAngle)*e,n=-Math.cos(t.midAngle)*e;return"translate("+a+","+n+")"})}).on("mousemove",function(){var e=d3.select(this).attr("value"),a=e.split(" ");console.log(t.data[parseInt(a[0])].dountKey[parseInt(a[1])]);var n=[{headingName:t.data[parseInt(a[0])].dountKey[parseInt(a[1])],headingVal:t.data[parseInt(a[0])].dountData[parseInt(a[1])]+" "+t.unit}];X.showToolTip(d3.event,"",t.data[parseInt(a[0])].className,!1,n,.93*d3.event.pageY)}).on("mouseout",function(){d3.select(".ShowArc").attr("display","none"),d3.select(this).transition().duration(500).ease("linear").attr("transform","translate(0,0)")}).on("mouseleave",function(){X.hideTooTip()}),n.append("path").attr("d",T).transition().duration(1500).attrTween("d",e),a.append("text").attr("x",-(6*t.data[C].totalStudent.length)/2).attr("y",3).attr("font-family","calibri").text(t.data[C].totalStudent),a.append("text").attr("x",-(6*t.data[C].className.length/2)).attr("y",r+11).attr("font-family","calibri").text(t.data[C].className)}var L=g.append("g").attr("class","legend").attr("transform","translate("+.8*l+","+.3*s+")"),N=L.selectAll("rect").data(t.legend).enter().append("rect").attr("width",p).attr("height",p).attr("x",function(){return.78*-l}).attr("y",function(){return s}).attr("fill",function(e,a){return t.legendColor[a]});N.transition().duration(1500).attr("x",0).attr("y",function(t,e){return 2*e*p});var D=L.selectAll("text").data(t.legend).enter().append("text").attr("x",function(){return.78*-l}).attr("y",function(t,e){return 2*e*p+p/2}).attr("dy",".31em").attr("font-family","calibri").attr("font-size",m).text(function(t){return t});D.transition().duration(1500).attr("x",p+8),L.append("line").attr("x1",-(.75*l*.1)).attr("y1",-p/2).attr("x2",-(.75*l*.1)).attr("y2",2*t.legend.length*p).attr("stroke","lightsteelblue"),c(g),d(g)}},oe={drawHeatMapChart:function(t,e,a){function n(t){E.select(" #img").style("display","block"),E.select("#img").transition().attr("x",v-.09*v).attr("y",B(t.hours))}function r(){E.select("#img").style("display","none")}var i={colorLow:"#F6fdff",colorMed:"#81DCFF",colorHigh:"#0BBCFF",yAxisLabelSpacing:50};if("undefined"!=typeof a)for(var o in a)"undefined"!=typeof a[o]&&(i[o]=a[o]);var l=[],s=e.yAxisValue,u=[],f=(.7*v/s.length,{top:.03*y,right:1/12*v,bottom:.05*y,left:8/60*v}),h=v-i.yAxisLabelSpacing,p=y-.03*y-f.top-f.bottom,x=e.data,m=0;for(var b in x){var A=x[b];u.push(b);for(var M=0;M<A.length;M++){var k={};k.row=m,k.col=M,k.hours=A[M],l.push(k)}m++}var T=d3.min(l,function(t){return t.hours}),L=d3.max(l,function(t){return t.hours}),N=d3.scale.linear().domain([T,(T+L)/2,L]).range([i.colorLow,i.colorMed,i.colorHigh]),D=.8*y/s.length;w=.7*v/m;for(var P=(d3.scale.linear().range([0,h]),d3.scale.linear().range([p,0]),d3.scale.ordinal().domain(d3.range(m)).rangeRoundBands([0,w*m],.05)),_=d3.scale.ordinal().domain(d3.range(s.length)).rangeRoundBands([0,D*s.length],.1),I=d3.svg.axis().scale(P).orient("bottom").ticks(5),V=d3.svg.axis().scale(_).tickFormat(function(t){return s[t]}).orient("left").ticks(5),F=g.append("svg").attr("width",h+f.right/2).attr("height",p+f.top+f.bottom).append("g").attr("transform","translate("+.15*h+","+f.top+")"),O=(F.selectAll("g").data(l,function(t){return t.col+":"+t.row}).enter().append("svg:rect").attr("x",function(t){return t.row*w}).attr("y",function(t){return t.col*D}).attr("width",function(){return w}).attr("height",function(){return D}).style("fill",function(t){return N(t.hours)}).on("mouseover",function(t){d3.select(this).style("fill","cyan");var e=d3.event.pageX;n(t,e)}).on("mouseout",function(){d3.select(this).style("fill",function(t){return N(t.hours)}),r()}),F.selectAll("g").data(l,function(t){return t.col+":"+t.row}).enter().append("svg:text").attr("x",function(t){return t.row*w}).attr("y",function(t){return t.col*D}).attr("text-anchor","middle").attr("font-family","sans-serif").attr("font-size",function(){return w*D/(2.5*(w+D))}).attr("dy",function(t){return t.row+D/2}).attr("dx",function(t){return t.col+w/2}).text(function(t){return t.hours}).on("mouseover",function(t){var e=d3.event.pageX;n(t,e)}).on("mouseout",function(){r()}),[]),z=0;z<u.length;z++)O.push(z);I.tickValues(O),F.append("g").attr("class","x axis").attr("transform","translate(0,"+D*s.length+")").call(I).selectAll("text").text(function(t){return u[t]}).style("text-anchor","end").attr("dx","-1.0em").attr("dy","0.15em").attr("transform",function(){return"rotate(-45)"}),F.append("g").attr("class","y axis").call(V).selectAll("text").style("text-anchor","end").attr("dx","-0.0em").attr("dy","0.0em").attr("transform",function(){return"rotate(0)"});var G={top:20,right:20,bottom:30,left:8},R=(v-G.left-G.right,y-G.top-G.bottom),E=g.append("svg").attr("width",v-G.left+G.right).attr("height",R+G.top+G.bottom).append("g"),Y=E.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1","0%").attr("y1",_(0)).attr("x2","0%").attr("y2",_(s.length-1)).attr("gradientUnits","userSpaceOnUse");Y.append("svg:stop").attr("offset","0%").attr("stop-color",N(T)).attr("stop-opacity",1),Y.append("svg:stop").attr("offset","20%").attr("stop-color",N(10)).attr("stop-opacity",1),Y.append("svg:stop").attr("offset","40%").attr("stop-color",N(20)).attr("stop-opacity",1),Y.append("svg:stop").attr("offset","60%").attr("stop-color",N(30)).attr("stop-opacity",1),Y.append("svg:stop").attr("offset","80%").attr("stop-color",N(40)).attr("stop-opacity",1),Y.append("svg:stop").attr("offset","100%").attr("stop-color",N(L)).attr("stop-opacity",1),E.append("svg:rect").attr("x",v-.05*v).attr("y",f.top).attr("width",3*s.length).attr("height",D*s.length).style("fill","url(#gradient)");var B=(d3.max(l,function(t){return t.hours}),d3.scale.linear().range([D*s.length,0]));S=d3.min(l,function(t){return t.hours}),C=d3.max(l,function(t){return t.hours}),B.domain([C,S]);var J=d3.svg.axis().scale(B).orient("right").ticks(4).tickSize(5,0);E.append("g").attr("class","y axis").call(J).selectAll("text").style("text-anchor","right").attr("x",v-.09*v).attr("y",G.top).attr("dx","0.0em").attr("dy","0.0em").attr("transform",function(){return"rotate(0)"}),E.selectAll("line").style("display","none"),E.append("g").append("svg:image").attr("id","img").attr("xlink:href","http://stocinn.github.io/stocweb/img/pointer.png").attr("width",v/30).attr("height",v/30).style("display","none"),c(g),d(g)}},le={drawScatterPlotChart:function(t,e){function a(t,e,a,l){"circle"==e.shape?n(t,o(e),a,l,e):"square"==e.shape?r(t,o(e),a,l,e):i(t,o(e),a,l,e)}function n(t,e,a,n,r){t.selectAll("."+n+" dot").data(e.coordinates).enter().append("circle").attr("class",n+" dot").on("mousemove",function(t,e){var a=[{headingName:r.name+" "+h,headingVal:t.y}];X.showToolTip(d3.event,t.yVal,p+" "+f[e],!1,a,.95*d3.event.pageY)}).on("mouseout",function(){X.hideTooTip()}).attr("cx",function(){return 0}).attr("cy",function(){return 0}).transition().duration(1e3).attr("cx",function(t,e){return T(e)-2.5}).attr("cy",function(t){return L(t.y)}).attr("r",function(){return 5}).style("fill",function(t){return t.color})}function r(t,e,a,n,r){t.selectAll("."+n+" dot").data(e.coordinates).enter().append("rect").attr("class",n+" dot").on("mousemove",function(t,e){var a=[{headingName:r.name+" "+h,headingVal:t.y}];X.showToolTip(d3.event,t.yVal,p+" "+f[e],!1,a,.95*d3.event.pageY)}).on("mouseout",function(){X.hideTooTip()}).attr("x",0).attr("width",function(){return 0}).attr("height",function(){return 0}).attr("y",0).transition().duration(2e3).attr("x",function(t,e){return T(e)}).attr("y",function(t){return L(t.y)}).attr("width",10).attr("height",10).attr("fill",function(t){return t.color})}function i(t,e,a,n,r){t.selectAll(n+" dot").data(e.coordinates).enter().append("path").on("mousemove",function(t){var e=[{headingName:r.name+" "+h,headingVal:t.y}];X.showToolTip(d3.event,t.yVal,p+" "+f[H],!1,e,.95*d3.event.pageY)}).on("mouseout",function(){X.hideTooTip()}).attr("class",n+" dot").attr("x",0).attr("width",function(){return 0}).attr("height",function(){return 0}).attr("y",0).transition().duration(2e3).attr("d",d3.svg.symbol().type("triangle-up")).attr("transform",function(t,e){return"translate("+T(e)+","+L(t.y)+")"}).attr("fill",function(t){return t.color})}function o(t){var e={},a=[];for(e.coordinates=a,j=0;j<t.data.length;j++){var n={color:t.color,name:t.name,x:j,y:t.data[j]};e.coordinates.push(n)}return e}var l={padding:e.padding,toolTipLabel:"Population"};v=.9*v,y=.9*y;var s,u,f=e.xAxisTickArray,h=e.yIndicationLabel,p=e.xIndicationLabel,m=e.chartTitle,b=0,A=0,M=e.yAixsData;for(H=0;H<M.length;H++)s=d3.max(M[H].data,function(t){return t}),u=d3.max(M[H].data,function(t){return t}),s>b&&(b=s),u>A&&(A=u),M[H].legendName="legend-"+H;{var w=10,S=0;d3.scale.category20()}b=f.length-1;var C;C=40>.08*v?40:.08*v;var T=d3.scale.linear().domain([0,b]).range([C,v-.05*v]),L=d3.scale.linear().domain([0,1.5*A]).range([y-2*l.padding,l.padding]),N=(d3.scale.linear().domain([10,A]).range([5,10]),d3.format(".1%"),d3.svg.axis().scale(T).orient("bottom").ticks(5)),D=d3.svg.axis().scale(L).orient("left").ticks(5),P=g.append("g").attr("transform","translate("+C+","+S+")");for(U.init(P,y,v,.8*C,S+5,x.gridLineColor),iVal=0;iVal<M.length;iVal++)a(P,M[iVal],M[iVal].color,M[iVal].legendName);for(var _=f[0].toString().length,I=0;I<f.length;I++){var V=f[I].toString().length;V>_&&(_=V)}var F=B.getXTickArray(0,f.length,_,v-2*l.padding-l.padding);N.tickValues(F);var O=P.append("g").attr("class","axis").attr("transform","translate(0,"+(y-l.padding)+")").call(N);O.selectAll("text").text(function(t){return f[t]});for(var z=P.append("g").attr("class","axis").attr("transform","translate("+w+",0)").call(D),E=P.append("g").attr("class","legend").attr("width",v).attr("height",y).attr("transform","translate("+v/10+",50)"),Y=10,J=10,q=[],H=0;H<M.length;H++)q.push(M[H].name);var W=G.getLegendPositionArray(q,.98*v,y);for(k=0;k<M.length;k++)"square"==M[k].shape?(E.selectAll("rect").data([M[k]]).enter().append("rect").attr("x",function(){return W[k].x}).attr("y",function(){return W[k].y}).attr("width",J).attr("height",Y).style("fill",function(t){return t.color}).on("click",function(t){var e=g.selectAll("."+t.legendName+".dot").style("display");if("none"==e)g.selectAll("."+t.legendName+".dot").style("display","block"),g.select(".rectLegend."+t.name).style("text-decoration","none");else{{g.selectAll("."+t.legendName+"line")}g.selectAll("."+t.legendName+".dot").style("display","none"),g.select(".rectLegend."+t.name).style("text-decoration","line-through")}}),E.selectAll(".rectLegend").data([M[k]]).enter().append("text").attr("class",function(t){return"rectLegend "+t.name}).attr("x",function(){return W[k].textPos}).attr("y",W[k].y+Y/2).attr("width",M.length/300*v).attr("height",M.length/300*v).attr("font-size",.02*(v+y)/2).attr("dy",".50em").text(function(t){return t.name})):"circle"==M[k].shape?(E.selectAll("circle").data([M[k]]).enter().append("circle").attr("cx",W[k].x).attr("cy",W[k].y+Y/2).attr("r",function(){return J/2}).style("fill",function(t){return t.color}).on("click",function(t){var e=g.selectAll("."+t.legendName+".dot").style("display");if("none"==e)g.selectAll("."+t.legendName+".dot").style("display","block"),g.select(".circleLegend."+t.name).style("text-decoration","none");else{{g.selectAll("."+t.legendName+"line")}g.selectAll("."+t.legendName+".dot").style("display","none"),g.select(".circleLegend."+t.name).style("text-decoration","line-through")}}),E.selectAll("text1").data([M[k]]).enter().append("text").attr("class",function(t){return"circleLegend "+t.name}).attr("x",function(){return W[k].textPos}).attr("y",W[k].y+Y/2).attr("font-size",.02*(v+y)/2).attr("dy","0.50em").text(function(t){return t.name})):"triangle"==M[k].shape&&(E.selectAll("triangle").data([M[k]]).enter().append("path").attr("x",function(){return W[k].x}).attr("y",W[k].y).attr("d",d3.svg.symbol().type("triangle-up")).attr("transform",function(){return"translate("+W[k].x+","+(W[k].y+Y/2)+")"}).style("fill",function(t){return t.color}).on("click",function(t){var e=g.selectAll("."+t.legendName+".dot").style("display");if("none"==e)g.selectAll("."+t.legendName+".dot").style("display","block"),g.select(".triangleLegend."+t.name).style("text-decoration","none");else{{g.selectAll("."+t.legendName+".line")}g.selectAll("."+t.legendName+".dot").style("display","none"),g.select(".triangleLegend."+t.name).style("text-decoration","line-through")}}),E.selectAll("text2").data([M[k]]).enter().append("text").attr("class",function(t){return"triangleLegend "+t.name}).attr("x",function(){return W[k].textPos}).attr("y",W[k].y+Y/2).attr("font-size",.02*(v+y)/2).attr("dy",".50em").text(function(t){return t.name}));var $=8,Z=h.toString().length*$,K=y/2+Z/2;R.appendLabel(h,.9*-C,K,-90,z,x.yLabelColor,600);var Q=p.toString().length*$,te=v/2-Q/2;R.appendLabel(p,te,.15*y,0,O,x.xLabelColor,600);var $=9,ee=v/1.6-m.length*$/2,ae=g.append("g").attr("class","title");R.appendLabel(m,ee,.06*y,0,ae,x.chartTitleColor,800),c(g),d(g)}},se={drawThreeDBarChart:function(e){var a,r=e.yAxisData,i=e.xAxisData,o=e.yAxisUnit,l=e.yAxisLabel,s=e.xAxisLabel,u=e.title,f=e.barColor,p=e.toolTipUnit,m=Y.leftMarginController(r),b={left:m,right:.05*v,bottom:45,top:.2*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},A=v-b.left-b.right,M=y-b.top-b.bottom,k=t(h).offset().left,w=A/(1.8*i.length);a=w>60?.2*w:.3*w;for(var S=[],C=[],T=12,L="calibri",N=[],D=0;D<i.length;D++)N[D]=D;var P=g.append("g").attr("class","main-group").attr("transform","translate("+b.left+","+b.top+")"),_=7,I=v/2-u.length*_/2,V=g.append("g").attr("class","title");R.appendLabel(u,I,b.top/2,0,V,x.chartTitleColor,800);var _=7,F=l.toString().length*_,O=M/2+F/2,z=-b.left+13;R.appendLabel(l,z,O,-90,P,x.yLabelColor,600);var G=s.toString().length*_,J=M+(b.bottom-5),q=A/2-G/2;R.appendLabel(s,q,J,0,P,x.xLabelColor,600);for(var U=(parseInt(M/w),d3.scale.linear().domain([0,i.length-1]).range([.8*w,A-.8*w])),H=E.getMin(r),j=E.getMax(r),W=d3.scale.linear().domain([H,j]).range([M,0]),$=0,D=0;D<i.length;D++)$<i[D].toString().length&&($=i[D].toString().length);var Z=d3.svg.axis().scale(U).orient("bottom").tickValues(B.getXTickArray(0,i.length,$,A)),K=P.append("g").attr("id","xAxis").attr("class","xAxis").attr("fill","none").attr("transform","translate(0,"+M+")").call(Z);K.selectAll("text").text(function(t){return i[t]});var Q=B.getTickArray(H,j,8),te=d3.svg.axis().scale(W).orient("left").tickValues(Q);P.append("g").attr("id","yAxis").attr("class","yAxis").attr("fill","none").attr("transform","translate(0,0)").call(te).selectAll("text").style("font-size",T).style("font-family",L).attr("fill","black");var ee,ae=d3.svg.line().x(function(t){return t}).y(function(t,e){return C[e]}),ne=d3.svg.line().x(function(t){return t}).y(function(){return M});console.log(r);for(var re=0;re<Q.length;re++){S[0]=0,C[0]=W(Q[re]),S[1]=a,C[1]=W(Q[re])-20,S[2]=A,C[2]=C[1],ee=P.selectAll(".path").data([S]).enter().append("path").attr("d",ae).attr("class","horizontalGridLine").attr("fill","none").attr("stroke",x.gridLineColor);var ie=ee.node().getTotalLength();ee.attr("stroke-dasharray",function(){return ie+","+ie}).attr("stroke-dashoffset",ie).transition().duration(1500).ease("linear").attr("stroke-dashoffset",0)}for(var oe=n(f,-.11),le=n(f,-.1),D=0;D<r.length;D++){S[0]=U(D)-.8*w,C[0]=W(r[D]),S[1]=S[0]+.25*w,C[1]=C[0]-a,S[2]=S[1]+w,C[2]=C[1],S[3]=S[0]+w,C[3]=C[0];var se=P.append("svg:defs").append("svg:linearGradient").attr("id","upperGradient").attr("x1",S[0]).attr("y1",C[0]).attr("x2",S[3]).attr("y2",C[3]).attr("gradientUnits","userSpaceOnUse");se.append("svg:stop").attr("offset","0%").attr("stop-color",n(oe,-.4)).attr("stop-opacity",1),se.append("svg:stop").attr("offset","100%").attr("stop-color",n(oe,.4)).attr("stop-opacity",1),ee=P.selectAll(".path").data([S]).enter().append("path").attr("class","pathClass").attr("d",ne).attr("fill","url(#upperGradient)"),ee.transition().duration(2e3).ease("elastic").attr("d",ae),S[0]=S[3],C[0]=W(H),S[1]=S[3],C[1]=C[3],S[3]=S[3]+.25*w,C[3]=W(H)-a;var ue=P.append("svg:defs").append("svg:linearGradient").attr("id","rightGradient").attr("x1",S[0]).attr("y1",C[0]).attr("x2",S[3]).attr("y2",C[3]+a).attr("gradientUnits","userSpaceOnUse");ue.append("svg:stop").attr("offset","0%").attr("stop-color",n(le,.6)).attr("stop-opacity",1),ue.append("svg:stop").attr("offset","100%").attr("stop-color",n(le,-.4)).attr("stop-opacity",1),ee=P.selectAll(".path").data([S]).enter().append("path").attr("class","pathClass").attr("d",ne).attr("fill","url(#rightGradient)"),ee.transition().duration(2e3).ease("elastic").attr("d",ae),S[0]=U(D)-.8*w,C[0]=W(H),S[1]=S[0],C[1]=W(r[D]),S[2]=S[1]+w,C[2]=C[1],S[3]=S[2],C[3]=C[0];var ce=P.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1",S[0]).attr("y1",C[0]).attr("x2",S[3]).attr("y2",C[3]).attr("gradientUnits","userSpaceOnUse");ce.append("svg:stop").attr("offset","0%").attr("stop-color",n(f,-.4)).attr("stop-opacity",1),ce.append("svg:stop").attr("offset","100%").attr("stop-color",n(f,.4)).attr("stop-opacity",1),ee=P.selectAll(".path").data([S]).enter().append("path").attr("class","pathClass").attr("d",ne).attr("fill","url(#gradient)"),ee.transition().duration(2e3).ease("elastic").attr("d",ae)}d3.selectAll(".pathClass").on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=k+b.left,t=Math.round(U.invert(t));var e=i[t],a=r[t]+" "+o,n=[{headingName:l,headingVal:a}];X.showToolTip(d3.event,"",p+" "+e,!1,n,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}),c(g),d(g)}},ue={drawBasicLineChart:function(t,e){function a(t,e,a){"circle"==e.Shape?n(t,e,a,e.legendName):"square"==e.Shape?r(t,e,a,e.legendName):i(t,e,a,e.legendName)}function n(t,e,a,n){var r=[e.data],i=t.selectAll("svg").data(r).enter().append("g").attr("transform","translate("+w.left+","+w.top+")"),o=i.append("path").attr("class",n+"line "+e.legendName).attr("d",N).attr("fill","none").style("stroke",a).style("stroke-width",p),l=o.node().getTotalLength();o.attr("stroke-dasharray",l+", "+l).attr("stroke-dashoffset",l),o.transition().duration(2e3).attr("stroke-dashoffset",0),i.selectAll("."+n+"dot").data(function(t){return t}).enter().append("circle").attr("xVal",function(t,e){return u[e]}).attr("yVal",function(t){return t}).on("mousemove",function(t,n){d3.select(this).attr("fill","white").attr("stroke",a).attr("stroke-width","3px");var r=[{headingName:e.Name,headingVal:t}];X.showToolTip(d3.event,t.yVal,u[n],!1,r,.95*d3.event.pageY)}).on("mouseout",function(){d3.select(this).attr("fill",a).attr("stroke-width","0px");d3.select(this);X.hideTooTip()}).attr("class",n+"dot circle").attr("x",0).attr("cx",function(){return 0}).attr("cy",function(){return 0}).attr("y",0).transition().duration(2e3).attr("cx",N.x()).attr("cy",N.y()).attr("r",5).attr("fill",a)}function r(t,e,a,n){var r=[e.data],i=t.selectAll("svg").data(r).enter().append("g").attr("transform","translate("+w.left+","+w.top+")"),o=i.append("path").attr("class",function(){return n+"line "+e.legendName}).attr("d",N).attr("fill","none").style("stroke",a).style("stroke-width",p),l=o.node().getTotalLength();o.attr("stroke-dasharray",l+", "+l).attr("stroke-dashoffset",l),o.transition().duration(2e3).attr("stroke-dashoffset",0),i.selectAll("."+n+"dot").data(function(t){return t}).enter().append("rect").attr("xVal",function(t,e){return u[e]}).attr("yVal",function(t){return t}).on("mousemove",function(t,a){d3.select(this).attr("stroke","white").attr("stroke-width","3px");var n=[{headingName:e.Name,headingVal:t}];X.showToolTip(d3.event,t.yVal,u[a],!1,n,.95*d3.event.pageY)}).on("mouseout",function(){d3.select(this).attr("stroke","white").attr("stroke-width","0px"),X.hideTooTip()}).attr("class",n+"dot square").attr("x",0).attr("width",function(){return 0}).attr("height",function(){return 0}).attr("y",0).transition().duration(2e3).attr("x",D.x()).attr("y",D.y()).attr("width",8).attr("height",8).attr("fill",a)}function i(t,e,a,n){var r=[e.data],i=t.selectAll("svg").data(r).enter().append("g").attr("transform","translate("+w.left+","+w.top+")"),o=i.append("path").attr("class",n+"line "+e.legendName).attr("d",N).attr("fill","none").style("stroke",a).style("stroke-width",p),l=o.node().getTotalLength();o.attr("stroke-dasharray",l+", "+l).attr("stroke-dashoffset",l),o.transition().duration(2e3).attr("stroke-dashoffset",0),i.selectAll(n+"dot").data(function(t){return t}).enter().append("path").attr("xVal",function(t,e){return u[e]}).attr("yVal",function(t){return t}).on("mousemove",function(t,a){d3.select(this).attr("stroke","white").attr("stroke-width","2px");var n=[{headingName:e.Name,headingVal:t}];X.showToolTip(d3.event,t.yVal,u[a],!1,n,.95*d3.event.pageY)}).on("mouseout",function(){d3.select(this).attr("stroke","white").attr("stroke-width","0px");d3.select(this);X.hideTooTip()}).attr("class",n+"dot triangle").attr("x",0).attr("width",function(){return 0}).attr("height",function(){return 0}).attr("y",0).transition().duration(2e3).attr("d",d3.svg.symbol().type("triangle-up")).attr("transform",function(t,e){return"translate("+C(e)+","+T(t)+")"}).attr("fill",a)
}var o,l,s={padding:e.padding,yAxisfactor:e.yAxisfactor,yLabelColor:e.yLabelColor,xAxisfactor:e.xAxisfactor,xLabelColor:e.xLabelColor},u=e.xAxisTickArray,f=0,h=999999,p=e.lineStrokeWidth,A=e.yAxisData,M=A[0].data;for(O=0;O<A.length;O++)o=d3.max(A[O].data,function(t,e){return t.xVal=u[e],t.timeIndex=e,t.shape=A[O].shape,t}),l=d3.min(A[O].data),o>f&&(f=o),h>l&&(h=l),A[O].legendName="legend-"+O;0==h?h-=2:h=0>h?1.5*h:.3*h,0==f?f+=2:f=f>0?1.5*f:.7*f;var k=Y.leftMarginController(M),w={top:.025*y,right:40,bottom:45,left:k};v=v-w.left-w.right,y=y-w.top-w.bottom;var S=u.length-1,C=d3.scale.linear().domain([0,S]).range([.02*v,v]),T=d3.scale.linear().domain([h,f]).range([y,0]);b=d3.svg.axis().scale(C).orient("bottom"),m=d3.svg.axis().scale(T).tickValues(B.getTickArray(h,f,6)).orient("left");var L=(s.yAxisfactor,g.append("g").attr("transform","translate(0,0)"));U.init(L,y,v,w.left,w.top,x.gridLineColor);{var N=d3.svg.line().x(function(t,e){return C(e)}).y(function(t){return T(t)}).interpolate("cardinal"),D=d3.svg.line().x(function(t,e){return C(e)-3}).y(function(t){return T(t)-3}).interpolate("cardinal");d3.svg.line().x(function(t,e){return C(e)-3}).y(function(t){return T(t)-3}).interpolate("cardinal"),d3.svg.area().x(N.x()).y1(N.y()).y0(T(0))}for(iVal=0;iVal<A.length;iVal++)a(L,A[iVal],A[iVal].color,A[iVal].Name);for(var P=L.append("g").attr("class","legend").attr("transform","translate("+w.left+",0)"),_=25,I=8,V=1.3*w.top,F=[],O=0;O<A.length;O++)F.push(A[O].Name);for(var z=G.showHorizontalLegend(v,V,F,_,I),E=(P.selectAll(".rect").data(A).enter().append("rect").attr("width",_).attr("height",I).attr("x",function(t,e){return z[e].x}).attr("y",function(t,e){return z[e].y}).attr("rx",4).attr("ry",4).style("fill",function(t){return t.color}).on("click",function(t){var e=g.selectAll("."+t.legendName+"dot").style("display");if("none"==e){var a=g.selectAll("."+t.legendName+"line");a.transition().duration(1e3).ease("linear").attr("stroke-dashoffset",0),g.selectAll("."+t.legendName+"dot."+t.Shape).style("display","block"),console.log(t.legendName+"dot"+t.Shape),g.select("#"+t.legendName+"text").style("text-decoration","none")}else{var a=g.selectAll("."+t.legendName+"line"),n=a.node().getTotalLength();a.transition().duration(1e3).ease("linear").attr("stroke-dashoffset",n),g.selectAll("."+t.legendName+"dot."+t.Shape).style("display","none"),console.log(t.legendName+"dot"+t.Shape),g.select("#"+t.legendName+"text").style("text-decoration","line-through")}}),P.selectAll(".text").data(A).enter().append("text").attr("id",function(t){return t.legendName+"text"}).attr("x",function(t,e){return z[e].textXPos}).attr("y",function(t,e){return z[e].y+I}).text(function(t){return t.Name}),u[0].toString().length),J=0;J<u.length;J++){var q=u[J].toString().length;q>E&&(E=q)}var H=B.getXTickArray(0,u.length,E,v-.02*v);b.tickValues(H);var j=L.append("g").attr("class","x axis").attr("transform","translate("+w.left+","+(y+w.top)+")").call(b);j.selectAll("text").text(function(t){var e="";return e=u[t]});var W=L.append("g").attr("class","y axis").attr("transform","translate("+w.left+","+w.top+")").call(m),$=y/2+s.yAxisfactor.length/2*5,Z=-w.left+15;R.appendLabel(s.yAxisfactor,Z,$,-90,W,x.yLabelColor,600);var K=w.bottom-5,Q=v/2-s.xAxisfactor.length/2*5;R.appendLabel(s.xAxisfactor,Q,K,0,j,x.xLabelColor,600),c(g),d(g)}},ce={drawStackedAreaChart:function(t,e,a){var n={topMargin:5,rightMargin:30,bottomMargin:0,leftMargin:10,color:d3.scale.category20(),yAxisTootltipLabel:"Cost(in Crores): "};if("undefined"!=typeof a)for(var r in a)"undefined"!=typeof a[r]&&(n[r]=a[r]);var i=e,o={top:20,right:30,bottom:30,left:40};v=v-o.left-o.right,y=y-o.top-o.bottom;var l=d3.scale.ordinal().rangePoints([0,v]),s=d3.scale.linear().range([y,0]),u=d3.scale.category20(),f=d3.svg.axis().scale(l).orient("bottom"),h=d3.svg.axis().scale(s).orient("left"),p=d3.layout.stack().offset("zero").values(function(t){return t.values}).x(function(t){return t}).y(function(t){return t.y}),x=d3.nest().key(function(t){return t.name}),m=d3.svg.area().x(function(t){return l(t.category)}).y0(function(t){return s(t.y0)}).y1(function(t){return s(t.y0+t.y)}),b=g.append("svg").attr("width",v+o.left+o.right).attr("height",y+o.top+o.bottom).append("g").attr("transform","translate("+o.left+","+o.top+")");i.forEach(function(t){t.value=+t.value});var A=p(x.entries(i));l.domain(["Dec","Jan","Feb"]),s.domain([0,d3.max(i,function(t){return t.y0+t.y})]);var M=b.selectAll(".layer").data(A).enter().append("g");M.append("path").attr("class","area").attr("d",function(t){return m(t.values)}).style("fill",function(){return"white"}).on("mousemove",function(t){var e=[{headingName:n.yAxisTootltipLabel+" "+t.values[0].name,headingVal:t.values[0].y}];X.showToolTip(d3.event,"",n.xLabel,!1,e,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}).transition().delay(function(t,e){return 500*e}).ease("back").style("fill",function(t,e){return u(e)}),M.append("g").attr("class","x axis").attr("transform","translate(0,"+y+")").transition().duration(2e3).call(f),M.append("g").attr("class","y axis").transition().duration(2e3).call(h),c(g),d(g)}},de={drawFunnelChart:function(t){function e(t){return t*(Math.PI/180)}for(var a,n,r,i=t.funnelData,o=t.funnelKey,l=t.colorArray,s=t.unit,u=t.label,c={left:.1*v,right:.1*v,bottom:.15*y,top:.1*y,chartSeparator:10,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},f=v-c.left-c.right,h=y-c.top-c.bottom,p=.035*h,x=g.append("g").attr("class","main-group").attr("transform","translate("+c.left+","+c.top+")"),m=d3.svg.line().x(function(t,e){return S[e]}).y(function(t,e){return C[e]}).interpolate("basis-closed"),b=d3.svg.line().x(function(t,e){return S[e]}).y(function(t,e){return C[e]}),A=d3.svg.line().x(function(t,e){return O[e]}).y(function(t,e){return z[e]}),M=d3.svg.line().x(function(t,e){return T[e]}).y(function(t,e){return L[e]}).interpolate("basis-closed"),k=0,w=0,S=[],C=[],T=[],L=[],N=0,D=0;D<o.length;D++)N<o[D].toString().length&&(N=o[D].toString().length);N=5.5*N;for(var P,_=f-N,I=.95*_,V=_/2-I/2,F=0,O=[_/2,_/2,_/2,_/2],z=[h+40,h+40,h+40,h+40],G=0;G<i.length;G++)k+=i[G];for(var R=h+i.length*c.chartSeparator,E=R/(I/2),Y=Math.atan(E)*(180/Math.PI),B=Math.tan(e(Y)),J={},q={},U=0;U<i.length;U++){S=[],C=[],T=[],L=[],w=i[U]/k;var H;H=Math.abs(U!=i.length-1?R*w/B:R*w/2/B),P=2*(_/2-V)+V,S.push(V),S.push(V+H),S.push(P-(S[1]-V)),S.push(P),C.push(F),U!=i.length-1?(C.push(F+h*w),C.push(F+h*w)):(C.push(F+h*w/2),C.push(F+h*w/2)),C.push(F),x.append("linearGradient").attr("id","gradient").attr("gradientUnits","userSpaceOnUse").attr("x1",S[0]).attr("y1",C[0]).attr("x2",S[3]).attr("y2",C[2]).selectAll("stop").data([{offset:"15%",color:l[U]},{offset:"62%",color:"#eaeaea"},{offset:"85%",color:l[U]}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color});var j=x.selectAll(".path").data([O]).enter().append("path").attr("d",A).attr("value",U).attr("stroke-width",1).attr("fill","url(#gradient)").on("mousemove",function(){for(var t=d3.select(this).attr("value"),e=0,a=0;a<i.length;a++)e+=i[a];var n=Math.round(i[t]/e*100),r=[{headingName:u,headingVal:n+" "+s}];X.showToolTip(d3.event,"",o[t],!1,r,.9*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()});j.transition().duration(1e3).ease("linear").attr("d",b(S)),x.append("line").attr("class","horizontalLine").attr("x1",function(){return(S[3]+S[2])/2+5}).attr("y1",function(){return U!=i.length-1?(C[3]+C[2])/2:C[2]}).attr("x2",function(){return _/2+I/2}).attr("y2",function(){return U!=i.length-1?(C[3]+C[2])/2:C[2]}).style("stroke","#a7a7a7");var W=g.append("g").attr("class","legend").attr("transform","translate("+c.left+","+c.top+")");W.append("text").attr("class","text").attr("x",function(){return _/2+I/2+5}).attr("y",function(){return U!=i.length-1?(C[3]+C[2])/2+3:C[2]+3}).text(o[U]).style("font-family","calibri"),V=S[1]+2,F=C[1]+c.chartSeparator,T[0]=S[1],T[2]=S[2],T[1]=(S[1]+S[2])/2,T[3]=T[1];var $=(T[1]-T[0])/2;T[0]=T[0]-$,T[2]=T[2]+$,L[0]=C[1],L[1]=L[0]-p,L[2]=C[1],L[3]=L[0]+p,J[U]=T,q[U]=L,a=S[1],n=C[1],r=S[2]-S[1],S[2]=S[3],S[1]=(S[0]+S[2])/2,S[3]=S[1];var Z=(S[1]-S[0])/2;S[0]=S[0]-Z,S[2]=S[2]+Z,C[1]=C[0]-p,C[2]=C[0],C[3]=C[0]+p;{x.selectAll(".path").data([S]).enter().append("path").attr("d",m).attr("stroke-width",1).attr("fill",function(){return l[U]})}}for(var U=0;U<i.length;U++)if(T=J[U],L=q[U],x.append("linearGradient").attr("id","gradient1").attr("gradientUnits","userSpaceOnUse").attr("x1",T[0]).attr("y1",L[1]).attr("x2",T[2]).attr("y2",L[3]).selectAll("stop").data([{offset:"15%",color:l[U]},{offset:"62%",color:"#eaeaea"},{offset:"85%",color:l[U]}]).enter().append("stop").attr("offset",function(t){return t.offset}).attr("stop-color",function(t){return t.color}),U!=i.length-1){x.selectAll(".path").data([T]).enter().append("path").attr("d",M).attr("stroke-width",0).attr("fill","url(#gradient1)")}x.append("rect").attr("x",a).attr("y",n).attr("width",r).attr("height",R*w/2).attr("fill",l[U-1]),d(g)}},fe={gaugeGraph:function(t){var e=t.data,a=t.colorArray,n=t.meterLabel,r=e[0].valAchieve,i=e[0].totalValue-e[0].valAchieve,o=[r,i],l=t.toolTipMsg,s={left:.002*v,right:.002*v,bottom:.002*y,top:.002*y},u=v-s.left-s.right,f=y-s.top-s.bottom,h=(Math.PI/180,g.append("g").attr("class","main-group").attr("transform","translate("+s.left+","+s.top+")")),p=h.append("g").attr("class","centerArcGroup").attr("transform","translate("+.5*u+","+.85*f+")"),m=h.append("g").attr("class","label").attr("transform","translate("+.5*u+","+.85*f+")"),b=.5*u>.75*f?.75*f:.5*u;b=b;var A=Math.PI,M=-90,w=90;start=-90;for(var S=d3.svg.arc().innerRadius(.5*b).outerRadius(b).startAngle(M*A/180).endAngle(w*A/180),C=(p.append("path").attr("d",S).attr("value",o[0]).attr("fill",function(){return a[1]}).on("mousemove",function(){q.hideTooTip();var t=l,e=d3.select(this).attr("value");q.showToolTip(d3.event,v,t,e,a[1])}).on("mouseleave",function(){q.hideTooTip()}),o[0]+o[1]),T=0,L=0;L<o.length-1;L++){var N=o[L]/C*(w-M);for(anglePartForTransition=N/10,k=0;k<10;k++){var D=d3.svg.arc().innerRadius(.5*b).outerRadius(b).startAngle(start*A/180).endAngle((start+anglePartForTransition)*A/180),P=d3.svg.arc().innerRadius(.5*b).outerRadius(b).startAngle(start*A/180).endAngle(start*A/180),_=p.append("path").attr("d",P).attr("fill",function(){return a[0]}).attr("class","innerArc").attr("value",o[L]).attr("color",a[L]).attr("stroke",a[1]).on("mousemove",function(){q.hideTooTip();var t=l,e=d3.select(this).attr("value");q.showToolTip(d3.event,v,t,e,d3.select(this).attr("color"))}).on("mouseleave",function(){q.hideTooTip()});if(_.transition().duration(100).delay(T).ease("linear").attr("d",D).attr("stroke",a[0]),T+=100,9==k){var I=(N+-90-6)*A/180;if(0>N+-90){center=b-.5*(b-.4*b)+7*o[L].toString().length/2;var V=Math.sin(I)*center,F=-Math.cos(I)*center,O=p.append("g").attr("class","valGroup").attr("transform","translate("+V+","+F+") rotate("+(180*I/Math.PI+90)+")")}else{center=b-.5*(b-.4*b)-7*o[L].toString().length/2;var V=Math.sin(I)*center,F=-Math.cos(I)*center,O=p.append("g").attr("class","valGroup").attr("transform","translate("+V+","+F+") rotate("+(180*I/Math.PI-90)+")")}O.append("text").attr("x",0).attr("y",0).attr("fill",x["font-color"]).text(function(){return 0==L?o[L].toFixed(2):void 0})}start+=anglePartForTransition}m.append("text").attr("x",function(){return-(b-.5*(b-.5*b))-7*n[0].toString().length/2}).attr("y",20).text(n[0]).attr("font-size",14).attr("font-family","calibri").attr("fill",x.legendTextColor),m.append("text").attr("x",function(){return b-.5*(b-.5*b)-7*n[1].toString().length/2}).attr("y",20).text(n[1]).attr("font-size",14).attr("font-family","calibri").attr("fill",x.legendTextColor)}c(g),d(g)}},he=!1,pe={areaChart:function(e){var e=t.extend({color:"url(#gradient123)",axisColor:"blue",data:[],attachBrushEvent:!1,xAxisIndicationLabel:"",yAxisIndicationLabel:"",xFieldName:"",yFieldName:""},e);data=e.data;var a=50;if(d3.select(".resetAreaBtn").empty()){var n=70,r=30,i=d3.select("#"+p).append("div").style("left",.8*v+"px").style("top",.1*y+"px").attr("class","resetAreaBtn").on("mouseover",function(){d3.select(".resetAreaBtn").style("background","#7F7FFF")}).on("mouseout",function(){d3.select(this).style("background","#19a586")}).style("width",n+"px").style("height",r+"px").style("background","#19a586").style("display","inline-block").style("z-index","999").style("position","absolute").style("line-height",r+"px").style("color","#FFFFFF").style("text-align","center").style("border-radius","3px").style("cursor","pointer");i.html("Reset")}if(d3.selectAll(".resetAreaBtn").on("click",function(){M.domain(d3.extent(T,function(t,e){return e})),he=!0,t(h).find("svg g").empty(),t(h).find(".brushedArea").remove(),pe.areaChart({xFieldName:N,yFieldName:D,axisColor:"#222222",attachBrushEvent:!0,title:e.title,xAxisIndicationLabel:e.xAxisIndicationLabel,yAxisIndicationLabel:e.yAxisIndicationLabel,data:T}),K.circleChart({color:"#fff953",r:3,data:T})}),!he){N=e.xFieldName,D=e.yFieldName,T=data,L=e,v=t(h).width()-a,y=t(h).height()-a;{t(h).attr("id")}g=g,M=d3.scale.linear().range([0,v-_.scale]),A=d3.scale.linear().range([y-_.scale,0]);for(var o=[],l=0;l<data.length;l++)o.push(data[l].id);S=E.getMin(o),C=E.getMax(o),M.domain(d3.extent(data,function(t,e){return e})),A.domain([S,C]),b=d3.svg.axis().scale(M).orient("bottom"),m=d3.svg.axis().scale(A).orient("right").ticks(4).tickSize(5,0),g=g.append("g").attr("transform","translate("+_.left+","+_.top+")").attr("class","grouping")}M.range([_.areaLeft,v-_.scale]),data=0==e.data.length?T:e.data;var s=t(h).attr("id"),u=s+"_area",f=d3.svg.area().x(function(t,e){return M(e)}).y0(y-_.scale).y1(function(t){return A(t[D])}),k=g.append("svg:defs").append("svg:linearGradient").attr("id","gradient123").attr("x1","0%").attr("y1",A(C/1.5)).attr("x2","0%").attr("y2",A(S)).attr("gradientUnits","userSpaceOnUse"),w="#5db6e0";k.append("stop").attr("offset","0%").attr("stop-color",w),k.append("stop").attr("offset","0.25").attr("stop-color","#82c8e8"),k.append("stop").attr("offset","0.5").attr("stop-color","#9ed4ec"),k.append("stop").attr("offset",".75").attr("stop-color","#c9e7f4"),k.append("stop").attr("offset","100%").attr("stop-color","#f0f8fc");for(var P,I,V=(g.append("path").datum(data).attr("class",u).attr("d",f).attr("fill",e.color).on("mousemove",function(){}).on("mouseleave",function(){try{}catch(t){}}),0),F=[],O=0;O<data.length;O++)F[O]=data[O][N],V<F[O].toString().length&&(V=F[O].toString().length);if(b.tickValues(B.getXTickArray(0,F.length,V,v-_.scale)),0==t(h).find(".axis").length){P=g.append("g").attr("class","x axis").attr("transform","translate(0,"+(y-_.scale+7)+")").attr("fill",e.axisColor).attr("fill","none").call(b),P.selectAll("text").text(function(t){return F[t]}).attr("fill","black"),m.orient("left"),I=g.append("g").attr("class","y axis").attr("transform","translate("+_.areaLeft+",3)").attr("fill",e.axisColor).attr("fill","none").call(m);var z=8,G=(v+a)/2-e.title.length*z/2,Y=g.append("g").attr("class","title");R.appendLabel(e.title,G,.06*y,0,Y,x.chartTitleColor,800);var z=6,J=e.xAxisIndicationLabel.toString().length*z,q=.13*y,X=v/2-J/2;R.appendLabel(e.xAxisIndicationLabel,X,q,0,P,x.xLabelColor,600);var U=e.xAxisIndicationLabel.toString().length*z,H=y/2+U/2,j=-_.areaLeft/1.3;R.appendLabel(e.yAxisIndicationLabel,j,H,-90,I,x.yLabelColor,600)}W.drawBrushing(function(a){he=!0,M.domain(d3.extent(a,function(t,e){return e})),t(h).find("svg .grouping").empty(),t(h).find(".brushedArea").remove(),pe.areaChart({axisColor:"#222222",attachBrushEvent:!0,data:a,xAxisIndicationLabel:e.xAxisIndicationLabel,yAxisIndicationLabel:e.yAxisIndicationLabel,title:e.title}),K.circleChart({color:"#frf953",r:3,data:a})}),c(g),d(g)}},ge={image:"",needle:"",plot:"",arc:"",prevdata:90,text:"",meterChartTest:function(){var t=g,e=v/3,a=e/2;ge.arc=d3.svg.arc().innerRadius(a).outerRadius(e).startAngle(120*(Math.PI/180)).endAngle(240*(Math.PI/180));var n=(t.append("g").attr("class","arc"),t.append("g").attr("transform","translate( "+(v/2-e)+" , "+y/4+")"));ge.image=n.append("svg:image").attr("x",0).attr("y",0).attr("width",2*e).attr("height",a).attr("xlink:href","gauge_skin.jpg").attr("id","fillImage"),ge.text=t.append("svg:text").attr("transform","translate( "+.5112*v+" , "+.878*y+")").attr("text-anchor","middle").text(""),console.log("height of meter: "+y),console.log("width of meter "+v);{var r=a/2;_.top+4}ge.needle=n.append("path").attr("class","tri").attr("d","M"+(r+2)+" 130 L"+r+" 0 L"+(r-3)+" 130 C"+(r-3)+" 140 "+(r+3)+" 140 "+(r+3)+" 130 Z").attr("transform","translate("+(e-a)+","+a+") rotate(-90) ")},turnNeedle:function(t){function e(){return d3.interpolateString("rotate("+a+", 150, 130)","rotate("+n+", 150, 130)")}0>t?ge.text.transition().attr("stroke","red").text(t):ge.text.transition().attr("stroke","green").text(t),ge.needle.transition().duration(1e3).attrTween("transform",e);var a=ge.getAngleFromCoordinate(ge.getCoordinateFromData(ge.prevdata)),n=ge.getAngleFromCoordinate(ge.getCoordinateFromData(ge.getPercentFromAngle(ge.getAngleForProfitAndLoss(t))))},getPercentFromAngle:function(t){return 0>t&&t>=-180?-(5*t/9):5*t/9},getAngleFromCoordinate:function(t){var e=0,a=90;return e+=a*t},getCoordinateFromData:function(t){return coordinate=t/100-(1-t/100),coordinate},getRadianFromData:function(t){return coordinate=t/57.2958,coordinate},callTurnNeedle:function(){var t=100*Math.random();meterChart.turnNeedle(t),meterChart.prevdata=t},getAngleForProfitAndLoss:function(t){var e;return e=t>0&&100>=t?90+.9*t:90+.9*t}},ve={drawThreeDStackedBarChart:function(e,a,r,i,o,l){function s(t,e,a,n,r,i){n=j(0)-j(n);var o=[];if(1==r)for(var l=parseInt(.33*a)+1,s=0;5>s;s++){0==s?e=e:1==s?e-=n:2==s?t+=a:3==s?e+=n:4==s&&(t-=a);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}else if(2==r)for(var l=parseInt(.33*a)+1,s=0;4>s;s++){0==s?e=e:1==s?(t-=l,e-=l):2==s?e-=n:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}else if(3==r)for(var l=parseInt(.33*a)+1,s=0;4>s;s++){0==s?(oe=e+n,e-=n):1==s?(t-=l,e-=l):2==s?t+=a:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}return o}var u={topMargin:5,rightMargin:30,bottomMargin:0,leftMargin:20,color:d3.scale.category20(),toolTipLabelForYAxis:"Profit(in Crores)",axisTextColor:"black",legendTextColor:"black"},f=r.toolTipUnit;if("undefined"!=typeof r)for(var h in r)"undefined"!=typeof r[h]&&(u[h]=r[h]);for(var m=.9*v/(2*a[0].data.length),b=10,A=5,M=a[0].data,k=a[0].data,h=0;h<a.length;h++)M=d3.max(a[h].data)>d3.max(M)?a[h].data:M,k=d3.min(a[h].data)<d3.min(M)?a[h].data:k;for(var w=[],h=0;h<l.length;h++)w[h]=h;{var S=(d3.min(k),d3.max(M),Y.leftMarginController(M)),C={top:.1*y,right:.05*v,bottom:45,left:S};v-C.left-C.right,y-C.top-C.bottom,.3*v/a.length}b=.6*m;var T=v/(2*a[0].data.length);m=T;for(var L=T+b,N=[],D=0,P=[],_={},I=0;I<a.length;I++){var V=d3.max(a[I].data,function(t){return t});D+=V,N.push(V),P.push(a[I].key),_[a[I].key]="legend-"+I}var F=D,O=0,z=(Y.leftMarginController(6*F.toString().length),1);for(I=0;I<(""+F).length-1;I++)z+="0";for(var E=d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear"),J=a[0].data.length*L+m/2,q=d3.scale.linear().domain([0,a[0].data.length]).range([m/1.5,J]),U=0,H=0;H<l.length;H++)U<l[H].toString().length&&(U=l[H].toString().length);{var j=d3.scale.linear().domain([0,1.55*F]).range([y-.15*y,0]),W=d3.svg.axis().scale(q).orient("bottom").tickValues(B.getXTickArray(0,w.length,U,J-m/1.5)),$=d3.svg.axis().scale(j).orient("left").tickSize(0).ticks(6);d3.format("1")}$.tickValues(d3.range(0,1.5*F,1.5*F/10));{var Z;F+100*(""+F).length,j(1.5*F)}Z=400>v?50:.02*J,g=g.append("g").attr("transform","translate(-40,0)"),J+=.1*J;for(var K,Q=v-.89*v,te=g.append("g").attr("transform","translate("+.04*v+",0)"),ee=d3.range(0,1.5*F,1.5*F/10),ae=[],ne=[],re=d3.svg.line().x(function(t){return t}).y(function(t,e){return ne[e]}),h=0;h<ee.length-1;h++){ae[0]=Q-.07*J+20,ne[0]=j(ee[h])-20,ae[1]=Q-.07*J+35,ne[1]=j(ee[h]),ae[2]=v-20,ne[2]=ne[1],K=te.selectAll(".path").data([ae]).enter().append("path").attr("class","groupedBarChartGrid").attr("d",re).attr("fill","none").attr("stroke",x.gridLineColor);var ie=K.node().getTotalLength();K.attr("stroke-dasharray",function(){return ie+","+ie}).attr("stroke-dashoffset",ie).transition().duration(1500).ease("linear").attr("stroke-dashoffset",0)}for(var Q=v-.89*v,oe=(j(0),0),le=a[0].data.length,se=a.length,ue=0;le>ue;ue++){for(var ce=j(0),de=0,fe=0;se>fe;fe++){{var he=a[fe].data;te.append("path").attr("class","lineGraphClass "+_[a[fe].key]).attr("d",E(s(Q+O,ce,m,he[ue],1,he[ue],1))).attr("val",function(){var t=s(Q+O,ce,m,he[ue],1,he[ue],1);return t[0].height}).attr("stroke","grey").attr("fill",i[fe]).attr("xVal",a[fe].key).on("mousemove",function(){var t=[{headingName:u.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];X.showToolTip(d3.event,"",f+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);X.hideTooTip()}).style("display","none"),te.append("path").attr("class","lineGraphClass "+_[a[fe].key]).attr("d",E(s(Q+O,ce,m,he[ue],2,he[ue],1))).attr("val",function(){var t=s(Q+O,ce,m,he[ue],2,he[ue],1);return t[0].height}).attr("stroke","white").attr("fill",function(){return n(i[fe],-.4)}).attr("stroke","grey").attr("xVal",a[fe].key).on("mousemove",function(){var t=[{headingName:u.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];X.showToolTip(d3.event,"",f+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);X.hideTooTip()}).style("display","none"),te.append("path").attr("class","lineGraphClass "+_[a[fe].key]).attr("d",E(s(Q+O,ce,m,he[ue],3,he[ue],1))).attr("val",function(){var t=s(Q+O,ce,m,he[ue],3,he[ue],1);return t[0].height}).attr("stroke","grey").attr("fill",function(){return n(i[fe],-.3)}).attr("xVal",a[fe].key).on("mousemove",function(){var t=[{headingName:u.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];X.showToolTip(d3.event,"",f+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);X.hideTooTip()}).style("display","none")}de+=he[ue],ce=j(de)-A*(fe+1)}O+=L,ce=j(0)}for(var pe=t(".lineGraphClass").hide(),ge=0;ge<pe.length;ge++)t(pe[ge]).slideUp(100*ge).delay(20*ge).fadeIn();c(g);var ve=te.append("g").attr("class","axis").attr("transform","translate("+Q+","+(y-.15*y+j(1.5*F))+")").call(W).attr("fill","none").selectAll("text").attr("fill","black").text(function(t){return l[t]}),ye=g.append("g").attr("class","axis").attr("transform","translate("+.1*v+","+j(1.5*F)+")").call($),xe=6,me=(ye.attr("transform").indexOf("(")+1,ye.attr("transform").indexOf(","),u.yLabel.toString().length*xe),be=y/2+me/2,Ae=.04*-v;R.appendLabel(u.yLabel,Ae+60,be,-90,te,x.yLabelColor,600);var Me=u.xLabel.toString().length*xe,ke=J/2-Me,we=.1*y;R.appendLabel(u.xLabel,ke,we,0,ve,x.xLabelColor,600);var xe=8,Se=v/2-u.title.length*xe/2,Ce=g.append("g").attr("class","title");R.appendLabel(u.title,Se,.05*y,0,Ce,x.chartTitleColor,800);var Te=te.append("g").attr("class","legend").attr("width",v).attr("height",y).attr("transform","translate("+Q+","+.08*y+")"),Le=0,Ne=0;v>300?(Le=12,Ne=12):(Le=10,Ne=10);var De=(d3.max(a,function(t){return t.key.length}),G.getLegendPositionArray(P,v,.25*F));Te.selectAll("rect").data(P).enter().append("rect").attr("value",function(t,e){return e}).attr("class",function(t,e){return"rect"+e}).attr("x",function(t,e){return De[e].x}).attr("y",function(t,e){return De[e].y}).attr("width",Le).attr("height",Ne).style("fill",function(t,e){return i[e]}).on("click",function(e){var a=parseInt(d3.select(this).attr("value")),n=g.selectAll("."+_[e]).style("display");if("none"==n)t("#"+p).find("path."+_[e]).slideUp(400).delay(400).fadeIn(),d3.select(this).style("fill",i[a]),g.selectAll(".legend-text."+_[e]).style("text-decoration","none");else{{g.selectAll("."+_[e])}t("#"+p).find("path."+_[e]).slideDown(400).delay(400).fadeOut(),d3.select(this).style("fill","gray"),g.selectAll(".legend-text."+_[e]).style("text-decoration","line-through")}}),Te.selectAll("text").data(P).enter().append("text").attr("class",function(t){return"legend-text "+_[t]}).attr("x",function(t,e){return De[e].textPos}).attr("y",function(t,e){return De[e].y+Ne}).attr("width",Le).attr("height",Ne).attr("font-size",12).attr("dy",".08em").text(function(t){return t}),d(g)}},ye={globChartAnalysis:function(t){var e=t.data.nodesArray,a=t.data.cordArray,n=t.data.nodesColor,r=t.data.Data,i=(t.data.titleColor,t.data.titleSize,t.data.title),o=t.data.backGroundImage,l=12,s="gray",u=4,c="calibri";g.style("background","url("+o+") no-repeat").style("background-size","100% 100%");for(var f=g.append("g").attr("class","glob-main-group").attr("transform","translate(0,0)"),h=[],p=[],m=0,b=0;b<a.length;b++)for(var A=0;2>A;A++)0==A?h[m]=a[b][A]:p[m++]=a[b][A];var M=8,k=v/2-i.length*M/2,w=g.append("g").attr("class","title");R.appendLabel(i,k,.06*y,0,w,x.chartTitleColor,800);var S=d3.scale.linear().domain([0,100]).range([y,0]),C=d3.svg.axis().scale(S).orient("left"),T=(f.append("g").attr("class","y-axis").attr("transform","translate(30,10)").attr("fill","none").style("display","none").call(C),d3.scale.linear().domain([0,100]).range([0,v-20])),L=d3.svg.axis().scale(T).orient("bottom"),N=(f.append("g").attr("class","x-axis").attr("transform","translate(10,"+(y-30)+")").attr("fill","none").style("display","none").call(L),f.append("g").attr("class","show-nodes").attr("transform","translate(0,0)"));N.selectAll("circle").data(e).enter().append("circle").attr("value",function(t,e){return e}).attr("cx",function(t,e){return T(h[e])}).attr("cy",function(t,e){return S(p[e])}).attr("r",u).attr("fill",function(t,e){return n[e]}).on("mouseover",function(){d3.select(this).attr("r",u+3);var t=d3.select(this).attr("value"),a=e[t];d3.select("#"+a.replace(/ /g,"")).attr("font-size",l+2).attr("fill","black"),d3.selectAll("."+a.replace(/ /g,"")).style("display","none");for(var n,i=0;i<r.length;i++)if(a==r[i].node){n=i;break}for(var o=0;o<r[n].connectedNodes.length;o++){var s=r[n].connectedNodes[o],c=e.indexOf(s);d3.select("#"+s.replace(/ /g,"")).attr("font-size",l+2).attr("fill","black"),d3.select("#"+(a+s).replace(/ /g,"")).attr("font-size",l+1).attr("fill","black");var d=f.append("line").attr("class","dotedLine").attr("x1",function(){return T(h[t])}).attr("y1",function(){return S(p[t])}).attr("x2",function(){return T(h[t])}).attr("y2",function(){return S(p[t])});d.transition().duration(1500).attr("x2",function(){return T(h[c])}).attr("y2",function(){return S(p[c])}).style("stroke","red").style("stroke-dasharray","5, 5")}}).on("mouseout",function(){d3.select(this).attr("r",u);var t=d3.select(this).attr("value"),a=e[t];d3.selectAll("."+a.replace(/ /g,"")).style("display","block"),d3.selectAll(".dotedLine").style("display","none"),d3.select("#"+a.replace(/ /g,"")).attr("font-size",l).attr("fill",s);for(var n,i=0;i<r.length;i++)if(a==r[i].node){n=i;break}for(var o=0;o<r[n].connectedNodes.length;o++){var c=r[n].connectedNodes[o];d3.select("#"+c.replace(/ /g,"")).attr("font-size",l).attr("fill",s),d3.select("#"+(a+c).replace(/ /g,"")).attr("font-size",l-1).attr("fill",s)}});var D=f.append("g").attr("class","show-nodes-text").attr("transform","translate(0,0)");D.selectAll("text").data(e).enter().append("text").attr("id",function(t){return t.replace(/ /g,"")}).attr("x",function(t,e){return T(h[e])-t.length*l/2.5}).attr("y",function(t,e){return S(p[e])-8}).attr("font-size",l).attr("font-family",c).attr("fill",s).text(function(t){return t});for(var P=0;P<r.length;P++)for(var _=r[P].node,I=e.indexOf(_),V=0;V<r[P].connectedNodes.length;V++){var F=r[P].connectedNodes[V],O=e.indexOf(F),z=Math.abs(T(h[O])-T(h[I])),G=Math.abs(S(p[O])-S(p[I])),E=Math.atan2(G,z),Y=E*(180/Math.PI);f.append("text").attr("id",(_+F).replace(/ /g,"")).attr("transform","translate("+(T(h[O])+T(h[I]))/2+","+(S(p[O])+S(p[I]))/2+")rotate("+Y+")").attr("font-size",l-1).attr("font-family",c).attr("fill",s).text(r[P].pathTexts[V]);var B=f.append("line").attr("class",_.replace(/ /g,"")).attr("x1",function(){return T(h[I])}).attr("y1",function(){return S(p[I])}).attr("x2",function(){return T(h[I])}).attr("y2",function(){return S(p[I])});B.transition().delay(200).duration(1500).attr("x2",function(){return T(h[O])}).attr("y2",function(){return S(p[O])}).style("stroke",function(){return r[P].pathColor})}d(g)}},xe={treeChart:function(t){function e(t){var a=0;return t.SubRoot&&t.SubRoot.forEach(function(t){var n=e(t);n>a&&(a=n)}),1+a}function a(t){var a=f.nodes(s).reverse(),r=f.links(a);a.forEach(function(t){t.y=t.depth*((v-20)/e(s))});var l=p.selectAll("g.node").data(a,function(t){return t.ids||(t.ids=++u)}),d=l.enter().append("g").attr("class","node legend").attr("transform",function(){return"translate("+t.y0+","+t.x0+")"}).on("click",n);d.append("circle").attr("r",1e-6).style("fill",function(){return o}).style("stroke","lightsteelblue").on("mouseover",function(){d3.select(this).style("stroke-width","2")}).on("mouseleave",function(){d3.select(this).style("stroke-width","1")}),d.append("text").attr("x",function(t){return t._children1||t._children1?-10:10}).attr("dy",".35em").attr("text-anchor",function(t){return t._children1||t._children1?"end":"start"}).text(function(t){return t.Element||t.Element||t.Root}).style("fill-opacity",1e-6);var g=l.transition().duration(c).attr("transform",function(t){return"translate("+t.y+","+t.x+")"});g.select("circle").attr("r",4.5).style("fill",function(){return o}).style("stroke","lightsteelblue"),g.select("text").style("fill-opacity",1);var y=l.exit().transition().duration(c).attr("transform",function(){return"translate("+t.y+","+t.x+")"}).remove();y.select("circle").attr("r",1e-6),y.select("text").style("fill-opacity",1e-6);var x=p.selectAll("path.link").data(r,function(t){return t.target.ids});x.enter().insert("path","g").attr("class","link").attr("d",function(){var e={x:t.x0,y:t.y0};return h({source:e,target:e})}).style("stroke",i).style("fill","none"),x.transition().duration(c).attr("d",h),x.exit().transition().duration(c).attr("d",function(){var e={x:t.x,y:t.y};return h({source:e,target:e})}).remove(),a.forEach(function(t){t.x0=t.x,t.y0=t.y})}function n(t){t.SubRoot?(t._children1=t.SubRoot,t.SubRoot=null):(t.SubRoot=t._children1,t._children1=null),a(t),d(g)}var r=t.data,i=t["link-color"],o=t["node-color"],l={top:.1*y,right:.1*v,bottom:.1*y,left:.1*v};v=v-l.right-l.left,y=y-l.top-l.bottom;var s,u=0,c=750,f=d3.layout.tree().size([y,v]).children(function(t){return t.SubRoot}),h=d3.svg.diagonal().projection(function(t){return[t.y,t.x]}),p=g.append("g").attr("transform","translate("+l.left+","+l.top+")");s=r,s.x0=y/2,s.y0=0,a(s);console.log("Get of depth : "+e(s)),d(g)}},me={areaChartWithNegativeValueAnalysis:function(e){for(var a=e.data.title,n=e.data.yAxisArray,r=e.data.xAxisArray,i=e.data.xAxisLabel,o=e.data.yAxisLabel,l=e.data.midPoint,s=e.data.midPointLabel,u=e.data.conditionArrayAboveMidPoint,f=e.data.conditionArrayBelowMidPoint,p=s.split(" "),m=0,b=0;b<p.length;b++)m<p[b].toString().length&&(m=p[b].toString().length);m=7*m;for(var A=Y.leftMarginController(n),M={left:A,right:m,bottom:45,top:.1*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},k=v-M.left-M.right,w=y-M.top-M.bottom,S=12,C="calibri",T=[],L=0;L<r.length;L++)T[L]=L;U.init(g,w,k,M.left,M.top,x.gridLineColor);var N=t(h).offset().left,D=g.append("g").attr("class","main-group").attr("transform","translate("+M.left+","+M.top+")"),P=7,_=v/2-a.length*P/2,I=g.append("g").attr("class","title");R.appendLabel(a,_,M.top/2,0,I,x.chartTitleColor,800);for(var V=d3.scale.linear().domain([0,r.length-1]).range([0,k]),F=E.getMin(n),O=E.getMax(n),z=d3.scale.linear().domain([F,O]).range([w,0]),G=0,L=0;L<r.length;L++)G<r[L].toString().length&&(G=r[L].toString().length);var J=d3.svg.axis().scale(V).orient("bottom").tickValues(B.getXTickArray(0,r.length,G,k)),q=D.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+w+")").call(J);
q.selectAll("text").text(function(t){return r[t]}).style("font-size",S).attr("font-family",C).attr("fill","black");var P=6,H=i.toString().length*P,j=w+(M.bottom-5),W=k/2-H/2;R.appendLabel(i,W,j,0,D,x.xLabelColor,600);var $=d3.svg.axis().scale(z).orient("left").tickValues(B.getTickArray(F,O,10));D.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("font-size",S).attr("font-family",C).attr("transform","translate(0,0)").call($).selectAll("text").attr("font-size",S).attr("font-family",C).attr("fill","black");var Z=o.toString().length*P,K=w/2+Z/2,Q=-M.left+15;R.appendLabel(o,Q,K,-90,D,x.yLabelColor,600);var p=s.split(" ");p.push(l);for(var te=parseInt(p.length/2),b=0;b<p.length;b++)R.appendLabel(p[b],k+2,z(l)-te*S+b*S,0,D,x.yLabelColor,600);var ee=t.extend({color:"url(#gradientAboveMid)"},ee),ae=[],ne=[];for(b in u)for(key in u[b])ae.push(key),ne.push(u[b][key]);var re=(D.append("svg:defs").append("svg:linearGradient").attr("id","gradientAboveMid").attr("x1","0%").attr("y1",z(l)).attr("x2","0%").attr("y2",z(O)).attr("gradientUnits","userSpaceOnUse").selectAll("stop").data(ae).enter().append("stop").attr("offset",function(t){return""+(t-l)/O*100+"%"}).attr("stop-color",function(t,e){return ne[e]}),t.extend({color:"url(#gradientBelowMid)"},re)),ie=[],oe=[];for(b in f)for(key in f[b])ie.push(key),oe.push(f[b][key]);for(var le=(D.append("svg:defs").append("svg:linearGradient").attr("id","gradientBelowMid").attr("x1","0%").attr("y1",z(F)).attr("x2","0%").attr("y2",z(l)).attr("gradientUnits","userSpaceOnUse").attr("gradientUnits","userSpaceOnUse").selectAll("stop").data(ie).enter().append("stop").attr("offset",function(t){return""+(l-t)/(l-F)*100+"%"}).attr("stop-color",function(t,e){return oe[oe.length-1-e]}),[]),se=0,ue=1,ce=-1,de=-1,b=0;b<n.length;b++){if(le=[],n[b]>=l){ue=1,le.push(l);for(var fe=b;fe<n.length;fe++){if(n[fe]<l){le.push(l);break}le.push(n[fe])}2==le.length&&b==n.length-1&&(le=[],le.push(l),le.push(n[n.length-1]),le.push(l))}else{ue=0,le.push(l);for(var fe=b;fe<n.length;fe++){if(n[fe]>=l){le.push(l);break}le.push(n[fe])}2==le.length&&b==n.length-1&&(le=[],le.push(l),le.push(n[n.length-1]))}ce=b,0==ce&&le.splice(0,1),fe==n.length&&(de=0),b=fe-1;var he=d3.svg.area().x(function(){return 0}).y0(z(l)).y1(function(t,e){return z(le[e])}).interpolate("cardinal"),pe=D.append("path").datum(le).attr("class","spyCloseprice").attr("d",he(le)).on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=N+M.left,t=Math.round(V.invert(t));var e=r[t],a=n[t],l=i+" "+e,s=[{headingName:o,headingVal:a}];X.showToolTip(d3.event,"",l,!1,s,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}),ge=d3.svg.area().x(function(t,e){return 0==ce?(ce=1,V(se++)):0==de&&e==le.length-1?(de=1,V(se)):V(0==e?se-.5:e==le.length-1?se-.5:T[se++])}).y0(z(l)).y1(function(t,e){return z(le[e])}).interpolate("cardinal");pe.transition().duration(2e3).attr("d",ge(le)).attr("fill",function(){return 1==ue?ee.color:re.color})}var ve=D.selectAll("circle").data(T).enter().append("circle").attr("cx",function(){return 0}).attr("cy",function(){return 0}).attr("r",4).attr("fill",function(t,e){return n[e]>l?ne[ne.length-1]:oe[oe.length-1]});ve.transition().duration(2e3).attr("cx",function(t,e){return V(T[e])}).attr("cy",function(t,e){return z(n[e])}),c(g),d(g)}},be={areaChartWithVaryColorAnalysis:function(e){for(var a=e.data.title,n=e.data.yAxisArray,r=e.data.xAxisArray,i=e.data.xAxisLabel,o=e.data.yAxisLabel,l=e.data.midPoint,s=e.data.midPointLabel,u=s.split(" "),f=0,p=0;p<u.length;p++)f<u[p].toString().length&&(f=u[p].toString().length);f=7*f;for(var m=Y.leftMarginController(n),b={left:m,right:f,bottom:45,top:.1*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},A=v-b.left-b.right,M=y-b.top-b.bottom,k=14,w="calibri",S=[],C=0;C<r.length;C++)S[C]=C;U.init(g,M,A,b.left,b.top,x.gridLineColor);var T=t(h).offset().left,L=g.append("g").attr("class","main-group").attr("transform","translate("+b.left+","+b.top+")"),N=7,D=v/2-a.length*N/2,P=g.append("g").attr("class","title");R.appendLabel(a,D,b.top/2,0,P,x.chartTitleColor,800);for(var _=d3.scale.linear().domain([0,r.length-1]).range([0,A]),I=E.getMin(n),V=E.getMax(n),F=d3.scale.linear().domain([I,V]).range([M,0]),O=0,C=0;C<r.length;C++)O<r[C].toString().length&&(O=r[C].toString().length);var z=d3.svg.axis().scale(_).orient("bottom").tickValues(B.getXTickArray(0,r.length,O,A)),G=L.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+M+")").call(z);G.selectAll("text").text(function(t){return r[t]}).style("font-size",k).attr("font-family",w);var N=6,J=i.toString().length*N,q=M+(b.bottom-5),H=A/2-J/2;R.appendLabel(i,H,q,0,L,x.xLabelColor,600);var j=d3.svg.axis().scale(F).orient("left").tickValues(B.getTickArray(I,V,10));L.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("font-size",12).attr("transform","translate(0,0)").call(j).selectAll("text").attr("font-size",k).attr("font-family",w);var W=(o.toString().length*N,-b.left+15);R.appendLabel(o,W,M/1.5,-90,L,x.yLabelColor,600);var u=s.split(" ");u.push(l);for(var $=parseInt(u.length/2),p=0;p<u.length;p++)R.appendLabel(u[p],A+2,F(l)-$*k+p*k,0,L,x.yLabelColor,600);for(var Z=[],K=-.5,Q=0,p=0;p<n.length;){Z=[],0==Q?(Q=1,Z.push(n[p]),p+1<n.length&&Z.push((n[p+1]+n[p])/2)):(Q=0,p+1<n.length&&Z.push((n[p+1]+n[p])/2),Z.push(n[p+1]),p++),p=p,K+=.5;var te=d3.svg.area().x(function(t,e){return _(0==e?K:K+.5)}).y0(F(l)).y1(function(t,e){return F(Z[e])});L.append("path").datum(Z).attr("class","spyCloseprice").attr("fill",function(){return 0==Q?"#1abc9c":"#d7dcde"}).attr("d",te(Z)).on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=T+b.left,t=Math.round(_.invert(t));var e=r[t],a=n[t],l=i+" "+e,s=[{headingName:o,headingVal:a}];X.showToolTip(d3.event,"",l,!1,s,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()})}var ee=L.selectAll("circle").data(S).enter().append("circle").attr("cx",function(){return 0}).attr("cy",function(){return 0}).attr("r",4).attr("fill","#47A3FF");ee.transition().duration(2e3).attr("cx",function(t,e){return _(S[e])}).attr("cy",function(t,e){return F(n[e])}),c(g),d(g)}},Ae={comparisonAnalysis:function(e){for(var a=e.data.yAxisEstimateData,n=e.data.yAxisActualData,r=e.data.xAxisData,i=e.data.yAxisUnit,o=e.data.yAxisLabel,l=e.data.xAxisLabel,s=e.data.title,u=(e.data.titleColor,e.data.yAxisEstimateDataUnit),f=e.data.yAxisActualDataUnit,p=Y.leftMarginController(a),m={left:p,right:.05*v,bottom:45,top:.1*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},b=v-m.left-m.right,A=y-m.top-m.bottom,M=b/(1.5*r.length),k=12,w="calibri",S=[],C=0;C<r.length;C++)S[C]=C;U.init(g,A,b,m.left-M/2,m.top,x.gridLineColor);var T=t(h).offset().left,L=g.append("g").attr("class","main-group").attr("transform","translate("+m.left+","+m.top+")"),N=7,D=v/2-s.length*N/2,P=g.append("g").attr("class","title");R.appendLabel(s,D,m.top/2,0,P,x.chartTitleColor,800);var _,I=d3.scale.linear().domain([0,r.length-1]).range([.5*M,b-.5*M]);_=d3.min(a)<d3.min(n)?a:n;var V=E.getMin(_);_=d3.max(a)>d3.max(n)?a:n;for(var F=E.getMax(_),O=d3.scale.linear().domain([V,F]).range([A,0]),z=0,C=0;C<r.length;C++)z<r[C].toString().length&&(z=r[C].toString().length);var G=d3.svg.axis().scale(I).orient("bottom").tickValues(B.getXTickArray(0,r.length,z,b)),J=L.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+A+")").call(G);J.selectAll("text").text(function(t){return r[t]}).style("font-size",k).attr("font-family",w).attr("fill","black");var N=6,q=l.toString().length*N,H=A+(m.bottom-5),j=b/2-q/2;R.appendLabel(l,j,H,0,L,x.xLabelColor,600);var W=d3.svg.axis().scale(O).orient("left").tickValues(B.getTickArray(V,F,8));L.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate(0,0)").call(W).selectAll("text").style("font-size",k).style("font-family",w).attr("fill","black");var $=o.toString().length*N,Z=A/2+$/2,K=-m.left+15;R.appendLabel(o,K,Z,-90,L,x.yLabelColor,600);var Q=L.selectAll(".rect").data(a).enter().append("rect").attr("width",M).attr("height",0).attr("x",function(t,e){return I(e)-M/2}).attr("y",A).attr("fill","#000000").attr("opacity",.2).on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=T+m.left,t=Math.round(I.invert(t));var e=r[t],l=a[t]+" "+i,s=n[t]+" "+i,c=[{headingName:u+" "+o,headingVal:l},{headingName:f+" "+o,headingVal:s}];X.showToolTip(d3.event,"",e,!1,c,.9*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()});Q.transition().duration(1500).attr("height",function(t){return O(V)-O(t)}).attr("y",function(t){return O(t)});var te=L.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad");te.append("svg:stop").attr("offset","0%").attr("stop-color","#bfefee").attr("stop-opacity",1),te.append("svg:stop").attr("offset","50%").attr("stop-color","#79d1cf").attr("stop-opacity",1),te.append("svg:stop").attr("offset","100%").attr("stop-color","#bfefee").attr("stop-opacity",1);var ee=b/(3*r.length),ae=L.selectAll(".rect").data(n).enter().append("rect").attr("width",ee).attr("height",0).attr("x",function(t,e){return I(e)-ee/2}).attr("y",A).attr("fill","url(#gradient)").on("mouseover",function(){d3.select(this).attr("fill","#3e9ad9")}).on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=T+m.left,t=Math.round(I.invert(t));var e=r[t],l=a[t]+" "+i,s=n[t]+" "+i,c=[{headingName:u+" "+o,headingVal:l},{headingName:f+" "+o,headingVal:s}];X.showToolTip(d3.event,"",e,!1,c,.9*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip(),d3.select(this).attr("fill","url(#gradient)")});ae.transition().duration(1500).attr("height",function(t){return O(V)-O(t)}).attr("y",function(t){return O(t)}),c(g),d(g)}},Me={musicSpikesAnalysis:function(e){for(var a=e.data.title,n=(e.data.titleColor,e.data.yAxisData),r=e.data.xAxisData,i=e.data.yAxisLabel,o=e.data.xAxisLabel,l=e.data.yAxisUnit,s=Y.leftMarginController(n),u={left:s,right:.05*v,bottom:45,top:.1*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},f=v-u.left-u.right,p=y-u.top-u.bottom,m=f/(2*n.length),b=12,A="calibri",M=[],k=0;k<r.length;k++)M[k]=k;var w=t(h).offset().left,S=g.append("g").attr("class","main-group").attr("transform","translate("+u.left+","+u.top+")").on("mouseover",function(){{var t=d3.event.pageX;d3.event.pageY}if(t-=w+u.left,t=Math.round(N.invert(t)),t>=0&&t<r.length){var e=r[t],a=n[t]+" "+l,o=[{headingName:i,headingVal:a}];X.showToolTip(d3.event,"",e,!1,o,.9*d3.event.pageY)}}).on("mouseleave",function(){X.hideTooTip()}),C=8,T=v/2-a.length*C/2,L=g.append("g").attr("class","title");R.appendLabel(a,T,u.top/2,0,L,x.chartTitleColor,800);for(var N=d3.scale.linear().domain([0,r.length-1]).range([.5*m,f-.5*m]),D=E.getMin(n),P=E.getMax(n),_=d3.scale.linear().domain([D,P]).range([p,0]),I=0,k=0;k<r.length;k++)I<r[k].toString().length&&(I=r[k].toString().length);var V=d3.svg.axis().scale(N).orient("bottom").tickValues(B.getXTickArray(0,r.length,I,f)),F=S.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+p+")").call(V);F.selectAll("text").text(function(t){return r[t]}).style("font-size",b).attr("font-family",A).attr("fill","black");var C=6,O=o.toString().length*C,z=p+(u.bottom-5),G=f/2-O/2;R.appendLabel(o,G,z,0,S,x.xLabelColor,600);var J=d3.svg.axis().scale(_).orient("left").tickValues(B.getTickArray(D,P,10));S.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate(0,0)").call(J).selectAll("text").style("font-size",b).style("font-family",A).attr("fill","black");var q=i.toString().length*C,U=p/2+q/2,H=-u.left+15;R.appendLabel(i,H,U,-90,S,x.yLabelColor,600);for(var m=f/(2*n.length),j=[],W=0;W<n.length;W++){var $=_(.5*d3.min(n))-_(n[W]);$=Math.round($/7);for(var Z=0;$>Z;Z++)j.push(0==Z?"newRectangle":"oldRectangle")}var K=-1,Q=-1,te=0,ee=-1,ae=0,ne=S.selectAll("rect").data(j).enter().append("rect").attr("x",function(t){return"newRectangle"==t&&K++,N(K)-m/2}).attr("y",function(){return p}).attr("width",m).attr("height",function(){return 4}).attr("fill",function(t){"newRectangle"==t&&(ae=0,ee++);var e=_.invert(_(n[ee])+7*ae++);return e<.33*d3.max(n)?"#1fb5ad":e<.66*d3.max(n)?"#5cb85c":"#ff7878"});ne.transition().duration(1e3).attr("y",function(t){return"newRectangle"==t&&(te=0,Q++),_(n[Q])+7*te++}),c(g),d(g)}},ke={drawThreeDGroupedBarChart:function(e,a,r,i){function o(t,e,a,n,r,i){n=z(0)-z(n);var o=[];if(1==r)for(var l=parseInt(.33*a)+1,s=0;5>s;s++){0==s?e=z(0):1==s?e-=n:2==s?t+=a:3==s?e+=n:4==s&&(t-=a);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}else if(2==r){var l=parseInt(.33*a)+1;e=z(e);for(var s=0;4>s;s++){0==s?e=z(0):1==s?(t-=l,e-=l):2==s?e-=n:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}}else if(3==r)for(var l=parseInt(.33*a)+1,s=0;4>s;s++){0==s?e=z(0)-n:1==s?(t-=l,e-=l):2==s?t+=a:3==s&&(t+=l,e+=l);var u=e,c=t;o.push(JSON.parse('{"x":'+c+',"y":'+u+',"height":'+i+"}"))}return o}var l={topMargin:5,rightMargin:30,bottomMargin:0,leftMargin:10,colorArray:[],toolTipLabelForYAxis:"Profit(in Crores)"};if("undefined"!=typeof i)for(var s in i)"undefined"!=typeof i[s]&&(l[s]=i[s]);var u,c=i.lagendArray,f=d3.max(a)>d3.max(r)?a:r,p=d3.min(a)<d3.min(r)?a:r,m=Y.leftMarginController(f),u={top:.1*y,right:.05*v,bottom:45,left:m},b=i.xAxisTickArray,A=v-u.left-u.right,M=y-u.top-u.bottom,w=.9*v/(2*a.length),S=.9*v/(1.5*(a.length+r.length)),C=d3.max(a,function(t){return t}),T=d3.max(r,function(t){return t}),L=C>T?C:T,N=E.getMin(p),D=E.getMax(f),P=S,_=1;for(k=0;k<(""+L).length-1;k++)_+="0";{var I=d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("linear"),V=(a.length+r.length)*S+w*r.length,F=v-.9*v,O=d3.scale.linear().domain([0,a.length-1]).range([1.5*S,A-.5*S]),z=d3.scale.linear().domain([N,D]).range([M,0]),J=d3.svg.axis().scale(O).orient("bottom"),q=B.getTickArray(N,D,8),U=d3.svg.axis().scale(z).orient("left").tickValues(q);L+100*(""+L).length,z(D)}g=g.append("g").attr("transform","translate("+u.left+","+u.top+")"),V+=.15*V;for(var H,j=z(D),W=g,$=[],Z=[],K=d3.svg.line().x(function(t){return t}).y(function(t,e){return Z[e]}),s=1;s<q.length;s++){$[0]=0,Z[0]=z(q[s]),$[1]=15,Z[1]=z(q[s])+15,$[2]=A,Z[2]=Z[1],H=g.selectAll(".path").data([$]).enter().append("path").attr("class","groupedBarChartGrid").attr("d",K).attr("fill","none").attr("stroke",x.gridLineColor);var Q=H.node().getTotalLength();H.attr("stroke-dasharray",function(){return Q+","+Q}).attr("stroke-dashoffset",Q).transition().duration(1500).ease("linear").attr("stroke-dashoffset",0)}for(var j=y-.9*y,te=(i.colorArray,0);te<a.length;te++){W.append("path").attr("class","threeDGroupedBarChart "+te).attr("d",I(o(O(te),j,S,r[te],1,r[te]))).attr("val",function(){var t=o(O(te),j,S,r[te],1,r[te]);return t[0].height}).attr("xVal",b[te]).attr("fill","white").on("mousemove",function(){var t=[{headingName:l.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];X.showToolTip(d3.event,"",i.xLabel+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);X.hideTooTip()}).attr("fill",function(){return n(l.barColorArray[0],.1)}),W.append("path").attr("class","threeDGroupedBarChart "+te).attr("d",I(o(O(te),j,S,r[te],2,r[te]))).attr("val",function(){var t=o(O(te),j,S,r[te],2,r[te]);return t[0].height}).attr("xVal",b[te]).attr("fill","white").on("mousemove",function(){var t=[{headingName:l.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];X.showToolTip(d3.event,"",i.xLabel+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);X.hideTooTip()}).attr("fill",function(){return n(l.barColorArray[0],-.2)}),W.append("path").attr("class","threeDGroupedBarChart "+te).attr("d",I(o(O(te),j,S,r[te],3,r[te]))).attr("val",function(){var t=o(O(te),j,S,r[te],3,r[te]);return t[0].height}).attr("xVal",b[te]).attr("fill","white").on("mousemove",function(){var t=[{headingName:l.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];X.showToolTip(d3.event,"",i.xLabel+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);X.hideTooTip()}).attr("fill",function(){return n(l.barColorArray[0],-.4)}),W.append("path").attr("class","threeDGroupedBarChart "+te).attr("d",I(o(O(te)-S,j,S,a[te],1,a[te]))).attr("val",function(){var t=o(O(te)-S,j,S,a[te],1,a[te]);return t[0].height}).attr("xVal",b[te]).attr("fill","white").on("mousemove",function(){var t=[{headingName:l.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];X.showToolTip(d3.event,"",i.xLabel+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);X.hideTooTip()}).attr("fill",function(){return n(l.barColorArray[1],.1)}),W.append("path").attr("class","threeDGroupedBarChart "+te).attr("d",I(o(O(te)-S,j,S,a[te],2,a[te]))).attr("val",function(){var t=o(O(te)-S,j,S,a[te],2,a[te]);return t[0].height}).attr("xVal",b[te]).attr("fill","white").on("mousemove",function(){var t=[{headingName:l.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];X.showToolTip(d3.event,"",i.xLabel+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);X.hideTooTip()}).attr("fill",function(){return n(l.barColorArray[1],-.2)}),W.append("path").attr("class","threeDGroupedBarChart "+te).attr("d",I(o(O(te)-S,j,S,a[te],3,a[te]))).attr("val",function(){var t=o(O(te)-S,j,S,a[te],3,a[te]);return t[0].height}).attr("xVal",b[te]).attr("fill","white").on("mousemove",function(){var t=[{headingName:l.toolTipLabelForYAxis,headingVal:d3.select(this).attr("val")}];X.showToolTip(d3.event,"",i.xLabel+" "+d3.select(this).attr("xVal"),!1,t,.95*d3.event.pageY)}).on("mouseleave",function(){d3.select(this);X.hideTooTip()}).attr("fill",function(){return n(l.barColorArray[1],-.4)})}for(var ee=t(h).find(".threeDGroupedBarChart").hide(),ae=0;ae<ee.length;ae++)t(ee[ae]).slideUp(300*ae).delay(100*ae).fadeIn();for(var ne=0,re=0;re<b.length;re++)ne<b[re].toString().length&&(ne=b[re].toString().length);J.tickValues(B.getXTickArray(0,b.length,ne+1,v-(F+P)));var ie=W.append("g").attr("class","axis").attr("fill","none").attr("transform","translate(0,"+M+")").call(J);ie.selectAll("text").text(function(t){return b[t]});var oe=g.append("g").attr("class","axis").attr("transform","translate(0,0)").call(U);oe.selectAll("line").style("display","none"),oe.selectAll("path").style("display","none");var le=(oe.attr("transform").indexOf("(")+1,oe.attr("transform").indexOf(","),6),se=l.yLabel.toString().length*le,ue=M/2+se/2,ce=-u.left+15;R.appendLabel(l.yLabel,ce,ue,-90,g,x.yLabelColor,600);var de=l.xLabel.toString().length*le,fe=M+(u.bottom-5),he=A/2-de/2;R.appendLabel(l.xLabel,he,fe,0,g,x.xLabelColor,600);var le=8,pe=A/2-l.title.length*le/2,ge=g.append("g").attr("class","title");R.appendLabel(l.title,pe,.7*-u.top,0,ge,x.chartTitleColor,800);{var ve=1,ye=10,xe=10,me=G.showHorizontalLegend(A,.3*-u.top,c,ye,xe),be=g.append("g").attr("class","legendGroup");be.selectAll(".rect").data(me).enter().append("rect").attr("id","legendRectangle").attr("value",function(t,e){return e}).attr("width",ye).attr("height",xe).attr("x",function(t,e){return me[e].x}).attr("y",function(t,e){return me[e].y}).attr("fill",function(){return l.barColorArray[ve--]}),be.selectAll(".text").data(me).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",function(t,e){return me[e].textXPos}).attr("y",function(t,e){return me[e].y}).text(function(t,e){return c[e]}).attr("dy",".7em").attr("fill",x.legendTextColor)}d(g)}},we={barWithLabelAnalysis:function(e){var a=e.yAxisData,n=e.xAxisData,r=e.colorArray,i=e.averageValue,o=e.unit,l=e.title;yAxisDataUnit=e.yAxisDataUnit;{var s=Y.leftMarginController(a),u={left:s,right:.05*v,bottom:.15*y,top:.1*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},f=v-u.left-u.right,p=y-u.top-u.bottom,m=10,b=t(h).offset().left;t(h).offset().top}U.init(g,p,f,u.left,u.top,x.gridLineColor);for(var A=f/(2*n.length),M=[],k=0;k<n.length;k++)M[k]=k;var w=g.append("g").attr("class","barMainGroup").attr("transform","translate("+u.left+","+u.top+")"),S=7,C=v/2-l.length*S/2,T=g.append("g").attr("class","title");R.appendLabel(l,C,u.top/2,0,T,x.chartTitleColor,800);var L=d3.scale.linear().domain([0,n.length-1]).range([.5*A,f-.5*A]),N=E.getMin(a),D=E.getMax(a),P=d3.scale.linear().domain([N,D]).range([p,0]),_=d3.svg.axis().scale(P).orient("left"),I=(w.append("g").attr("class","y axis").attr("transform","translate(-15,0)").attr("fill","none").call(_).selectAll("text").attr("fill","black"),w.selectAll(".rect").data(a).enter().append("rect").attr("width",A).attr("height",0).attr("x",function(t,e){return L(e)-A/2}).attr("y",P(i)).attr("fill",function(t,e){return r[e]}).on("mousemove",function(t){{var e=d3.event.pageX;d3.event.pageY}e-=b+u.left,e=Math.round(L.invert(e));var a;a=t>i?"+"+t+" "+o:t+" "+o;var r=n[e],l=[{headingName:yAxisDataUnit,headingVal:a}];X.showToolTip(d3.event,"",r,!1,l,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}));I.transition().duration(1500).attr("height",function(t){return t>i?P(i)-P(t):P(t)-P(i)}).attr("y",function(t){return P(t>i?t:i)});{var V=(w.selectAll(".text").data(a).enter().append("text").attr("x",function(t,e){var a="+"+t+" "+o,n=7*a.length;return L(e)-n/2}).attr("y",function(t){return t>i?P(t)-5:P(t)+15}).attr("fill","white").text(function(t){return t>i?"+"+t+" "+o:t+" "+o}),g.append("g").attr("class","legend").attr("transform","translate("+u.left+","+u.top+")")),F=p+.02*p,O=G.showHorizontalLegend(f,F,n,m,m);V.selectAll(".rect").data(O).enter().append("rect").attr("width",m).attr("height",m).attr("x",function(t,e){return O[e].x}).attr("y",function(t,e){return O[e].y}).attr("fill",function(t,e){return r[e]}),V.selectAll(".text").data(O).enter().append("text").attr("x",function(t,e){return O[e].textXPos}).attr("y",function(t,e){return O[e].y+m}).attr("font-family","calibri").text(function(t,e){return n[e]})}d(g),c()}},Se={logoChart:function(e){function a(t,e,a){var n=e.append("g").attr("class",""+t.profileImageName).attr("transform","translate(0,0)"),r=t.y+.5,i=t.x+.5,o=t.arcRadius,s=1.2*t.arcRadius,u=t.imageFrameColor,d=t.profileImageName,h=t.imageWidth,g=t.imageHeight,v=n.append("defs").attr("id","imgdefs"),y=v.append("pattern").attr("id","imagePattern").attr("height",1).attr("width",1).attr("viewBox","0 0 "+h+" "+g).attr("preserveAspectRatio","none");if(y.append("image").attr("preserveAspectRatio","none").attr("height",g).attr("width",h).attr("xlink:href",d),n.append("circle").attr("r",o).attr("value",a).attr("transform",function(){return"translate("+M(i)+","+A(r)+")"}).attr("stroke",u).attr("stroke-width",w).attr("fill","url(#imagePattern)").on("mousemove",function(){var t,e=d3.select(this).attr("value"),n=p[e]+"("+m[e]+")";t=l[e]>0?"+"+l[e]+" "+k:l[e]+" "+k,headingName=l[a]>0?c[2]:c[3];var r=[{headingName:headingName,headingVal:t}];X.showToolTip(d3.event,"",n,!1,r,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}),l[a]>0)var x=M(i)-(s+o)/2,S=A(r)-2.2*(s-o),C=M(i)-((s+o)/2-1.5*(s-o)),T=A(r),L=M(i)-((s+o)/2+1.5*(s-o)),N=A(r);else var x=M(i)+(s+o)/2,S=A(r)+2.2*(s-o),C=M(i)+((s+o)/2-1.5*(s-o)),T=A(r),L=M(i)+((s+o)/2+1.5*(s-o)),N=A(r);var D=n.append("polygon").attr("class","triangle-value-indicator").style("stroke","white").style("stroke-width",2).style("fill",function(){return l[a]>=0?f[2]:f[3]}).attr("points",function(){return l[a]>=0?""+x+","+(A(r-.5)-15)+","+C+","+A(r-.5)+","+L+","+A(r-.5):""+x+","+(A(r+.5)+15)+","+C+","+A(r+.5)+","+L+","+A(r+.5)});D.transition().duration(2e3).attr("points",""+x+","+S+","+C+","+T+","+L+","+N);var P=t.text.toString(),_=8,I=8;P=P+" "+k;var V=M(i)-P.length/2*_,F=A(r)+s+I;n.append("text").attr("x",V).attr("y",F).attr("dx",".2em").attr("dy",".25em").attr("text-anchor","start").attr("fill",function(){return l[a]>0?b[0]:b[1]}).text(function(){return l[a]>0?"+"+P:P})}v=.98*t(h).width(),y=.98*t(h).height();var n={left:.05*v,right:.05*v,bottom:.1*y,top:.05*y,chartSeparator:5},r=v-n.left-n.right,i=y-n.top-n.bottom,o=e.title,l=e.textArray,s=e.imageArray,u=e.imageFrameColor,c=e.legendArray,f=e.legendImageArray,p=e.nameArray,m=e.classArray,b=e.textColor,k=e.unit,w=e.circleStrokeWidth,S=3,C=Math.ceil(s.length/S),T=8,L=v/2-o.length*T/2,N=g.append("g").attr("class","title");R.appendLabel(o,L,n.top,0,N,x.chartTitleColor,800);var D=g.append("g").attr("transform","translate("+n.left+","+n.top+")");M=d3.scale.linear().range([0,r-n.right]);s.length-1;A=d3.scale.linear().range([i-n.top,n.bottom]);var P;P=v>400?4:3,C=s.length>P?P:s.length,S=Math.ceil(s.length/P),A.domain([0,S]),M.domain([0,C]);for(var _=[],I=S-1,V=0,F=0,O=0;O<s.length;O++){F++,console.log("counter "+F+"  "+(F>C)),F>C&&(I--,V=0,F=1);var z={x:V,y:I,index:O};_.push(z),console.log("x "+z.x+"  y"+z.y+" row "+C+" c"+F),V++}var E,Y;E=_[1]?(M(_[1].x)-M(_[0].x))/2:M(_[0].x+.5),Y=S>1?(A(_[P].y)-A(_[0].y))/2:A(_[0].y+.5);var B=0;B=Y>E?E:Y,B=1.1*Math.abs(B);for(var J=B,q=.5*B,O=0;O<_.length;O++)_[O].imageWidth=J,_[O].imageHeight=J,_[O].arcRadius=q,_[O].profileImageName=s[O],_[O].imageFrameColor=u[O],_[O].text=l[O],a(_[O],D,O);var U=g.append("g").attr("class","legend").attr("transform","translate("+n.left+","+n.top+")"),H=5,j=i,W=G.showHorizontalLegend(r,j,c,1.5*H,1.5*H),$=[];$.push(W[0]),$.push(W[1]);U.selectAll(".circle").data($).enter().append("circle").attr("class","legend").attr("r",H).attr("cx",function(t,e){return $[e].x}).attr("cy",function(t,e){return $[e].y}).attr("fill",function(t,e){return f[e]});$=[],$.push(W[2]),$.push(W[3]),U.selectAll(".polygon").data($).enter().append("polygon").attr("class","legend").style("fill",function(t,e){return f[e]}).attr("points",function(t,e){var a=$[e].x,n=$[e].y;return""+(a-2)+","+(n-H/2)+","+(a-9)+","+(n+8)+","+(a+5)+","+(n+8)});U.selectAll(".text").data(W).enter().append("text").attr("x",function(t,e){return W[e].textXPos}).attr("y",function(t,e){return W[e].y+H}).attr("font-family","calibri").attr("font-size","11px","important").text(function(t,e){return c[e]});d(g)}},Ce={multiAxisChartAnalysis:function(e){var a=e.yObject,n=e.xAxisData,r=e.legendColor,i=e.legend,o=e.title,l=e.xAxisLabel,s={left:20,right:.05*v,bottom:45,top:.1*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},u=v-s.left-s.right,c=y-s.top-s.bottom,f=8,p=v/2-o.length*f/2,m=g.append("g").attr("class","title");R.appendLabel(o,p,s.top/2,0,m,x.chartTitleColor,800);var b=t(h).offset().left,A=g.append("g").attr("class","scoredMainGroup").attr("transform","translate("+s.left+","+s.top+")").on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}if(t-=b+s.left,t=Math.round(z.invert(t)),t>=0&&t<n.length){console.log(t);var e=n[t],r=[{headingName:i[0],headingVal:a[0].yAxisData[t]},{headingName:i[1],headingVal:a[0].yAixsAvgData[t]},{headingName:i[2],headingVal:a[1].yAxisData[t]},{headingName:i[3],headingVal:a[1].yAixsAvgData[t]},{headingName:i[4],headingVal:a[2].yAxisData[t]},{headingName:i[5],headingVal:a[2].yAixsAvgData[t]}];X.showToolTip(d3.event,"",e,!1,r,.95*d3.event.pageY)}S.attr("display","block").attr("x1",z(t)).attr("x2",z(t))}).on("mouseleave",function(){S.attr("display","none"),X.hideTooTip()}),f=6,M=l.toString().length*f,k=c+(s.bottom-5),w=u/2-M/2;R.appendLabel(l,w,k,0,A,x.xLabelColor,600);for(var S=A.append("line").attr("y1",s.top).attr("y2",c).attr("stroke","#a7a7a7").attr("display","none"),C=[],T=0,L=u,N=11,D=0,P=0;P<a.length;P++){for(var _=0,I=0;I<a[P].yAxisData.length;I++)_<a[P].yAxisData[I].toString().length&&(_=a[P].yAxisData[I].toString().length),_<a[P].yAixsAvgData[I].toString().length&&(_=a[P].yAixsAvgData[I].toString().length);_*=N;var V;if(V=d3.min(a[P].yAxisData)<d3.min(a[P].yAixsAvgData)?a[P].yAxisData:a[P].yAixsAvgData,yMin=E.getMin(V),V=d3.max(a[P].yAxisData)>d3.max(a[P].yAixsAvgData)?a[P].yAxisData:a[P].yAixsAvgData,yMax=E.getMax(V),C[P]=d3.scale.linear().domain([yMin,yMax]).range([c,0]),P%2==0){T+=_;var F=d3.svg.axis().scale(C[P]).orient("left").tickValues(function(){return 0==D?B.getTickArray(yMin,yMax,6):B.getTickArray(yMin,yMax,5)});A.append("g").attr("class","y axis").attr("transform","translate("+T+",0)").attr("fill","none").style("stroke-width",.3).style("stroke",a[P].yAxisColor).call(F).selectAll("text").attr("fill",a[P].yAxisColor)}else{var F=d3.svg.axis().scale(C[P]).orient("left").tickValues(function(){return 0==D?(D=1,B.getTickArray(yMin,yMax,6)):(D=0,B.getTickArray(yMin,yMax,5))});A.append("g").attr("class","y axis").attr("transform","translate("+L+",0)").attr("fill","none").style("stroke-width",.3).style("stroke",a[P].yAxisColor).call(F).selectAll("text").attr("fill",a[P].yAxisColor),L-=_}}for(var O=[],P=0;P<n.length;P++)O[P]=P;for(var z=d3.scale.linear().domain([0,n.length-1]).range([T,L-.01*L]),_=0,P=0;P<n.length;P++)_<n[P].toString().length&&(_=n[P].toString().length);for(var Y=d3.svg.axis().scale(z).orient("bottom").tickValues(B.getXTickArray(0,n.length,_,L-T)),J=(A.append("g").attr("class","x axis").attr("transform","translate(0,"+(c-5)+")").attr("fill","none").call(Y).selectAll("text").text(function(t){return n[t]}),A.append("g").attr("class","legend").attr("transform","translate("+T+",0)")),q=15,U=3,H=0,j=G.showHorizontalLegend(L-T,H,i,q,q),P=(J.selectAll(".line").data(j).enter().append("line").attr("x1",function(t,e){return j[e].x}).attr("y1",function(t,e){return j[e].y}).attr("x2",function(t,e){return j[e].x+q}).attr("y2",function(t,e){return j[e].y}).attr("stroke",function(t,e){return r[e]}).attr("stroke-width",function(t,e){return e%2==0?U:1.5}).style("stroke-dasharray",function(t,e){return e%2==0?"0, 0":"2, 2"}),J.selectAll(".text").data(j).enter().append("text").attr("x",function(t,e){return j[e].textXPos}).attr("y",function(t,e){return j[e].y+U}).attr("font-family","calibri").text(function(t,e){return i[e]}),0);P<a.length;P++){var W=d3.svg.line().x(function(t,e){return z(O[e])}).y(function(t,e){return C[P](a[P].yAxisData[e])}),$=A.selectAll(".path").data([n]).enter().append("path").attr("d",W).attr("stroke",a[P].yAxisColor).attr("stroke-width",3).attr("fill","none"),Z=$.node().getTotalLength();$.attr("stroke-dasharray",function(){return Z+","+Z}).attr("stroke-dashoffset",Z).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0);var K=d3.svg.line().x(function(t,e){return z(O[e])}).y(function(t,e){return C[P](a[P].yAixsAvgData[e])}),Q=A.selectAll(".path").data([n]).enter().append("path").attr("d",K).attr("stroke",a[P].yAxisColor).attr("stroke-width",1.5).attr("fill","none"),te=Q.node().getTotalLength();Q.attr("stroke-dasharray",function(){for(var t=3,e=2*t,a=t;te>e;)a+=","+t+","+t,e+=2*t;return a+","+te}).attr("stroke-dashoffset",te).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0);var ee=A.selectAll(".circle").data(n).enter().append("circle").attr("cx",0).attr("cy",0).attr("r",3).attr("stroke",a[P].yAxisColor).attr("fill","white");ee.transition().duration(2500).attr("cx",function(t,e){return z(O[e])}).attr("cy",function(t,e){return C[P](a[P].yAxisData[e])});var ae=A.selectAll(".circle").data(n).enter().append("circle").attr("cx",0).attr("cy",0).attr("r",3).attr("stroke",a[P].yAxisColor).attr("fill","white");ae.transition().duration(2500).attr("cx",function(t,e){return z(O[e])}).attr("cy",function(t,e){return C[P](a[P].yAixsAvgData[e])})}d(g)}},Te={threeDPieChartAnalysis:function(t){function e(t,e,a,n){if(t.endAngle-t.startAngle==0)return"M 0 0";var r=e*Math.cos(t.startAngle),i=a*Math.sin(t.startAngle),o=e*Math.cos(t.endAngle),l=a*Math.sin(t.endAngle),s=[];return s.push("M",r,i,"A",e,a,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",o,l,"L",n*o,n*l),s.push("A",n*e,n*a,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",n*r,n*i,"z"),s.join(" ")}function a(t,e,a,n){var r=t.startAngle>Math.PI?Math.PI:t.startAngle,i=t.endAngle>Math.PI?Math.PI:t.endAngle,o=e*Math.cos(r),l=a*Math.sin(r),s=e*Math.cos(i),u=a*Math.sin(i),c=[];
return c.push("M",o,n+l,"A",e,a,"0 0 1",s,n+u,"L",s,u,"A",e,a,"0 0 0",o,l,"z"),c.join(" ")}function n(t,e,a,n,r){var i=t.startAngle<Math.PI?Math.PI:t.startAngle,o=t.endAngle<Math.PI?Math.PI:t.endAngle,l=r*e*Math.cos(i),s=r*a*Math.sin(i),u=r*e*Math.cos(o),c=r*a*Math.sin(o),d=[];return d.push("M",l,s,"A",r*e,r*a,"0 0 1",u,c,"L",u,n+c,"A",r*e,r*a,"0 0 0",l,n+s,"z"),d.join(" ")}function r(t,e){return t.endAngle-t.startAngle>.2?Math.round(h[e]/T*100)+m:""}function i(t){return Math.round(h[t]/T*100)+m}function o(t){var e=d3.interpolate({startAngle:-180*S,endAngle:-180*S},t);return function(t){return n(e(t),N,D,P,_)}}function l(t){var a=d3.interpolate({startAngle:-180*S,endAngle:-180*S},t);return function(t){return e(a(t),N,D,_)}}function s(t){var e=d3.interpolate({startAngle:-180*S,endAngle:-180*S},t);return function(t){return a(e(t),N,D,P)}}var u,c,f,h=t.dountData,p=t.dountKey,x=t.colorArray,m=t.unit,b=t.factor;500>v?(f=5.5,c=10,u={left:60,right:60,bottom:35,top:35,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v}):(f=7,c=12,u={left:.1*v,right:.1*v,bottom:.15*y,top:.1*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v});for(var A=v-u.left-u.right,M=y-u.top-u.bottom,k=g.append("g").attr("class","main-group").attr("transform","translate("+u.left+","+u.top+")"),w=k.append("g").attr("class","dountPie").attr("transform","translate("+A/2+","+M/2+")"),S=Math.PI/180,C=0,T=0,L=0;L<h.length;L++)T+=h[L];var N=A>M?M:A;N=.45*N;var D=.75*N,P=25,_=0,I=d3.layout.pie().sort(null).value(function(t){return t});w.selectAll(".innerSlice").data(I(h)).enter().append("path").attr("class","innerSlice").style("fill",function(t,e){return x[e]}).attr("d",function(t){return n(t,N,D,P,_)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*C,a=Math.sin(t.midAngle)*C;return"translate("+e+","+a+")"}).transition().duration(1500).attrTween("d",o),w.selectAll(".topSlice").data(I(h)).enter().append("g").attr("class","topSlice").style("fill",function(t,e){return x[e]}).style("stroke",function(t,e){return x[e]}).append("path").attr("value",function(t,e){return e}).attr("d",function(t){return e(t,N,D,_)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*C,a=Math.sin(t.midAngle)*C;return"translate("+e+","+a+")"}).on("mouseover",function(){var t=d3.select(this).attr("value"),e=g.select("#text"+t).attr("x");g.select("#text"+t).attr("x",function(){return e>0?e-10+20:e-10}).style("font-weight",600)}).on("mouseout",function(){var t=d3.select(this).attr("value"),e=g.select("#text"+t).attr("x");g.select("#text"+t).attr("x",function(){return e>0?e-10:e-10+20}).style("font-weight","normal")}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=p[t],a=i(t),n=[{headingName:b,headingVal:a}];X.showToolTip(d3.event,"",e,!1,n,.96*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}).transition().duration(1500).attrTween("d",l),w.selectAll(".outerSlice").data(I(h)).enter().append("path").attr("class","outerSlice").style("fill",function(t,e){return x[e]}).attr("d",function(t){return a(t,N,D,P)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*C,a=Math.sin(t.midAngle)*C;return"translate("+e+","+a+")"}).transition().duration(1500).attrTween("d",s),w.selectAll(".percent").data(I(h)).enter().append("text").attr("class","percent").attr("x",function(t){return.6*N*Math.cos(.5*(t.startAngle+t.endAngle))}).attr("y",function(t){return.6*D*Math.sin(.5*(t.startAngle+t.endAngle))}).text(function(t,e){return r(t,e)});for(var V,F,O=d3.svg.line().x(function(t,e){return z[e]}).y(function(t,e){return G[e]}),z=[],G=[],R=0,L=0;L<h.length;L++)V=h[L]/T*360,F=R,R+=V,F=(F+R)/2,z[0]=.98*N*Math.cos(F*(Math.PI/180)),G[0]=.98*D*Math.sin(F*(Math.PI/180)),z[1]=1.2*N*Math.cos(F*(Math.PI/180)),G[1]=1.2*D*Math.sin(F*(Math.PI/180)),z[2]=z[1]+.15*N*Math.cos(F*(Math.PI/180)),G[2]=G[1],w.selectAll(".path").data([z]).enter().append("path").attr("d",O).attr("stroke-width",1).attr("fill","none").attr("stroke",x[L]),w.append("text").attr("id",function(){return"text"+L}).attr("x",function(){return z[2]>0?z[2]:z[2]-p[L].length*f}).attr("y",G[2]+3).attr("fill",x[L]).style("font-size",c+"px").text(function(){return p[L]});d(g)}},Le={threeDPieChartWithLegendAnalysis:function(t){function e(t,e,a,n){if(t.endAngle-t.startAngle==0)return"M 0 0";var r=e*Math.cos(t.startAngle),i=a*Math.sin(t.startAngle),o=e*Math.cos(t.endAngle),l=a*Math.sin(t.endAngle),s=[];return s.push("M",r,i,"A",e,a,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",o,l,"L",n*o,n*l),s.push("A",n*e,n*a,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",n*r,n*i,"z"),s.join(" ")}function a(t,e,a,n){var r=t.startAngle>Math.PI?Math.PI:t.startAngle,i=t.endAngle>Math.PI?Math.PI:t.endAngle,o=e*Math.cos(r),l=a*Math.sin(r),s=e*Math.cos(i),u=a*Math.sin(i),c=[];return c.push("M",o,n+l,"A",e,a,"0 0 1",s,n+u,"L",s,u,"A",e,a,"0 0 0",o,l,"z"),c.join(" ")}function r(t,e,a,n,r){var i=t.startAngle<Math.PI?Math.PI:t.startAngle,o=t.endAngle<Math.PI?Math.PI:t.endAngle,l=r*e*Math.cos(i),s=r*a*Math.sin(i),u=r*e*Math.cos(o),c=r*a*Math.sin(o),d=[];return d.push("M",l,s,"A",r*e,r*a,"0 0 1",u,c,"L",u,n+c,"A",r*e,r*a,"0 0 0",l,n+s,"z"),d.join(" ")}function i(t,e){return t.endAngle-t.startAngle>.2?Math.round(p[e]/C*100)+b:""}function o(t){return Math.round(p[t]/C*100)+b}function l(t){var e=d3.interpolate({startAngle:-180*w,endAngle:-180*w},t);return function(t){return r(e(t),V,F,z,G)}}function s(t){var a=d3.interpolate({startAngle:-180*w,endAngle:-180*w},t);return function(t){return e(a(t),V,F,G)}}function u(t){var e=d3.interpolate({startAngle:-180*w,endAngle:-180*w},t);return function(t){return a(e(t),V,F,z)}}var c,f,h,p=t.dountData,x=t.dountKey,m=t.colorArray,b=t.unit,A=t.factor;500>v?(h=5.5,f=10,c={left:5,right:5,bottom:5,top:5,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v}):(h=7,f=12,c={left:.07*v,right:.07*v,bottom:.05*y,top:.05*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v});for(var M=v-c.left-c.right,k=y-c.top-c.bottom,w=Math.PI/180,S=0,C=0,T=0,L=5,N=10,D=10,P=0;P<p.length;P++)T<x[P].length&&(T=x[P].length),C+=p[P];totalLagendLength=N+L+T*h+5,scaleWidthPie=M-totalLagendLength;var _=g.append("g").attr("class","main-group").attr("transform","translate("+c.left+","+c.top+")"),I=_.append("g").attr("class","dountPie").attr("transform","translate("+scaleWidthPie/2+","+k/2+")").style("webkit-transform","rotateX(0deg)"),V=k/2<scaleWidthPie/2?k/2:scaleWidthPie/2,F=.7*V,O=_.append("g").attr("class","legend").attr("transform","translate("+(scaleWidthPie+3)+",0)"),z=12,G=0,R=d3.layout.pie().sort(null).value(function(t){return t});I.selectAll(".innerSlice").data(R(p)).enter().append("path").attr("class","innerSlice").style("fill",function(t,e){return m[e]}).attr("d",function(t){return r(t,V,F,z,G)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*S,a=Math.sin(t.midAngle)*S;return"translate("+e+","+a+")"}).transition().duration(1500).attrTween("d",l),I.selectAll(".topSlice").data(R(p)).enter().append("g").attr("class","topSlice").style("fill",function(t,e){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var a=I.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("spreadMethod","pad").attr("x1",0).attr("y1",0).attr("x2",V*Math.cos(t.midAngle)).attr("y2",F*Math.sin(t.midAngle)).attr("gradientUnits","userSpaceOnUse").attr("gradientTransform","rotate(0)");return a.append("stop").attr("offset","0").attr("stop-color",function(){return n(m[e],.5)}),a.append("stop").attr("offset","1").attr("stop-color",function(){return n(m[e],-.2)}),"url(#rectangleGradient"+e+")"}).style("stroke",function(t,e){return m[e]}).append("path").attr("value",function(t,e){return e}).attr("d",function(t){return e(t,V,F,G)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*S,a=Math.sin(t.midAngle)*S;return"translate("+e+","+a+")"}).on("mouseover",function(){d3.select(this).attr("value")}).on("mouseout",function(){d3.select(this).attr("value")}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=x[t],a=o(t),n=[{headingName:A,headingVal:a}];X.showToolTip(d3.event,"",e,!1,n,.96*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}).transition().duration(1500).attrTween("d",s),I.selectAll(".outerSlice").data(R(p)).enter().append("path").attr("class","outerSlice").style("fill",function(t,e){var a=I.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");return a.append("stop").attr("offset","0").attr("stop-color",function(){return n(m[e],.3)}),a.append("stop").attr("offset","1").attr("stop-color",function(){return n(m[e],-.7)}),"url(#rectangleGradient"+e+")"}).attr("d",function(t){return a(t,V,F,z)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*S,a=Math.sin(t.midAngle)*S;return"translate("+e+","+a+")"}).transition().duration(1500).attrTween("d",u),I.selectAll(".percent").data(R(p)).enter().append("text").attr("class","percent").attr("x",function(t){return.6*V*Math.cos(.5*(t.startAngle+t.endAngle))}).attr("y",function(t){return.6*F*Math.sin(.5*(t.startAngle+t.endAngle))}).text(function(t,e){return i(t,e)});for(var E=(d3.svg.line().x(function(t,e){return xCoordinate[e]}).y(function(t,e){return yCoordinate[e]}),0),Y=0;Y<x.length;Y++)O.append("rect").attr("x",0).attr("y",function(){return E}).attr("width",N).attr("height",D).attr("fill",function(){return m[Y]}),O.append("text").attr("x",N+L).attr("y",E).text(function(){return x[Y]}).attr("dy",".7em").style("font-family","calibri").style("font-size",f,"important"),E+=2*D;d(g)}},Ne={threeDDountChartWithLegendAnalysis:function(t){function e(t,e,a,n){if(t.endAngle-t.startAngle==0)return"M 0 0";var r=e*Math.cos(t.startAngle),i=a*Math.sin(t.startAngle),o=e*Math.cos(t.endAngle),l=a*Math.sin(t.endAngle),s=[];return s.push("M",r,i,"A",e,a,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",o,l,"L",n*o,n*l),s.push("A",n*e,n*a,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",n*r,n*i,"z"),s.join(" ")}function a(t,e,a,n){var r=t.startAngle>Math.PI?Math.PI:t.startAngle,i=t.endAngle>Math.PI?Math.PI:t.endAngle,o=e*Math.cos(r),l=a*Math.sin(r),s=e*Math.cos(i),u=a*Math.sin(i),c=[];return c.push("M",o,n+l,"A",e,a,"0 0 1",s,n+u,"L",s,u,"A",e,a,"0 0 0",o,l,"z"),c.join(" ")}function r(t,e,a,n,r){var i=t.startAngle<Math.PI?Math.PI:t.startAngle,o=t.endAngle<Math.PI?Math.PI:t.endAngle,l=r*e*Math.cos(i),s=r*a*Math.sin(i),u=r*e*Math.cos(o),c=r*a*Math.sin(o),d=[];return d.push("M",l,s,"A",r*e,r*a,"0 0 1",u,c,"L",u,n+c,"A",r*e,r*a,"0 0 0",l,n+s,"z"),d.join(" ")}function i(t){return Math.round(h[t]/S*100)+m}function o(t){var e=d3.interpolate({startAngle:-180*k,endAngle:-180*k},t);return function(t){return r(e(t),I,V,O,z)}}function l(t){var a=d3.interpolate({startAngle:-180*k,endAngle:-180*k},t);return function(t){return e(a(t),I,V,z)}}function s(t){var e=d3.interpolate({startAngle:-180*k,endAngle:-180*k},t);return function(t){return a(e(t),I,V,O)}}var u,c,f,h=t.dountData,p=t.dountKey,x=t.colorArray,m=t.unit,b=t.factor;500>v?(f=5.5,c=10,u={left:5,right:5,bottom:5,top:5,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v}):(f=7,c=12,u={left:.07*v,right:.07*v,bottom:.05*y,top:.05*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v});for(var A=v-u.left-u.right,M=y-u.top-u.bottom,k=Math.PI/180,w=0,S=0,C=0,T=5,L=10,N=10,D=0;D<h.length;D++)C<p[D].length&&(C=p[D].length),S+=h[D];totalLagendLength=L+T+C*f+5,scaleWidthPie=A-totalLagendLength;var P=g.append("g").attr("class","main-group").attr("transform","translate("+u.left+","+u.top+")"),_=P.append("g").attr("class","dountPie").attr("transform","translate("+scaleWidthPie/2+","+M/2+")"),I=M/2<scaleWidthPie/2?M/2:scaleWidthPie/2,V=.7*I,F=P.append("g").attr("class","legend").attr("transform","translate("+(scaleWidthPie+5)+",0)"),O=12,z=.6,G=d3.layout.pie().sort(null).value(function(t){return t});_.selectAll(".innerSlice").data(G(h)).enter().append("path").attr("class","innerSlice").style("fill",function(t,e){var a=_.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");return a.append("stop").attr("offset","0").attr("stop-color",function(){return n(x[e],.3)}),a.append("stop").attr("offset","1").attr("stop-color",function(){return n(x[e],-.3)}),"url(#rectangleGradient"+e+")"}).attr("d",function(t){return r(t,I,V,O,z)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*w,a=Math.sin(t.midAngle)*w;return"translate("+e+","+a+")"}).transition().duration(1500).attrTween("d",o),_.selectAll(".topSlice").data(G(h)).enter().append("g").attr("class","topSlice").style("fill",function(t,e){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var a=_.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("spreadMethod","pad").attr("x1",0).attr("y1",0).attr("x2",I*Math.cos(t.midAngle)).attr("y2",V*Math.sin(t.midAngle)).attr("gradientUnits","userSpaceOnUse").attr("gradientTransform","rotate(0)");return a.append("stop").attr("offset","0").attr("stop-color",function(){return n(x[e],.5)}),a.append("stop").attr("offset","1").attr("stop-color",function(){return n(x[e],-.5)}),"url(#rectangleGradient"+e+")"}).style("stroke",function(t,e){return x[e]}).append("path").attr("value",function(t,e){return e}).attr("d",function(t){return e(t,I,V,z)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*w,a=Math.sin(t.midAngle)*w;return"translate("+e+","+a+")"}).on("mouseover",function(){var t=d3.select(this).attr("value"),e=d3.select("#text"+t).attr("x");g.select("#text"+t).attr("x",function(){return e>0?e-10+20:e-10}).style("font-weight",600)}).on("mouseout",function(){var t=d3.select(this).attr("value"),e=d3.select("#text"+t).attr("x");g.select("#text"+t).attr("x",function(){return e>0?e-10:e-10+20}).style("font-weight","normal")}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=p[t],a=i(t),n=[{headingName:b,headingVal:a}];X.showToolTip(d3.event,"",e,!1,n,.96*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}).transition().duration(1500).attrTween("d",l),_.selectAll(".outerSlice").data(G(h)).enter().append("path").attr("class","outerSlice").style("fill",function(t,e){var a=_.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");return a.append("stop").attr("offset","0").attr("stop-color",function(){return n(x[e],.3)}),a.append("stop").attr("offset","1").attr("stop-color",function(){return n(x[e],-.7)}),"url(#rectangleGradient"+e+")"}).attr("d",function(t){return a(t,I,V,O)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*w,a=Math.sin(t.midAngle)*w;return"translate("+e+","+a+")"}).transition().duration(1500).attrTween("d",s);for(var R=(d3.svg.line().x(function(t,e){return xCoordinate[e]}).y(function(t,e){return yCoordinate[e]}),0),E=0;E<p.length;E++)F.append("rect").attr("x",0).attr("y",function(){return R}).attr("width",L).attr("height",N).attr("fill",function(){return x[E]}),F.append("text").attr("x",L+T).attr("y",R).text(function(){return p[E]}).attr("dy",".7em").style("font-family","calibri").style("font-size",c,"important"),R+=2*N;d(g)}},De={drillDownDountChartAnalysis:function(t){function e(t,e,n){var r=[],i=[];u[u.length-1]!=t&&u.push(t);for(var o in t)r.push(t[o].data),i.push(t[o].color);a(t,r,i,e,n)}function a(a,r,o,u,c){function f(t){var e=d3.interpolate({startAngle:-180*y,endAngle:-180*y},t);return function(t){return m(e(t))}}var h=[],p=[],v=0;g.select("#donutGroup").remove(),g.select("#arcGroup").remove();var y=Math.PI/180,x=d.append("g").attr("id","donutGroup").attr("transform","translate("+.5*l+","+.5*s+")"),m=d3.svg.arc().innerRadius(u).outerRadius(c),b=d3.layout.pie().value(function(t){return t}),A=x.selectAll(".arc").data(b(r)).enter().append("g").attr("class",function(t,e){h[v]=t.startAngle,p[v]=t.endAngle,v++;var n=0;for(var r in a){if(e==n)return r;n++}}).attr("keyname",function(t,e){var n=0;for(var r in a){if(e==n)return a[r].data;n++}}).on("click",function(){var t=d3.select(this).attr("class");for(var n in a)for(var r in a[n].key)n==t&&(g.select("#arcGroup").remove(),e(a[n].key,u,c))}).on("mousemove",function(){var e=d3.select(this).attr("class"),a=d3.select(this).attr("keyname"),n=[{headingName:t.factor,headingVal:a+t.unit}];X.showToolTip(d3.event,"",e,!1,n,.9*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()});A.append("path").attr("d",m).style("fill",function(t,e){return o[e]}).transition().duration(2e3).attrTween("d",f);var M=0;g.select("#arcGroup").remove();for(var k in a){var w=[],S=[];for(var C in a[k].key)w.push(a[k].key[C].data),S.push(a[k].key[C].color);w.length>0&&n(a[k].key,c,3*i,h[M],p[M],w,S),M++}}function n(e,a,n,r,i,o,u){function c(t){for(var e=0,a=0;a<t.length;a++)e+=t[a];return e}for(var f=(Math.PI/180,r),h=d.append("g").attr("id","arcGroup").attr("transform","translate("+.5*l+","+.5*s+")"),p=(d3.layout.pie().value(function(t){return t}),c(o)),g=0;g<o.length;g++){var v=o[g]/p*(i-r),y=d3.svg.arc().innerRadius(a).outerRadius(n).startAngle(f).endAngle(f+v),x=d3.svg.arc().innerRadius(a).outerRadius(n).startAngle(f).endAngle(f),m=h.append("path").attr("d",x).attr("fill",function(){return u[g]}).attr("class",function(){var t=0;for(var a in e){if(g==t)return a;t++}}).attr("keyname",function(){var t=0;for(var a in e){if(g==t)return e[a].data;t++}}).on("mousemove",function(){var e=d3.select(this).attr("class"),a=d3.select(this).attr("keyname"),n=[{headingName:t.factor,headingVal:a+t.unit}];X.showToolTip(d3.event,"",e,!1,n,.9*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()});m.transition().duration(1e3).attr("d",y),f+=v}}var r,i,o,l,s,u=[],c={leftMargin:.1*v,rightMargin:.1*v,bottomMargin:.1*y,topMargin:.1*y};l=v-c.leftMargin-c.rightMargin,s=y-c.topMargin-c.bottomMargin;var d;d=g.append("g").attr("id","mainGroup").attr("transform","translate("+c.leftMargin+","+c.topMargin+")");g.append("g").attr("id","resetGroup").attr("transform","translate("+c.leftMargin+","+c.topMargin+")");s>l?(i=l/6,r=2*i):(i=s/6,r=2*i),o=i,u.push(t);var f=g.append("g").attr("id","imageGroup").attr("transform","translate("+(c.leftMargin+.5*l)+","+(c.topMargin+.5*s)+")");f.append("svg:image").attr("xlink:href","img/per.png").attr("x",-i/3).attr("y",-i/3).attr("width",2*i/3).attr("height",2*i/3).on("click",function(){u.length>2&&(g.select("#donutGroup").remove(),g.select("#arcGroup").remove(),g.select("#mainGroup").remove(),d=g.append("g").attr("id","mainGroup").attr("transform","translate("+c.leftMargin+","+c.topMargin+")"),u.pop(),e(u[u.length-1],o,r))}),e(t.key,o,r)}},Pe={treeMapChartAnalysis:function(t,e){var a={left:.05*v,right:.05*v,bottom:.1*y,top:.05*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},r=v-a.left-a.right,i=y-a.top-a.bottom,o=g.append("g").attr("class","main-group").attr("transform","translate("+a.left+","+a.top+")"),l=o.append("g").attr("class","legend").attr("transform","translate("+.1*r+","+(i+10)+")"),s=d3.min(t.children,function(t){return t.size}),u=d3.max(t.children,function(t){return t.size}),c=d3.scale.linear().domain([s,u]).range([0,.78*r]),f=d3.scale.linear().domain([s,(s+u)/2,u]).range([e.colorLow,e.colorMed,e.colorHigh]),h=d3.layout.treemap().size([r,i]).sticky(!0).value(function(t){return t.size}),p=o.datum(t).selectAll(".rect").data(h.nodes).enter().append("rect").attr("class","treeMapNode").attr("value",function(t){return t.size}).attr("id",function(t){return t.portfolioId}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",0).attr("height",0).attr("fill",function(t,e){if("tree"==t.name)return"none";var a=o.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+e).attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");return a.append("stop").attr("offset","0").attr("stop-color",function(){return n(f(t.size),-.2)}),a.append("stop").attr("offset",".05").attr("stop-color",function(){return n(f(t.size),.2)}),a.append("stop").attr("offset",".95").attr("stop-color",function(){return n(f(t.size),.2)}),a.append("stop").attr("offset","1").attr("stop-color",function(){return n(f(t.size),-.2)}),"url(#rectangleGradient"+e+")"}).on("mousemove",function(e){var a=parseInt(d3.select(this).attr("value"));g.select(".gradientRepresentIcon").attr("display","block").transition().duration(1e3).attr("x",c(a));var n=[{headingName:t.factor,headingVal:e.size+t.unit}],r=e.name;X.showToolTip(d3.event,"",r,!1,n,.95*d3.event.pageY)}).on("mouseleave",function(){g.select(".gradientRepresentIcon").attr("display","none"),X.hideTooTip()});p.transition().duration(2e3).attr("width",function(t){return Math.max(0,t.dx-1)}).attr("height",function(t){return Math.max(0,t.dy-1)});var x=o.datum(t).selectAll(".text").data(h.nodes).enter().append("text").attr("x",function(t){return t.x+3}).attr("y",function(t){var e=Math.min(16,.1*Math.sqrt(t.area));return t.y+2*e}).attr("fill","black").style("font-size",function(t){return console.log(.18*Math.max(0,t.dx-1)+"           "+t.name),parseInt(Math.min(14,.18*Math.max(0,t.dx-1)))+"px"}).text("");x.transition().delay(1500).text(function(t){return 0==t.size?"":t.children?null:t.name});var m=(s+u)/2,b=[];b.push(s);var A=(s+m)/2;b.push(A),b.push(m);var A=(u+m)/2;b.push(A),b.push(u);var M=[],k=t.range[0],w=t.range[1],S=(k+w)/2;M.push(k+"%"),M.push(.5*(S+k)+"%"),M.push(S+"%"),M.push(.5*(S+w)+"%"),M.push(w+"%");var C=.8*r,T=.2*a.bottom,L=l.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1",0).attr("y1",0).attr("x2",.8*r).attr("y2",T).attr("gradientUnits","userSpaceOnUse");L.append("svg:stop").attr("offset","0%").attr("stop-color",f(b[0])).attr("stop-opacity",1),L.append("svg:stop").attr("offset","25%").attr("stop-color",f(b[1])).attr("stop-opacity",1),L.append("svg:stop").attr("offset","50%").attr("stop-color",f(b[2])).attr("stop-opacity",1),L.append("svg:stop").attr("offset","75%").attr("stop-color",f(b[3])).attr("stop-opacity",1),L.append("svg:stop").attr("offset","100%").attr("stop-color",f(b[4])).attr("stop-opacity",1),l.append("rect").attr("width",.8*r).attr("height",T).style("fill","url(#gradient)"),l.selectAll(".text").data(M).enter().append("text").attr("x",function(t,e){var a=3.5*t.toString().length;return.25*e*C-a}).attr("y",function(){return T}).attr("dy",function(){return"1em"}).attr("width",C).attr("height",T).attr("fill","black").text(function(t){return t}),l.append("svg:image").attr("class","gradientRepresentIcon").attr("xlink:href",function(){return"arrow-up.png"}).attr("y",T).attr("width",15).attr("height",15).attr("display","none"),d(g)}},_e={activeAreaChartAnalysis:function(e){var a=e.yAxisData,n=e.xAxisData,r=e.xAxisLabel,i=e.yAxisLabel,o=e.title,l=e.lineStrokeColor,s=e.areaColor,u=t(h).offset().left,f=(t(h).offset().top,Y.leftMarginController(a),{left:Y.leftMarginController(a),right:.1*v,bottom:45,top:.1*y}),p=v-f.left-f.right,m=y-f.top-f.bottom,b=[],A=0,M=p/(1.5*n.length);U.init(g,m,p+f.left,f.left-M/2,f.top,x.gridLineColor);for(var k=g.append("g").attr("class","mainGroup").attr("transform","translate("+f.left+","+f.top+")"),w=E.getMin(a),S=E.getMax(a),C=0;C<e.xAxisData.length;C++)b[C]=C,A<n[C].toString().length&&(A=n[C].toString().length);var T=d3.scale.linear().domain([0,b.length-1]).range([2,p]),L=d3.scale.linear().domain([w,S]).range([m,0]),N=d3.svg.axis().scale(T).orient("bottom").tickValues(B.getXTickArray(0,b.length,A,p)),D=d3.svg.axis().scale(L).orient("left").ticks(6),P=(k.append("g").attr("class","xAxisGroup").attr("transform","translate(0,"+m+")").attr("fill","none").call(N).selectAll("text").attr("fill","black").text(function(t){return n[t]}),k.append("g").attr("class","yAxisGroup").attr("transform","translate(0,0)").call(D).attr("fill","none").selectAll("text").attr("fill","black"),d3.svg.line().x(function(t,e){return T(e)}).y(function(t){return L(t)}).interpolate("cardinal")),_=k.append("path").attr("d",P(a)).attr("class","lineGraph").attr("stroke",l).attr("stroke-width",4).attr("fill","none"),I=_.node().getTotalLength();_.attr("stroke-dasharray",function(){return I+","+I}).attr("stroke-dashoffset",I).transition().duration(1e3).ease("linear").attr("stroke-dashoffset",0);var V=d3.svg.area().interpolate("cardinal").x(function(t){return T(t)}).y0(m).y1(function(t,e){return L(a[e])}),F=d3.svg.area().interpolate("cardinal").x(function(t,e){return T(e)}).y0(m).y1(function(){return m}),O=k.append("path").attr("d",F(b)).attr("id","areaChart").attr("stroke-width",2).attr("fill",s).style("opacity",.3).attr("display","block");O.transition().delay(600).duration(1e3).attr("d",V(b)),O.on("mousemove",function(){var t=n[Math.round(T.invert(d3.event.pageX-u-f.left))],e=[{headingName:i,headingVal:a[Math.round(T.invert(d3.event.pageX-u-f.left))]}];X.showToolTip(d3.event,"",t,!1,e,.9*d3.event.pageY)}).on("mouseout",function(){X.hideTooTip()}).on("mouseleave",function(){X.hideTooTip()});var z=4,G=k.selectAll(".circle").data(a).enter().append("circle").attr("cx",0).attr("cy",0).attr("r",z).attr("fill",l);G.transition().delay(600).duration(1e3).attr("cx",function(t,e){return T(e)}).attr("cy",function(t){return L(t)}),G.on("mouseover",function(){var t=d3.select(this).attr("cy"),e=d3.select(this).attr("cx"),a=(k.append("circle").attr("id","outerCircle").attr("cx",e).attr("cy",t).attr("r",z+3).attr("fill","none").attr("stroke-width",2).attr("stroke",l),n[Math.round(T.invert(d3.event.pageX-u))]),r=[{headingName:i,headingVal:Math.round(L.invert(t))}];X.showToolTip(d3.event,"",a,!1,r,.9*d3.event.pageY)}).on("mouseout",function(){d3.select("#outerCircle").remove(),X.hideTooTip()}).on("mouseleave",function(){X.hideTooTip()});var J=g.append("g").attr("class","label").attr("transform","translate(0,"+(f.top+m)+")"),q=6,H=r.toString().length*q,j=f.bottom-5,W=v/2-H/2;R.appendLabel(r,W,j,0,J,x.xLabelColor,600);var $=g.append("g").attr("class","label"),Z=e.yAxisLabel.toString().length*q,K=y/2+Z/2,Q=10;R.appendLabel(e.yAxisLabel,Q,K,-90,$,x.xLabelColor,600);var te=v/2-o.length*q/2,ee=g.append("g").attr("class","title");R.appendLabel(o,te,f.top/2,0,ee,x.xLabelColor,800),c(g),d(g)}},Ie={smoothLineChartAnalysis:function(e){function a(t,a){H+=300;var n=T.append("path").attr("d",U(t)).attr("class","lineGraph").attr("stroke",function(){return 1==a?e.lineColor[0]:e.lineColor[1]}).attr("stroke-width",2).attr("fill","none"),r=n.node().getTotalLength();n.attr("stroke-dasharray",function(){return r+","+r}).attr("stroke-dashoffset",r).transition().delay(H).duration(300).ease("linear").attr("stroke-dashoffset",0)}for(var n=e.average,r=[],i=[],o=0,l=[],s=0,u=[],f=[],p=e.yAxisData,m=e.xAxisData,b=e.title,A={leftMargin:Y.leftMarginController(p),rightMargin:.1*v,bottomMargin:45,topMargin:.15*y},M=v-A.leftMargin-A.rightMargin,k=y-A.topMargin-A.bottomMargin,w=0;w<p.length;w++)o<p[w]&&(o=p[w]);o=o.toString().length+1;var S=t(h).offset().left,C=t(h).offset().top;g.on("mousemove",function(){d3.select(".lineMove").remove(),d3.select(".lineDiv").remove(),d3.select(".lineDiv1").remove(),d3.select(".divText").remove(),d3.select(".divText2").remove(),d3.select(".rectangle").remove();var t=d3.event.pageY-C,a=7;i[0]=t,i[1]=t-a,i[2]=t-2*a,i[3]=t-2*a,i[4]=t+2*a,i[5]=t+2*a,i[6]=t+a,i[7]=t;var n=10;r[0]=A.leftMargin,r[1]=A.leftMargin-n,r[2]=A.leftMargin-n,r[3]=A.leftMargin-15*o,r[4]=A.leftMargin-15*o,r[5]=A.leftMargin-n,r[6]=A.leftMargin-n,r[7]=A.leftMargin;var l=d3.event.pageX-A.leftMargin-S;if(l=_.invert(l),l>=0&&l<m.length-1&&t>A.topMargin&&t<=A.bottomMargin+k+10){var s=(g.append("line").attr("class","lineMove").attr("x1",A.leftMargin).attr("y1",t-1).attr("x2",M+A.leftMargin).attr("y2",t-1).attr("stroke","black").attr("stroke-width",.5).attr("fill","none"),d3.svg.line().x(function(t,e){return r[e]}).y(function(t){return t}).interpolate("closed"));g.append("path").attr("d",s(i)).attr("class","lineDiv").attr("stroke","black").attr("stroke-width",2).attr("fill","black").style("opacity",.8),g.append("text").attr("x",A.leftMargin-11*o).attr("y",t).text(function(){return Math.round(I.invert(t-A.topMargin))}).attr("class","divText").attr("dy",".4em").attr("fill","white");var c=m[Math.round(_.invert(d3.event.pageX-A.leftMargin-S))];textLength=7*c.length;var d=30,h=10*c.length,p=d3.event.pageX-S,v=k+A.topMargin-5;u[0]=p,u[1]=p-7,u[2]=p-h/2,u[3]=p-h/2,u[4]=p+h/2,u[5]=p+h/2,u[6]=p+7,f[0]=v,f[1]=v+.4*d,f[2]=v+.4*d,f[3]=v+d,f[4]=v+d,f[5]=v+.4*d,f[6]=v+.4*d;var y=d3.svg.line().x(function(t,e){return u[e]}).y(function(t){return t}).interpolate("closed");g.append("path").attr("d",y(f)).attr("class","lineDiv1").attr("stroke","black").attr("stroke-width",2).attr("fill","black").style("opacity",.8),g.append("text").attr("x",d3.event.pageX-textLength/2-S).attr("y",k+A.topMargin+15).text(function(){return c}).attr("class","divText2").attr("dy",".4em").attr("fill","white");var x=m[Math.round(_.invert(d3.event.pageX-A.leftMargin-S))],b=[{headingName:e.yAxisLabel,headingVal:Math.round(I.invert(t-A.topMargin))}];X.showToolTip(d3.event,"",x,!1,b,.9*d3.event.pageY)}else X.hideTooTip()}).on("mouseleave",function(){X.hideTooTip()}).on("mouseout",function(){X.hideTooTip()});for(var T=g.append("g").attr("class","mainGroup").attr("transform","translate("+A.leftMargin+","+A.topMargin+")"),L=E.getMin(p),N=E.getMax(p),D=0;D<e.xAxisData.length;D++)l[D]=D,s<e.xAxisData[D].toString().length&&(s=e.xAxisData[D].toString().length);for(var P,_=d3.scale.linear().domain([0,l.length-1]).range([2,M-2]),I=d3.scale.linear().domain([L,N]).range([k,0]),V=d3.svg.axis().scale(_).tickValues(B.getXTickArray(0,l.length,s,M)),F=d3.svg.axis().scale(I).ticks(10).orient("left"),w=(T.append("g").attr("class","xAxisGroup").attr("transform","translate(0,"+k+")").call(V).attr("fill","none").selectAll("text").attr("fill","black").text(function(t){return e.xAxisData[t]}),T.append("g").attr("class","yAxisGroup").attr("transform","translate(0,0)").call(F).attr("fill","none").selectAll("text").attr("fill","black"),0),O=[],z=[],G=0,J=0,q=0,U=d3.svg.line().x(function(t,e){return _(O[e])}).y(function(t){return I(t)}).interpolate("cardinal"),H=0,j=!1,D=0;D<p.length;D++)if(p[D]<=n){if(p[D]<n){for(var W=D;p[W]<n&&W<p.length;W++)O[q]=W,z[q++]=p[W];D=W}if(p[D]==n&&(O[q]=D,z[q++]=p[W],j=!0),1==j)0!=D&&a(z,!0),O=[],z=[],q=0,O[q]=D,z[q++]=p[D],j=!1;else{if(D==p.length){a(z,!0);break}P=(p[D]-p[D-1])/(D-O[q-1]),temp1=p[D-1]-P*O[q-1],J=n,G=(J-temp1)/P,z[q]=J,O[q]=G,a(z,!0);var $=G;q=0,O=[],z=[],O[q]=$,z[q++]=J,D--}}else{if(p[D]>n){for(var W=D;p[W]>n&&W<p.length;W++)O[q]=W,z[q++]=p[W];D=W}if(p[D]==n&&(O[q]=D,z[q++]=p[W],j=!0),1==j)0!=D&&a(z,!1),O=[],z=[],q=0,O[q]=D,z[q++]=p[D],j=!1;else{if(D==p.length){a(z,!1);break}P=(p[D]-p[D-1])/(D-O[q-1]),temp1=p[D-1]-P*O[q-1],J=n,G=(J-temp1)/P,z[q]=J,O[q]=G,a(z,!1);var $=G;q=0,O=[],z=[],O[q]=$,z[q++]=J,D--}}var Z=3,K=T.selectAll(".circle").data(p).enter().append("circle").attr("cx",0).attr("cy",0).attr("r",Z).style("stroke",e.circleBoundaryColor).attr("fill",function(t){return n>=t?e.lineColor[0]:e.lineColor[1]});K.transition().duration(1500).attr("cx",function(t,e){return _(e)}).attr("cy",function(t){return I(t)}),K.on("mouseover",function(){d3.select(this).attr("r",Z+3)}).on("mouseout",function(){d3.select(this).attr("r",Z)}),T.append("line").attr("x1",0).attr("y1",I(n)).attr("x2",M).attr("y2",I(n)).attr("stroke","black").attr("stroke-width",1).attr("fill","none");var Q=g.append("g").attr("class","label").attr("transform","translate(0,"+(A.topMargin+k)+")"),te=6,ee=e.xAxisLabel.toString().length*te,ae=A.bottomMargin-10,ne=v/2-ee/2;R.appendLabel(e.xAxisLabel,ne,ae,0,Q,x.xLabelColor,600);var re=g.append("g").attr("class","label"),ie=e.yAxisLabel.toString().length*te,oe=y/2+ie/2,le=A.leftMargin/3;
R.appendLabel(e.yAxisLabel,le,oe,-90,re,x.yLabelColor,600);var se=v/2-b.length*te/2,ue=g.append("g").attr("class","title");R.appendLabel(b,se,A.topMargin/2,0,ue,x.chartTitleColor,800),c(g),d(g)}},Ve={LineChartWithReverseYAxisAnalysis:function(t){var e,a,n=t.yAxisData,r=t.xAxisData,i=t.title,o=t.yAxisLabel,l=(t.xAxisLabel,t.lineStrokeWidth),s=t.circleRadius,u=[],u=[],f=0,h=[],p=[];u=n[0].data,a=d3.max(u);for(var m=0;m<n.length;m++)p[m]=n[m].name,a<d3.max(n[m].data)&&(u=n[m].data,a=d3.max(u));yAxisDataMin=n[0].data,e=d3.min(yAxisDataMin);for(var m=0;m<n.length;m++)e>d3.min(n[m].data)&&(yAxisDataMin=n[m].data,e=d3.min(yAxisDataMin));var b={left:Y.leftMarginController(u),right:.05*v,bottom:45,top:.15*y},A=v-b.left-b.right,M=y-b.top-b.bottom;U.init(g,M,A,b.left,b.top,x.gridLineColor);var k=g.append("g").attr("class","mainGroup").attr("transform","translate("+b.left+","+b.top+")");e=E.getMin(yAxisDataMin),a=0==a?a:a>0?1.1*a:.7*a;for(var m=0;m<t.xAxisData.length;m++)h[m]=m,f<t.xAxisData[m].toString().length&&(f=t.xAxisData[m].toString().length);for(var w=d3.scale.linear().domain([0,h.length-1]).range([5,A]),S=d3.scale.linear().domain([e,a]).range([0,M]),C=d3.svg.axis().scale(w).tickValues(B.getXTickArray(0,h.length,f,A)),T=d3.svg.axis().scale(S).orient("left"),L=(k.append("g").attr("class","xAxisGroup").attr("transform","translate(0,"+M+")").call(C).attr("fill","none").selectAll("text").attr("fill","black").text(function(e){return t.xAxisData[e]}),k.append("g").attr("class","yAxisGroup").attr("transform","translate(0,0)").call(T).attr("fill","none").selectAll("text").attr("fill","black"),d3.svg.line().x(function(t,e){return w(e)}).y(function(t){return S(t)}).interpolate("cardinal")),m=0;m<n.length;m++){var N=k.append("path").attr("d",L(n[m].data)).attr("class","lineGraph").attr("id","linePath"+m).attr("stroke",n[m].color).attr("stroke-width",l).attr("fill","none"),D=N.node().getTotalLength();N.attr("stroke-dasharray",D+", "+D).attr("stroke-dashoffset",D),N.transition().duration(2e3).attr("stroke-dashoffset",0);var P=k.selectAll(".circle").data(n[m].data).enter().append("circle").attr("cx",0).attr("cy",0).attr("r",s).attr("fill",n[m].color);P.transition().duration(1500).attr("cx",function(t,e){return w(e)}).attr("cy",function(t){return S(t)}),P.on("mouseover",function(){d3.select(this).attr("r",s+2)}).on("mouseout",function(){d3.select(this).attr("r",s)}).on("mousemove",function(t,e){var a=r[e],n=[{headingName:o,headingVal:t}];X.showToolTip(d3.event,"",a,!1,n,.9*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()})}var I=g.append("g").attr("class","label").attr("transform","translate("+b.left+","+b.top+")"),V=6,F=t.xAxisLabel.toString().length*V,O=M+b.bottom-5,z=A/2-F/2;R.appendLabel(t.xAxisLabel,z,O,0,I,x.xLabelColor,600);var J=t.yAxisLabel.toString().length*V,q=M/2+J/2,H=-b.left+10;R.appendLabel(t.yAxisLabel,H,q,-90,I,x.yLabelColor,600);var j=v/2-i.length*V/2,W=g.append("g").attr("class","title");R.appendLabel(i,j,b.top/2,0,W,x.chartTitleColor,800);{var $=10,Z=10,K=16,Q=G.showHorizontalLegend(A,K,p,$+20,Z),te=g.append("g").attr("class","legendGroup").attr("transform","translate("+_.left+",0)");te.selectAll(".rect").data(Q).enter().append("rect").attr("id","legendRectangle").attr("value",function(t,e){return e}).attr("status",1).attr("width",$).attr("height",Z).attr("x",function(t,e){return Q[e].x}).attr("y",function(t,e){return Q[e].y}).attr("fill",function(t,e){return n[e].color}).on("click",function(){var t=parseInt(d3.select(this).attr("value")),e=g.selectAll("#linePath"+t);console.log(e);var a=e.node().getTotalLength(),r=parseInt(d3.select(this).attr("status"));1==r?(d3.select(this).attr("status",0),d3.select(this).style("fill","grey"),g.select("#legend-text"+t).style("text-decoration","line-through"),e.transition().duration(2e3).attr("stroke-dashoffset",a)):(d3.select(this).attr("status",1),g.select("#legend-text"+t).style("text-decoration","none"),d3.select(this).style("fill",n[t].color),e.transition().duration(2e3).attr("stroke-dashoffset",0))}),te.selectAll(".text").data(Q).enter().append("text").attr("id",function(t,e){return"legend-text"+e}).attr("x",function(t,e){return Q[e].textXPos-20}).attr("y",function(t,e){return Q[e].y}).text(function(t,e){return n[e].name}).attr("dy",".8em").attr("font-family","calibri").attr("fill",x.legendTextColor)}c(g),d(g)}},Fe={horizontalStackedBarChartAnalysis:function(e){for(var a=e.yAxisData,n=e.key,r=e.title,i=(e.xAxisLabel,e.yAxisLabel,t(h).offset().left,t(h).offset().top,[]),o=0,l=0,s=0,u=[],f=0,p=0;p<n.length;p++)D>d3.min(n[p].data)&&(D=d3.min(n[p].data)),P<d3.max(n[p].data)&&(P=d3.max(n[p].data)),u[p]=n[p].name,f<u[p].toString().length&&(f=u[p].toString().length);for(var p=0;p<a.length;p++){s=0;for(var m=0;m<n.length;m++)s+=n[m].data[p];s>l&&(l=s)}for(var m=0;m<a.length;m++)i[m]=m,o<a[m].length&&(o=a[m].length);var b=Y.leftMarginController(a);b=.7*b;var A={leftMargin:b,rightMargin:.05*v,bottomMargin:.2*y,topMargin:.05*y},M=v-A.leftMargin-A.rightMargin,k=y-A.topMargin-A.bottomMargin;U.init(g,k,M,A.leftMargin,A.topMargin,x.gridLineColor);for(var w=k/(2*i.length),S=10,C=10,T=G.showHorizontalLegend(M,k+A.topMargin+.6*A.bottomMargin,u,S+30,C),L=g.append("g").attr("class","legendGroup").attr("transform","translate("+A.leftMargin+",0)"),N=(L.selectAll(".rect").data(T).enter().append("rect").attr("id","legendRectangle").attr("value",function(t,e){return e}).attr("state",1).attr("width",S).attr("height",C).attr("x",function(t,e){return T[e].x}).attr("y",function(t,e){return T[e].y}).attr("fill",function(t,e){return n[e].color}).on("click",function(){var e=parseInt(d3.select(this).attr("value")),a=parseInt(d3.select(this).attr("state"));0==a?(d3.select(this).attr("state",1),d3.select(this).style("fill",n[e].color),g.selectAll("#text"+e).style("text-decoration","none"),t(".rect"+e).fadeToggle(100)):(d3.select(this).attr("state",0),d3.select(this).style("fill","gray"),g.selectAll("#text"+e).style("text-decoration","line-through"),t(".rect"+e).fadeToggle(100))}),L.selectAll(".text").data(T).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",function(t,e){return T[e].textXPos-20}).attr("y",function(t,e){return T[e].y}).text(function(t,e){return n[e].name}).attr("dy",".6em").attr("fill",x.legendTextColor),g.append("g").attr("class","mainGroup").attr("transform","translate("+A.leftMargin+","+A.topMargin+")")),D=d3.min(n[0].data),P=d3.max(n[0].data),_=d3.scale.linear().domain([0,1.2*l]).range([0,M]),I=d3.scale.linear().domain([0,i.length-1]).range([k-w,w]),V=d3.svg.axis().scale(_).tickValues(B.getXTickArray(0,1.2*l,l.toString().length,M)),F=d3.svg.axis().scale(I).orient("left").tickValues(i),O=(N.append("g").attr("class","xAxisGroup").attr("transform","translate(0,"+k+")").call(V).attr("fill","none").selectAll("text").attr("fill","black"),N.append("g").attr("class","yAxisGroup").attr("transform","translate(0,0)").call(F).attr("fill","none").selectAll("text").attr("fill","black").text(function(t){return a[t]}).attr("transform","rotate(-30)"),N.append("line").attr("class","xTickLine").attr("x1",-1).attr("y1",0).attr("x2",-1).attr("y2",k).attr("stroke",x["tick-font-color"]).attr("stroke-width",1),0),p=0;p<=a.length;p++){{N.append("line").attr("class","tickLines").attr("x1",-10).attr("y1",O).attr("x2",-1).attr("y2",O).attr("stroke",x["tick-font-color"]).attr("stroke-width",1)}O+=2*w}for(var w=k/(2*i.length),z=0,E="interpolate",J=[],p=0;p<n.length;p++){p==n.length-1&&(E="bounce");for(var m=0;m<a.length;m++){N.append("rect").attr("class","rect"+p).attr("id","rect"+a[m]).attr("value",p).attr("key",m).attr("x",function(){if(0==p)return J.push(JSON.parse('{"x":0,"width":'+n[p].data[m]+"}")),0;for(var t=0,e=0;p>e;e++)t+=_(n[e].data[m]);return J.push(JSON.parse('{"x":'+t+',"width":'+n[p].data[m]+"}")),t}).attr("y",I(m)-w/2).attr("width",0).attr("height",w).attr("fill",n[p].color).on("mousemove",function(){q.hideTooTip();var t=d3.select(this).attr("value"),e=d3.select(this).attr("key"),a=n[t].name,r=n[t].data[e];q.showToolTip(d3.event,v,a,r,n[t].color);13*t.toString().length}).on("mouseleave",function(){q.hideTooTip()}).transition().duration(500).delay(z).attr("width",function(){return isNaN(_(n[p].data[m]))?0:_(n[p].data[m])})}z+=500}console.log(JSON.stringify(J));var X=g.append("g").attr("class","label").attr("transform","translate("+A.leftMargin+","+A.topMargin+")"),H=6,j=e.xAxisLabel.toString().length*H,W=k+.5*A.bottomMargin,$=M/2-j/2;R.appendLabel(e.xAxisLabel,$,W,0,X,x.xLabelColor,600);var Z=e.yAxisLabel.toString().length*H,K=k/2+Z/2,Q=-A.leftMargin+20;R.appendLabel(e.yAxisLabel,Q,K,-90,X,x.yLabelColor,600);var te=M/2-r.length*H/2;R.appendLabel(r,te,-A.topMargin+15,0,X,x.chartTitleColor,800),c(g),d(g)}},Oe={performanceChartAnalysis:function(t){for(var e=t.data,a=t.differentActivity,r=t.title,i=t.maxValue,o=t.minValue,l=t.lineColor,s=t.yLabel,u=(t.xLabel,t.legendArray),f=t.legendColor,h=[],p=[],m=0;m<e.length;m++)h[m]=e[m].class_name,p[m]=m;var b=Y.leftMarginController(h),A={left:b,right:.05*v,bottom:.05*v,top:.1*y,chartSeparator:5},M=v-A.left-A.right,k=y-A.top-A.bottom,w=g.append("g").attr("class","main-group").attr("transform","translate("+A.left+","+A.top+")"),S=e.length,C=a.length,T=M/C>k/S?k/S:M/C;T=.4*T;var L=11,N=8,D=v/2-r.length*N/2,P=g.append("g").attr("class","title");R.appendLabel(r,D,A.top/2,0,P,x.chartTitleColor,800);var _=s.toString().length*N,I=k/2+_/2,V=-A.left+15;R.appendLabel(s,V,I,-90,w,x.yLabelColor,600);var F=d3.scale.linear().domain([o,i]).range([L,T]),O=d3.scale.linear().domain([0,C-1]).range([T,M-T]),z=d3.scale.linear().domain([0,S-1]).range([k-T,T]),E=w.selectAll(".line").data(h).enter().append("line").attr("x1",0).attr("y1",function(t,e){return z(e)}).attr("x2",0).attr("y2",function(t,e){return z(e)}).attr("stroke-width",2).attr("stroke",l);E.transition().duration(2e3).attr("x2",M);for(var J=0,m=0;m<a.length;m++)J<a[m].toString().length&&(J=a[m].toString().length);var q=d3.svg.axis().scale(O).orient("bottom").tickValues(B.getXTickArray(0,a.length,J,M)),U=w.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+.3*-A.top+")").call(q);U.selectAll("text").text(function(t){return a[t]});var H=d3.svg.axis().scale(z).orient("left").tickValues(p);w.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate(0,0)").call(H).selectAll("text").text(function(t){return h[t]});for(var j=0;j<a.length;j++){var W=w.selectAll(".circle").data(h).enter().append("circle").attr("cx",O(0)).attr("cy",function(t,e){return z(e)}).attr("r",function(t,a){return isNaN(F(e[a].xData[j]))?0:F(e[a].xData[j])}).attr("value",function(t,a){return e[a].xData[j]}).attr("toolTipMsg",function(t,a){return e[a].toolTipActivities[j]}).attr("yDataIndex",function(t,e){return e}).attr("xDataIndex",function(){return j}).attr("fill",function(t,a){var r=w.append("svg:defs").append("svg:linearGradient").attr("id","rectangleGradient"+a+j).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad").attr("gradientTransform","rotate(0)");return r.append("stop").attr("offset","0").attr("stop-color",function(){return n(e[a].xDataColor[j],.5)}),r.append("stop").attr("offset","1").attr("stop-color",function(){return n(e[a].xDataColor[j],-.5)}),"url(#rectangleGradient"+a+j+")"}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=parseInt(d3.select(this).attr("yDataIndex")),a=d3.select(this).attr("toolTipMsg"),n=[{headingName:h[e],headingVal:t}];X.showToolTip(d3.event,"",a,!1,n,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()});W.transition().duration(2e3).attr("cx",O(j));var $=w.selectAll(".text").data(h).enter().append("text").attr("value",function(t,a){return e[a].xData[j]}).attr("toolTipMsg",function(t,a){return e[a].toolTipActivities[j]}).attr("yDataIndex",function(t,e){return e}).attr("xDataIndex",function(){return j}).attr("x",O(0)).attr("y",function(t,e){return z(e)+5}).text(function(t,a){return isNaN(e[a].xData[j])?"":e[a].xData[j]}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=parseInt(d3.select(this).attr("yDataIndex")),a=d3.select(this).attr("toolTipMsg"),n=[{headingName:h[e],headingVal:t}];X.showToolTip(d3.event,"",a,!1,n,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()});$.transition().duration(2e3).attr("x",function(t,a){return O(j)-3.5*e[a].xData[j].toString().length})}{var Z=10,K=10,Q=G.showHorizontalLegend(M,0,u,Z,K),te=g.append("g").attr("class","legendGroup").attr("transform","translate("+A.left+","+(k+A.top+5)+")");te.selectAll(".rect").data(Q).enter().append("rect").attr("id","legendRectangle").attr("value",function(t,e){return e}).attr("width",Z).attr("height",K).attr("x",function(t,e){return Q[e].x}).attr("y",function(t,e){return Q[e].y}).attr("fill",function(t,e){return f[e]}),te.selectAll(".text").data(Q).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",function(t,e){return Q[e].textXPos}).attr("y",function(t,e){return Q[e].y}).text(function(t,e){return u[e]}).attr("dy",".7em").attr("fill",x.legendTextColor)}c(g),d(g)}},ze={multiGroupedBarChartAnalysis:function(e){function a(t,e,a,n,r){var i,o,l=[],s=.25;if(1==t)return i=N(a)+r,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),l;if(2==t){var u=15;return i=N(a)+r+e*s,o=I(0)-u,l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*s,o=I(0)-u,l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*s,o=I(0)-u,l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*s,o=I(0)-u,l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*s,o=I(0)-u,l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),l}if(3==t){var u=15;return i=N(a)+r,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*s,o=I(0)-u,l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*s,o=I(0)-u,l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),l}if(4==t){var u=15;return i=N(a)+r+e,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*s,o=I(0)-u,l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*s,o=I(0)-u,l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),l}if(5==t){var u=15;return i=N(a)+r,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*s,o=I(0)-u,l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*s,o=I(0)-u,l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),l}if(6==t){var u=15;return i=N(a)+r,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*s,o=I(0)-u,l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*s,o=I(0)-u,l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(0),l.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),l}}function r(t,e,a,n,r){var i,o,s=[],u=.25;if(1==t)return i=N(a)+r,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),s;if(2==t){var c=15;return i=N(a)+r+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*u,o=I(l[n].data[a])-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*u,o=I(l[n].data[a])-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),s}if(3==t){var c=15;return i=N(a)+r,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*u,o=I(l[n].data[a])-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),s}if(4==t){var c=15;return i=N(a)+r+e,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*u,o=I(l[n].data[a])-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),s}if(5==t){var c=15;return i=N(a)+r,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),s}if(6==t){var c=15;return i=N(a)+r,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*u,o=I(l[n].data[a])-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*u,o=I(l[n].data[a])-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),s}}function i(t,e,a,n,r){var i,o,s=[],u=.25;if(1==t)return i=N(a)+r,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),A.push(JSON.parse('{"height":'+(I(0)-I(l[n].data[a]))+',"width":'+e+"}")),s;if(2==t){var c=15;return i=N(a)+r+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*u,o=I(l[n].data[a])-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*u,o=I(l[n].data[a])-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),s}if(3==t){var c=15;return i=N(a)+r,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*u,o=I(l[n].data[a])-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),s}if(4==t){var c=15;return i=N(a)+r+e,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*u,o=I(l[n].data[a])-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),s}if(5==t){var c=15;return i=N(a)+r,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*u,o=I(0)-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(0),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),s}if(6==t){var c=15;return i=N(a)+r,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e*u,o=I(l[n].data[a])-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e+e*u,o=I(l[n].data[a])-c,s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r+e,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),i=N(a)+r,o=I(l[n].data[a]),s.push(JSON.parse('{"x":'+i+',"y":'+o+"}")),s}}for(var o=e.xAxisData,l=e.key,s=e.title,u=(e.xAxisLabel,e.yAxisLabel,e.toolTipUnit),f=[0],h=l[0].data,p=[],m=0,b=[],A=[],M=0;M<l.length;M++)b[M]=l[M].name,f=d3.max(f)<d3.max(l[M].data)?l[M].data:f,h=d3.min(h)>d3.min(l[M].data)?l[M].data:h;yMin=E.getMin(h),yMax=E.getMax(f);for(var M=0;M<o.length;M++)p[M]=M,m<o[M].length&&(m=o[M].length);for(var k={left:Y.leftMarginController(f),right:.05*v,bottom:45,top:.1*y},w=v-k.left-k.right,S=y-k.top-k.bottom,C=w/(l.length*o.length+o.length-1),T=l.length*C,L=g.append("g").attr("class","mainGroup").attr("transform","translate("+k.left+","+k.top+")"),N=d3.scale.linear().domain([0,p.length-1+.1]).range([0,w-C*l.length]),D=B.getTickArray(yMin,yMax,8),P=[],_=[],I=d3.scale.linear().domain([0,yMax]).range([S,0]),V=d3.svg.axis().scale(N).orient("bottom").tickValues(B.getXTickArray(0,p.length,m,w)),F=d3.svg.axis().scale(I).orient("left").tickValues(D),O=.25*C,z=d3.svg.line().x(function(t){return t}).y(function(t,e){return _[e]}),M=(d3.svg.line().x(function(t){return t}).y(function(){return S}),0);M<D.length-1;M++){P[0]=0,_[0]=I(D[M]),P[1]=O,_[1]=I(D[M])-15,P[2]=w,_[2]=_[1],pathRef=L.selectAll(".path").data([P]).enter().append("path").attr("d",z).attr("class","horizontalGridLine").attr("fill","none").attr("stroke",x.gridLineColor);var J=pathRef.node().getTotalLength();pathRef.attr("stroke-dasharray",function(){return J+","+J}).attr("stroke-dashoffset",J).transition().duration(1500).ease("linear").attr("stroke-dashoffset",0)}for(var q=(L.append("g").attr("class","xAxisGroup").attr("transform","translate("+T/2+","+S+")").call(V).attr("fill","none").selectAll("text").attr("fill","black").text(function(t){return o[t]}),L.append("g").attr("class","yAxisGroup").attr("transform","translate(0,0)").call(F).attr("fill","none").selectAll("text").attr("fill","black"),d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("closed")),U=100,H=500,j="elastic",W=1,M=0;M<o.length;M++)for(var $=0,Z=0;Z<l.length;Z++)i(2,C,M,Z,$),i(3,C,M,Z,$),i(5,C,M,Z,$),i(4,C,M,Z,$),i(6,C,M,Z,$),i(1,C,M,Z,$),pathRef2=L.append("path").attr("d",q(a(2,C,M,Z,$))).attr("class","pathOfMultiGroupedBar"+Z).attr("key",Z).attr("value",M).attr("fill",l[Z].color).attr("stroke","black").attr("stroke-width",.2).transition().duration(H).delay(U).ease(j).attr("d",q(r(2,C,M,Z,$))),pathRef3=L.append("path").attr("d",q(a(3,C,M,Z,$))).attr("class","pathOfMultiGroupedBar"+Z).attr("key",Z).attr("value",M).attr("fill","yAxisData[j].color").attr("stroke","black").attr("stroke-width",.2).transition().duration(H).delay(U).ease(j).attr("d",q(r(3,C,M,Z,$))),pathRef5=L.append("path").attr("d",q(a(5,C,M,Z,$))).attr("class","pathOfMultiGroupedBar"+Z).attr("key",Z).attr("value",M).attr("fill",l[Z].color).attr("stroke","black").attr("stroke-width",.2).transition().duration(H).delay(U).ease(j).attr("d",q(r(5,C,M,Z,$))),pathRef4=L.append("path").attr("d",q(a(4,C,M,Z,$))).attr("class","pathOfMultiGroupedBar"+Z).attr("key",Z).attr("value",M).attr("fill",n(l[Z].color,-.2)).attr("stroke","black").attr("stroke-width",.3).on("mousemove",function(){var t=d3.select(this).attr("value"),e=d3.select(this).attr("key"),a=u+" "+o[t],n=[{headingName:l[e].name,headingVal:l[e].data[t]}];X.showToolTip(d3.event,"",a,!1,n,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}).transition().duration(H).delay(U).ease(j).attr("d",q(r(4,C,M,Z,$))),pathRef6=L.append("path").attr("d",q(a(6,C,M,Z,$))).attr("class","pathOfMultiGroupedBar"+Z).attr("key",Z).attr("value",M).attr("fill",n(l[Z].color,-.3)).attr("stroke","black").attr("stroke-width",.3).on("mousemove",function(){var t=d3.select(this).attr("value"),e=d3.select(this).attr("key"),a=u+" "+o[t],n=[{headingName:l[e].name,headingVal:l[e].data[t]}];X.showToolTip(d3.event,"",a,!1,n,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}).transition().duration(H).delay(U).ease(j).attr("d",q(r(6,C,M,Z,$))),pathRef1=L.append("path").attr("d",q(a(1,C,M,Z,$))).attr("class","pathOfMultiGroupedBar"+Z).attr("key",Z).attr("value",M).attr("fill",l[Z].color).attr("stroke","black").attr("stroke-width",.3).on("mousemove",function(){var t=d3.select(this).attr("value"),e=d3.select(this).attr("key"),a=u+" "+o[t],n=[{headingName:l[e].name,headingVal:l[e].data[t]}];X.showToolTip(d3.event,"",a,!1,n,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}).transition().duration(H).delay(U).ease(j).attr("d",q(r(1,C,M,Z,$))),$+=C,U+=80,W++;var K=7,Q=e.xAxisLabel.toString().length*K,te=y-5,ee=v/2-Q/2;R.appendLabel(e.xAxisLabel,ee,te,0,g,x.xLabelColor,600);var ae=e.yAxisLabel.toString().length*K,ne=y/2+ae/2,re=13;R.appendLabel(e.yAxisLabel,re,ne,-90,g,x.xLabelColor,600);var ie=v/2-s.length*K/2;R.appendLabel(s,ie,15,0,g,x.xLabelColor,800);{var oe=10,le=10,se=G.showHorizontalLegend(w,25,b,oe+20,le),ue=g.append("g").attr("class","legendGroup").attr("transform","translate("+k.left+",0)");ue.selectAll(".rect").data(se).enter().append("rect").attr("id","legendRectangle").attr("value",function(t,e){return e}).attr("state",1).attr("width",oe).attr("height",le).attr("x",function(t,e){return se[e].x}).attr("y",function(t,e){return se[e].y}).attr("fill",function(t,e){return l[e].color}).on("click",function(){var e=parseInt(d3.select(this).attr("value")),a=parseInt(d3.select(this).attr("state"));0==a?(d3.select(this).attr("state",1),d3.select(this).style("fill",l[e].color),g.selectAll("#text"+e).style("text-decoration","none"),t(".pathOfMultiGroupedBar"+e).fadeToggle(2e3)):(d3.select(this).attr("state",0),d3.select(this).style("fill","gray"),g.selectAll("#text"+e).style("text-decoration","line-through"),t(".pathOfMultiGroupedBar"+e).fadeToggle(2e3))}),ue.selectAll(".text").data(se).enter().append("text").attr("id",function(t,e){return"text"+e}).attr("x",function(t,e){return se[e].textXPos-20}).attr("y",function(t,e){return se[e].y}).text(function(t,e){return l[e].name}).attr("dy",".7em").attr("fill",x.legendTextColor)}c(g),d(g)}},Ge={dountChartWithMappingAnalysis:function(t,e){function a(t,e,a,r){var i=0,o=0,l=[],u=[],c=d3.svg.arc().innerRadius(e).outerRadius(a),d=d3.layout.pie().value(function(t){return t}),f=k.selectAll(".arc").data(d(r)).enter().append("g").attr("class",function(e,a){l[o]=e.startAngle,u[o]=e.endAngle,o++;var n=0;for(var r in t){if(a==n)return r;n++}}),h=f.append("path").attr("d",c).attr("id",function(e,a){var n=0;for(var r in t){if(a==n)return r;n++}});h.attr("fill","none");for(var p in t){var g=[];for(var v in t[p])g.push(1);if(g.push(1),g.length>0){var y=p;n(t[p],e,a,l[i],u[i],g,s[0],y,i)}i++}}function n(t,a,n,i,o,l,u,f,h){var v,y=i,x=r(l),m=.3,b=10;c>=d?v=d/3:imgSige=c/3;for(var A=0;A<l.length-1;A++){var M=l[A]/x*(o-i),w=(M+y+y)/2,S=0,C=M*v,T=d3.svg.arc().innerRadius(a).outerRadius(n).startAngle(y).endAngle(y+M),L=d3.svg.arc().innerRadius(a).outerRadius(n).startAngle(y).endAngle(y),N=k.append("path").attr("d",L).attr("id",function(e){var a=0;for(var n in t){if(A==a){var e=n.replace(/ /g,"");return e}a++}}).attr("fill",function(){return u}).attr("stroke","black").attr("stroke-width",.3);if(N.transition().duration(2e3).attr("d",T),void 0!=e[f]){if(3.1>=w)var D=k.append("g").attr("id",function(){var e=0;for(var a in t){if(A==e)return a;e++}}).attr("transform","translate("+Math.sin(w)*a+","+-Math.cos(w)*a+") rotate("+(180*w/Math.PI-90)+")"),P=k.append("g").attr("id","imageGroup").attr("transform","translate("+Math.sin(y+M)*a+","+-Math.cos(y+M)*a+") rotate("+(180*w/Math.PI-90)+")");else var D=k.append("g").attr("id",function(){var e=0;for(var a in t){if(A==e)return a;e++}}).attr("transform","translate("+Math.sin(w)*n+","+-Math.cos(w)*n+") rotate("+(180*w/Math.PI+90)+")"),P=k.append("g").attr("id","imageGroup").attr("transform","translate("+Math.sin(y+M)*n+","+-Math.cos(y+M)*n+") rotate("+(180*w/Math.PI+90)+")");for(var _ in e[f]){if(S==A){var I=_;break}S++}P.append("svg:image").attr("xlink:href",function(){return e[f][I]}).attr("x",0).attr("y",3).attr("width",30).attr("height",C),D.append("text").attr("x",40).attr("y",0).text(function(){var e=0;for(var a in t){if(A==e)return a;e++}}).style("font-family","calibri").style("font-size",M*v).attr("dy",".3em").attr("fill",e.textColor)}else{if(3.1>=w)var D=k.append("g").attr("id",function(){var e=0;for(var a in t){if(A==e)return a;e++}}).attr("transform","translate("+Math.sin(w)*a+","+-Math.cos(w)*a+") rotate("+(180*w/Math.PI-90)+")");else var D=k.append("g").attr("id",function(){var e=0;for(var a in t){if(A==e)return a;e++}}).attr("transform","translate("+Math.sin(w)*n+","+-Math.cos(w)*n+") rotate("+(180*w/Math.PI+90)+")");D.append("text").attr("x",10).attr("y",0).text(function(){var e=0;for(var a in t){if(A==e)return a;e++}}).style("font-family","calibri").style("font-size",M*v).attr("dy",".3em").attr("fill",e.textColor)}N.on("mouseover",function(){d3.select(this).style("fill-opacity",m);for(var e in t){var a=e.replace(/ /g,"");if(a==d3.select(this).attr("id"))for(var n in t[e])for(var r=0;r<t[e][n].length;r++){var i=t[e][n][r].replace(/ /g,"");g.select("#"+i).style("fill-opacity",m)}}}).on("mouseleave",function(){d3.select(this).style("fill-opacity",b);for(var e in t){var a=e.replace(/ /g,"");if(a==d3.select(this).attr("id"))for(var n in t[e])for(var r=0;r<t[e][n].length;r++){var i=t[e][n][r].replace(/ /g,"");g.select("#"+i).style("fill-opacity",b)}}}),y+=M}var V=d3.svg.arc().innerRadius(n).outerRadius(n+20).startAngle(i).endAngle(y),F=(k.append("path").attr("d",V).attr("id","path"+h).attr("fill",function(){return s[1]}).attr("stroke","black"),e.title[p++]),O=k.append("text").attr("dy",15);O.append("textPath").attr("xlink:href","#path"+h).attr("startOffset","20%").text(F).style("font-size",14).attr("fill","black")}function r(t){for(var e=0,a=0;a<t.length;a++)e+=t[a];return e}function i(t){var e=d3.interpolate({startAngle:-180*h,endAngle:-180*h},t);return function(t){return w(e(t))}}var o,l,s=e.color,u={left:.1*v,right:.1*v,bottom:.1*y,top:.1*y},c=v-u.left-u.right,d=y-u.top-u.bottom,f=[],h=Math.PI/180,p=0,x=g.append("g").attr("class","mainGroup").attr("transform","translate("+u.left+","+u.top+")");o=d>c?c/2:d/2,l=o/2.2;var m=0,b=0;for(var A in t){b=0;for(var M in t[A])b++;f[m++]=b+1}var k=x.append("g").attr("id","donutGroup").attr("transform","translate("+.5*c+","+.5*d+")"),w=d3.svg.arc().innerRadius(l-30).outerRadius(l),S=d3.layout.pie().value(function(t){return t}),C=[];C[0]=1;k.selectAll(".arc").data(S(C)).enter().append("g").append("path").attr("d",w).attr("fill",function(){return s[1]}).transition().duration(2e3).attrTween("d",i).attr("stroke","black");a(t,l,o,f,s[1])}},Re={threeDDountChartAnalysis:function(e){function a(t,e,a,n){if(t.endAngle-t.startAngle==0)return"M 0 0";var r=e*Math.cos(t.startAngle),i=a*Math.sin(t.startAngle),o=e*Math.cos(t.endAngle),l=a*Math.sin(t.endAngle),s=[];return s.push("M",r,i,"A",e,a,"0",t.endAngle-t.startAngle>Math.PI?1:0,"1",o,l,"L",n*o,n*l),s.push("A",n*e,n*a,"0",t.endAngle-t.startAngle>Math.PI?1:0,"0",n*r,n*i,"z"),s.join(" ")}function n(t,e,a,n){var r=t.startAngle>Math.PI?Math.PI:t.startAngle,i=t.endAngle>Math.PI?Math.PI:t.endAngle,o=e*Math.cos(r),l=a*Math.sin(r),s=e*Math.cos(i),u=a*Math.sin(i),c=[];return c.push("M",o,n+l,"A",e,a,"0 0 1",s,n+u,"L",s,u,"A",e,a,"0 0 0",o,l,"z"),c.join(" ")}function r(t,e,a,n,r){var i=t.startAngle<Math.PI?Math.PI:t.startAngle,o=t.endAngle<Math.PI?Math.PI:t.endAngle,l=r*e*Math.cos(i),s=r*a*Math.sin(i),u=r*e*Math.cos(o),c=r*a*Math.sin(o),d=[];return d.push("M",l,s,"A",r*e,r*a,"0 0 1",u,c,"L",u,n+c,"A",r*e,r*a,"0 0 0",l,n+s,"z"),d.join(" ")}function i(t){return Math.round(p[t]/L*100)+b}function o(t){var e=d3.interpolate({startAngle:-180*C,endAngle:-180*C},t);return function(t){return r(e(t),D,P,_,I)}}function l(t){var e=d3.interpolate({startAngle:-180*C,endAngle:-180*C},t);return function(t){return a(e(t),D,P,I)}}function s(t){var e=d3.interpolate({startAngle:-180*C,endAngle:-180*C},t);return function(t){return n(e(t),D,P,_)}}var u,c,f,p=e.dountData,x=e.dountKey,m=e.colorArray,b=e.unit,A=e.factor;500>v?(f=5.5,c=10,u={left:60,right:60,bottom:35,top:35,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v}):(f=7,c=12,u={left:.1*v,right:.1*v,bottom:.15*y,top:.1*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v});
for(var M=v-u.left-u.right,k=y-u.top-u.bottom,w=g.append("g").attr("class","main-group").attr("transform","translate("+u.left+","+u.top+")"),S=w.append("g").attr("class","dountPie").attr("transform","translate("+M/2+","+k/2+")"),C=(t(h).offset().left,Math.PI/180),T=0,L=0,N=0;N<p.length;N++)L+=p[N];var D=M>k?k:M;D=.45*D;var P=.75*D,_=25,I=.75,V=d3.layout.pie().sort(null).value(function(t){return t});S.selectAll(".innerSlice").data(V(p)).enter().append("path").attr("class","innerSlice").style("fill",function(t,e){return m[e]}).attr("d",function(t){return r(t,D,P,_,I)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*T,a=Math.sin(t.midAngle)*T;return"translate("+e+","+a+")"}).transition().duration(1500).attrTween("d",o),S.selectAll(".topSlice").data(V(p)).enter().append("g").attr("class","topSlice").style("fill",function(t,e){return m[e]}).style("stroke",function(t,e){return m[e]}).append("path").attr("value",function(t,e){return e}).attr("d",function(t){return a(t,D,P,I)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*T,a=Math.sin(t.midAngle)*T;return"translate("+e+","+a+")"}).on("mouseover",function(){var t=d3.select(this).attr("value"),e=g.select("#text"+t).attr("x");g.select("#text"+t).attr("x",function(){return e>0?e-10+20:e-10}).style("font-weight",600)}).on("mouseout",function(){var t=d3.select(this).attr("value"),e=g.select("#text"+t).attr("x");g.select("#text"+t).attr("x",function(){return e>0?e-10:e-10+20}).style("font-weight","normal")}).on("mousemove",function(){var t=d3.select(this).attr("value"),e=x[t],a=i(t),n=[{headingName:A,headingVal:a}];X.showToolTip(d3.event,"",e,!1,n,.96*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}).transition().duration(1500).attrTween("d",l),S.selectAll(".outerSlice").data(V(p)).enter().append("path").attr("class","outerSlice").style("fill",function(t,e){return m[e]}).attr("d",function(t){return n(t,D,P,_)}).attr("transform",function(t){t.midAngle=(t.endAngle-t.startAngle)/2+t.startAngle;var e=Math.cos(t.midAngle)*T,a=Math.sin(t.midAngle)*T;return"translate("+e+","+a+")"}).transition().duration(1500).attrTween("d",s);for(var F,O,z=d3.svg.line().x(function(t,e){return G[e]}).y(function(t,e){return R[e]}),G=[],R=[],E=0,N=0;N<p.length;N++)F=p[N]/L*360,O=E,E+=F,O=(O+E)/2,G[0]=.98*D*Math.cos(O*(Math.PI/180)),R[0]=.98*P*Math.sin(O*(Math.PI/180)),G[1]=1.2*D*Math.cos(O*(Math.PI/180)),R[1]=1.2*P*Math.sin(O*(Math.PI/180)),G[2]=G[1]+.1*D*Math.cos(O*(Math.PI/180)),R[2]=R[1],S.selectAll(".path").data([G]).enter().append("path").attr("d",z).attr("stroke-width",1).attr("fill","none").attr("stroke",m[N]),S.append("text").attr("id",function(){return"text"+N}).attr("x",function(){return G[2]>0?G[2]:G[2]-(x[N].length+i(N).length+1)*f}).attr("y",R[2]+3).attr("fill",m[N]).text(function(){return i(N)+" "+x[N]});d(g)}},Ee={roundedThreeDBarAnalysis:function(e){for(var a=e.barData,n=e.xAxisLabel,r=e.yAxisLabel,i=e.title,o=e.unit,l=[],s=[],u=0;u<a.length;u++)l[u]=u,s[u]=a[u].visits;var f=Y.leftMarginController(s),p={left:f,right:.05*v,bottom:45,top:.1*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},m=v-p.left-p.right,b=y-p.top-p.bottom,A=m/(1.5*a.length),M=.1*A,k=g.append("g").attr("class","main-group").attr("transform","translate("+p.left+","+p.top+")"),w=8,S=v/2-i.length*w/2,C=g.append("g").attr("class","title");R.appendLabel(i,S,p.top/2,0,C,x.chartTitleColor,800);var w=7,T=n.toString().length*w,L=b+(p.bottom-5),N=m/2-T/2;R.appendLabel(n,N,L,0,k,x.xLabelColor,600);var D=r.toString().length*w,P=b/2+D/2,_=-p.left+15;R.appendLabel(r,_,P,-90,k,x.yLabelColor,600);for(var I=d3.scale.linear().domain([0,a.length-1]).range([.5*A,m-.5*A]),V=d3.max(s),F=E.getMin(s),O=d3.scale.linear().domain([F,V]).range([b,0]),z=[],G=0,u=0;u<a.length;u++)z[u]=u,G<a[u].country.toString().length&&(G=a[u].country.toString().length);var J=d3.svg.axis().scale(I).orient("bottom").tickValues(B.getXTickArray(0,z.length,G,m)),q=(k.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+b+")").call(J).attr("fill","none").selectAll("text").attr("fill","black").text(function(t){return console.log(z.length+" "+t),a[t].country}),d3.svg.axis().scale(O).orient("left").tickValues(B.getTickArray(F,V,9)));k.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate(0,0)").call(q).selectAll("text");var U=t(h).offset().left,H=k.selectAll(".rect").data(s).enter().append("rect").attr("class","rounded3DBar").attr("width",A).attr("height",0).attr("x",function(t,e){return I(e)-A/2}).attr("y",b-M).attr("fill",function(t,e){return a[e].color}).attr("opacity",.6);H.transition().duration(1500).ease("bounce").attr("height",function(t){return O(F)-O(t)-2*M}).attr("y",function(t){return O(t)+M});var j=(k.selectAll(".ellipse").data(s).enter().append("ellipse").attr("class","rounded3DBar").attr("cx",function(t,e){return I(e)}).attr("cy",b-M).attr("rx",A/2).attr("ry",M).attr("fill",function(t,e){return a[e].color}),k.selectAll(".ellipse").data(s).enter().append("ellipse").attr("class","rounded3DBar").attr("cx",function(t,e){return I(e)}).attr("cy",b-M).attr("rx",function(){return A/2}).attr("ry",function(t){return O(F)-O(t)-2*M<=0?0:M}).attr("fill",function(t,e){return a[e].color}));j.transition().duration(1500).ease("bounce").attr("cy",function(t){return O(t)+M}),g.selectAll(".rounded3DBar").on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=U+p.left,t=Math.round(I.invert(t));var e=a[t].country,n=s[t],i=[{headingName:r,headingVal:n+" "+o}];X.showToolTip(d3.event,"",e,!1,i,.96*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}),c(g),d(g)}},Ye={arcWithCylinderChartAnalysis:function(e){function a(t){d3.select("#bar-main-group").remove();for(var e=g.append("g").attr("id","bar-main-group").attr("transform","translate("+r.left+","+r.top+")"),a=d3.scale.linear().domain([0,N.length]).range([.55*s,s]),n=E.getMax(o[t].barData),l=E.getMin(o[t].barData),c=d3.scale.linear().domain([l,n]).range([u,0]),d=0,f=0;f<o[t].label.length;f++)d<o[t].label[f].toString().length&&(d=o[t].label[f].toString().length);var h=d3.svg.axis().scale(a).orient("bottom").tickValues(B.getXTickArray(0,o[t].label.length,d,.5*s)),p=e.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+u+")").call(h);p.selectAll("text").text(function(e){return o[t].label[e]}).attr("fill","#a7a7a7");var v=e.selectAll(".rect").data(o[t].barData).enter().append("rect").attr("class","cylinder"+t).attr("width",M).attr("height",0).attr("x",function(t,e){return a(e)-M/2}).attr("y",u-C).attr("fill",function(e,a){return i[o[t].label[a]]}).attr("opacity",.6);v.transition().duration(1500).ease("bounce").attr("height",function(t){return c(l)-c(t)-2*C}).attr("y",function(t){return c(t)+C});var y=e.selectAll(".ellipse").data(o[t].barData).enter().append("ellipse").attr("class","cylinder"+t).attr("cx",function(t,e){return a(e)}).attr("cy",u-C).attr("rx",M/2).attr("ry",C).attr("fill",function(e,a){return i[o[t].label[a]]});y.transition().duration(1500).ease("bounce").attr("cy",function(t){return c(t)+C});e.selectAll(".ellipse").data(o[t].barData).enter().append("ellipse").attr("class","cylinder"+t).attr("cx",function(t,e){return a(e)}).attr("cy",u-C).attr("rx",M/2).attr("ry",C).attr("fill",function(e,a){return i[o[t].label[a]]});d3.selectAll(".cylinder"+t).on("mousemove",function(){{var e=d3.event.pageX;d3.event.pageY}e-=L+r.left,e=Math.round(a.invert(e));var n=o[t].label[e],i=o[t].barData[e],l=[{headingName:o[t].key,headingVal:i}];X.showToolTip(d3.event,"",n,!1,l,.96*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()});var m=(e.selectAll(".text").data(o[t].barData).enter().append("text").attr("x",function(t,e){return a(e)-7*t.toString().length/2}).attr("y",function(t){return c(t)+C-8}).text(function(t){return t}).attr("fill",x.yLabelColor),9),b=.7*s-o[t].key.toString().length*m/2;R.appendLabel(o[t].key,b,r.top/2,0,e,x.chartTitleColor,800)}function n(t){for(var e=0,a=0;a<t.length;a++)e+=t[a];return e}var r,i=e.color,o=e.subData,l=e.title;r=500>v?{left:50,right:50,bottom:35,top:35,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v}:{left:.1*v,right:.1*v,bottom:.1*y,top:.1*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v};var s=v-r.left-r.right,u=y-r.top-r.bottom,f=g.append("g").attr("class","main-group").attr("transform","translate("+r.left+","+r.top+")"),p=9,m=s/1.7-l.length*p/2,b=g.append("g").attr("class","title");R.appendLabel(l,m,r.top/1.5,0,b,x.chartTitleColor,800);var A=f.append("g").attr("class","arc-main-group").attr("transform","translate("+(.5*s/2-.5*r.left)+","+u/2+")"),M=.45*s/(2*o[0].barData.length),k=.5*s>u?u:.5*s;k=.5*k;for(var w=.4*k,S=(k-w)/(2*o[0].barData.length),C=.2*M,T=Math.PI,L=(Math.PI/180,t(h).offset().left),N=[],D=0;D<o[0].barData.length;D++)N[D]=D;var P=(A.append("circle").attr("r",w).attr("fill","#454747").attr("opacity",.05).attr("stroke","#454747"),d3.svg.arc().innerRadius(w).outerRadius(k)),_=d3.layout.pie().sort(null).value(function(){return 1}),I=A.selectAll(".arc").data(_(o)).enter().append("g").attr("class","pie").attr("value",function(t,e){return e}).attr("startAngle",function(t,e){return e/o.length*360}).attr("endAngle",function(t,e){return(e+1)/o.length*360}).attr("fill",function(){return"#53565b"}).on("click",function(){g.selectAll(".pie").attr("fill","#53565b").attr("opacity",1),d3.select(this).attr("fill","lightsteelblue").attr("opacity",.5);{var t=d3.select(this).attr("startAngle");d3.select(this).attr("endAngle")}t=360-t,g.selectAll(".individualArc").transition().ease("bounce").duration(1500).attr("transform","rotate("+t+")"),g.selectAll(".pie").attr("transform","rotate("+t+")");var e=d3.select(this).attr("value");a(e)}).on("mouseover",function(){}).on("mouseleave",function(){});I.append("path").attr("d",P).attr("class",function(t,e){return"path"+e});for(var V,F=(I.append("text").attr("class","keyOfArc").attr("id",function(t,e){return"text"+e}),k),O=0,z=0;z<o.length;z++){F=k,theta=1/o.length*360,sum=n(o[z].barData);for(var G=0;G<o[z].barData.length;G++){var Y=o[z].barData[G]/sum*(360/o.length),J=d3.svg.arc().innerRadius(F-S).outerRadius(F).startAngle(O*(T/180)).endAngle((Y+O)*(T/180)),q=d3.svg.arc().innerRadius(F-S).outerRadius(F).startAngle(O*(T/180)).endAngle(O*(T/180)),U=A.append("path").attr("d",q).attr("class","individualArc").attr("fill",function(){return i[o[z].label[G]]}).attr("value",z+" "+G).on("mousemove",function(){var t=d3.select(this).attr("value"),e=t.split(" "),a=o[e[0]].label[e[1]],n=o[e[0]].barData[e[1]],r=[{headingName:o[e[0]].key,headingVal:n}];X.showToolTip(d3.event,"",a,!1,r,.96*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()});U.transition().ease("bounce").duration(1500).attr("d",J);var H=(F-S)*Math.sin((Y+O)*(Math.PI/180)),j=-(F-S)*Math.cos((Y+O)*(Math.PI/180));I.append("text").attr("class","labelOfArc").attr("transform","translate("+H+","+j+")rotate("+(Y+O)+")").style("font-size",1.3*S+"px","important").text(function(){return o[z].barData[G]}).attr("fill",x.yLabelColor),F-=2*S}V=O,O+=theta,V=(V+O)/2;var W=1.1*k*Math.sin(V*(Math.PI/180)),$=-1.1*k*Math.cos(V*(Math.PI/180));d3.select("#text"+z).attr("transform","translate("+W+","+$+")rotate("+V+")").text(o[z].key).attr("fill",x.yLabelColor)}a(0),c(g),d(g)}},Be={comparisionAreaChartAnalysis:function(e){var a=e.title,n=e.xAxisData,r=e.xAxisLabel,i=e.yAxisLabel,o=e.yDataObj,l=Y.leftMarginController(o[0].yAxisData),s={left:l,right:.025*v,bottom:45,top:.1*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},u=v-s.left-s.right,f=y-s.top-s.bottom,p=(t(h).offset().left,{init:function(t,e,a,n,r,i){{var o=Math.ceil(.2*e),l=Math.ceil(.5*e),s=Math.ceil(e/o);Math.ceil(a/l)}t.selectAll(".hline").data(d3.range(s)).enter().append("line").attr("y1",function(t){return t*o+6}).attr("y2",function(t){return t*o+6}).attr("x1",function(){return 0}).attr("x2",function(){return a}).style("stroke",i).style("stroke-width",.3).attr("transform","translate("+n+","+r+")")}});p.init(g,f,u,s.left,s.top,x.gridLineColor);var m=g.append("g").attr("class","main-group").attr("transform","translate("+s.left+","+s.top+")"),b=7,A=v/2-a.length*b/2,M=g.append("g").attr("class","title");R.appendLabel(a,A,s.top/2,0,M,x.chartTitleColor,800);var b=7,k=i.toString().length*b,w=f/2+k/2,S=-s.left+15;R.appendLabel(i,S,w,-90,m,x.yLabelColor,600);var C=r.toString().length*b,T=f+(s.bottom-5),L=u/2-C/2;R.appendLabel(r,L,T,0,m,x.xLabelColor,600);for(var N=d3.scale.linear().domain([0,n.length-1]).range([0,u]),D=o[0].yAxisData,P=1;P<o.length;P++)d3.min(D)>d3.min(o[P].yAxisData)&&(D=o[P].yAxisData);var _=E.getMin(D);D=o[0].yAxisData;for(var P=1;P<o.length;P++)d3.max(D)<d3.max(o[P].yAxisData)&&(D=o[P].yAxisData);for(var I=E.getMax(D),V=d3.scale.linear().domain([_,I]).range([f,0]),F=0,O=0;O<n.length;O++)F<n[O].toString().length&&(F=n[O].toString().length);var z=d3.svg.axis().scale(N).orient("bottom").tickValues(B.getXTickArray(0,n.length,F,u)),J=m.append("g").attr("id","xAxis").attr("class","xAxis").attr("fill","none").attr("transform","translate(0,"+f+")").call(z);J.selectAll("text").text(function(t){return n[t]});var q=B.getTickArray(_,I,8),X=d3.svg.axis().scale(V).orient("left").tickValues(q);m.append("g").attr("id","yAxis").attr("class","yAxis").attr("fill","none").attr("transform","translate(0,0)").call(X).selectAll("text").attr("fill","black");for(var U,H=d3.svg.area().x(function(t,e){return N(e)}).y0(f).y1(function(){return f}).interpolate("cardinal"),j=d3.svg.area().x(function(t,e){return N(e)}).y0(f).y1(function(t){return V(t)}).interpolate("cardinal"),W=1,P=0;P<o.length;P++)U=m.append("path").attr("d",H(o[P].yAxisData)).attr("class","path"+P).attr("fill",o[P].color).attr("opacity",W).attr("display","block"),W-=.1,U.transition().delay(1e3*P).duration(1500).ease("elastic").attr("d",j(o[P].yAxisData));for(var $=[],Z=[],P=0;P<o.length;P++)$.push(o[P].legend),Z.push(o[P].color);{var K=g.append("g").attr("class","legend").attr("transform","translate("+s.left+","+s.top+")"),Q=10,te=25,ee=0,ae=G.showHorizontalLegend(u,ee,$,te,Q);K.selectAll(".line").data(ae).enter().append("rect").attr("id",function(t,e){return e}).attr("width",te).attr("height",Q).attr("x",function(t,e){return ae[e].x}).attr("y",function(t,e){return ae[e].y}).attr("rx",4).attr("ry",4).attr("fill",function(t,e){return Z[e]}).attr("opacity",.5).on("click",function(){var t=d3.select(this).attr("id");"none"==g.select(".path"+t).attr("display")?(g.select(".path"+t).attr("display","block"),g.select(".text"+t).style("text-decoration","none")):(g.select(".path"+t).attr("display","none"),g.select(".text"+t).style("text-decoration","line-through"))}),K.selectAll(".text").data(ae).enter().append("text").attr("class",function(t,e){return"text"+e}).attr("x",function(t,e){return ae[e].textXPos}).attr("y",function(t,e){return ae[e].y+Q}).attr("font-family","calibri").text(function(t,e){return $[e]})}c(g),d(g)}},Je={angularMeterChartAnalysis:function(t){function e(){setInterval(function(){a()},2e3)}function a(){d3.select("#needle").remove(),d3.select("#needleText").remove();var t=Math.floor(Math.random()*(P-D+1)+D),e=t;t=_(t),b=(p-40)*Math.sin(t*(Math.PI/180)),M=-(p-40)*Math.cos(t*(Math.PI/180));(p-40)*Math.sin((t-5)*(Math.PI/180)),-(p-53)*Math.cos(t*(Math.PI/180)),(p-40)*Math.sin((t+5)*(Math.PI/180)),-(p-53)*Math.cos(t*(Math.PI/180)),f.append("line").attr("id","needle").attr("x1",0).attr("y1",0).attr("x2",b).attr("y2",M).attr("stroke","red").attr("stroke-width",3);z=b,G=M,R=t,f.append("text").attr("id","needleText").attr("x",function(){var t=9*e.toString().length;return.5*-t}).attr("y",.7*h).text(e)}var n,r=t.data,i=t.colorArray,o=t.meterLabel,l={left:.1*v,right:.1*v,bottom:.1*y,top:.1*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},s=v-l.left-l.right,u=y-l.top-l.bottom,c=[1,3,1],d=g.append("g").attr("class","main-group").attr("transform","translate("+l.left+","+l.top+")"),f=d.append("g").attr("class","arcGroup").attr("transform","translate("+.5*s+","+u/2+")"),h=(Math.PI/180,.5*s>.5*u?.5*u:.5*s);151>h&&(n=12);var p=.9*h;f.append("text").attr("x",function(){var t=9*o.toString().length;return.5*-t}).attr("y",.4*-h).text(o);for(var x,m,b,A,M,k=230,w=Math.PI,S=0;S<c.length;S++){{var C=c[S]/5*260,T=d3.svg.arc().innerRadius(p).outerRadius(h).startAngle(k*(w/180)).endAngle((C+k)*(w/180));f.append("path").attr("d",T).attr("class","individualArc").attr("fill",i[S])}k=C+k}var L=k;k=231;for(var N=230,D=d3.min(r),P=d3.max(r),_=d3.scale.linear().domain([D,P]).range([N+.5,L-.5]),I=0,V=((L-N)/r.length,0);V<r.length;V++){k=r[V],k=_(k),m=p*Math.sin(k*(Math.PI/180)),A=-p*Math.cos(k*(Math.PI/180)),b=(p-15)*Math.sin(k*(Math.PI/180)),M=-(p-15)*Math.cos(k*(Math.PI/180)),f.append("line").attr("x1",m).attr("y1",A).attr("x2",b).attr("y2",M).attr("stroke",function(){return N+52>k?i[0]:N+208>k?i[1]:i[2]}).attr("stroke-width",2),f.append("text").attr("x",function(){if(N+80>k)return b+3;if(N+160>k)return b-9;var t=8*r[I].toString().length;return b-t}).attr("y",function(){return N+80>k?M+4:N+160>k?M+13:M+4}).attr("fill",function(){return N+52>k?i[0]:N+208>k?i[1]:i[2]}).style("font-size",n,"important").text(r[I++]);var x,F=d3.scale.linear().domain([0,7]).range([_(r[V]),_(r[V+1])]);if(V<r.length-1)for(var O=0;7>O;O++)x=F(O),m=p*Math.sin(x*(Math.PI/180)),A=-p*Math.cos(x*(Math.PI/180)),b=(p-7)*Math.sin(x*(Math.PI/180)),M=-(p-7)*Math.cos(x*(Math.PI/180)),f.append("line").attr("x1",m).attr("y1",A).attr("x2",b).attr("y2",M).attr("stroke",function(){return N+52>x?i[0]:N+208>x?i[1]:i[2]})}var z=(p-40)*Math.sin(_(D)*(Math.PI/180)),G=-(p-40)*Math.cos(_(D)*(Math.PI/180)),R=_(D);a(),e()}},qe={brushingChartAnalysis:function(e){function a(){var t=d3.scale.linear().domain([0,p.length-1]).range([0,L]),e=d3.svg.area().x(function(e,a){return t(a)}).y0(.08*N).y1(function(t){return Z(t)}).interpolate("cardinal");Z=d3.scale.linear().domain([ae,ee]).range([.08*N,0]);for(var a=(ne.append("path").attr("class","spyCloseprice").attr("d",e(M)).attr("fill",w),0),n=0;n<p.length;n++)a<p[n].toString().length&&(a=p[n].toString().length);var r=d3.svg.axis().scale(t).orient("bottom").tickValues(B.getXTickArray(0,p.length,a,L)),i=ne.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+.08*N+")").call(r);i.selectAll("text").text(function(t){return p[t]}).attr("fill","black")}function n(t,e){d3.select(".rectChartGroup").remove(),H=g.append("g").attr("class","rectChartGroup").attr("transform","translate("+T.left+","+(T.top+.55*N)+")"),K=d3.scale.linear().domain([te,Q]).range([.25*N,0]);for(var a=[],n=t;e>=n;n++)a.push(k[n]);var r=H.selectAll(".rect").data(a).enter().append("rect").attr("width",u).attr("height",0).attr("x",function(e,a){return W(a+t)-u/2}).attr("y",function(){return.3*N}).attr("fill",w);r.transition().duration(1e3).attr("height",function(t){return K(te)-K(t)}).attr("y",function(t){return K(t)});var i=d3.svg.axis().scale(K).orient("left").tickValues(B.getTickArray(te,Q,5));H.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate(0,0)").call(i).selectAll("text").attr("fill","black"),c(g),d(g)}function r(t,e){var a=d3.svg.line().x(function(e,a){return W(a+t)}).y(function(t){return $(t)});$=d3.scale.linear().domain([ae,ee]).range([.45*N,0]);for(var n=[],r=t;e>=r;r++)n.push(M[r]);var i=j.append("path").data([n]).attr("class","line").attr("d",a).attr("stroke",w).attr("stroke-width",1).attr("fill","none"),o=i.node().getTotalLength();i.attr("stroke-dasharray",function(){return o+","+o}).attr("stroke-dashoffset",o).transition().duration(1500).ease("linear").attr("stroke-dashoffset",0);var l=d3.svg.axis().scale($).orient("left").tickValues(B.getTickArray(ae,ee,6));j.append("g").attr("id","yAxis").attr("class","y axis").attr("fill","none").attr("transform","translate(0,0)").call(l).selectAll("text").attr("fill","black"),c(g),d(g)}function i(t,e){d3.select(".lineChartGroup").remove(),j=g.append("g").attr("class","lineChartGroup").attr("transform","translate("+T.left+","+T.top+")");for(var a=[],n=t;e>=n;n++)a.push(k[n]);u=L/(1.5*a.length),W=d3.scale.linear().domain([t,e]).range([.5*u,L-.5*u]);for(var r=0,i=t;e>=i;i++)r<p[i].toString().length&&(r=p[i].toString().length);var o=d3.svg.axis().scale(W).orient("bottom").tickValues(B.getXTickArray(t,e,r,L)),l=j.append("g").attr("id","xAxis").attr("class","x axis").attr("fill","none").attr("transform","translate(0,"+.8*N+")").call(o);l.selectAll("text").text(function(t){return p[t]}).attr("fill","black"),c(g),d(g)}function o(t,e){for(var a=[],n=t;e>=n;n++)a.push(M[n]);ee=E.getMax(a),ae=E.getMin(a)}function l(t,e){for(var a=[],n=t;e>=n;n++)a.push(k[n]);Q=E.getMax(a),te=E.getMin(a)}function s(){{var t=d3.scale.linear().domain([0,p.length-1]).range([0,L]),e=g.append("g").attr("class","brushChartGroup").attr("transform","translate("+T.left+",0)"),a=.06*N;e.append("rect").attr("id","leftRect").attr("x",0).attr("y",T.top+.92*N).attr("width",.5*a).attr("height",.08*N).attr("fill","gray").attr("opacity",.5),e.append("rect").attr("id","rightRect").attr("x",L-.5*a).attr("y",T.top+.92*N).attr("width",.5*a).attr("height",.08*N).attr("fill","gray").attr("opacity",.5),e.append("image").attr("id","leftImage").attr("x",function(){return-2}).attr("y",function(){return T.top+.94*N}).attr("width",a).attr("height",a).attr("xlink:href","img/brush.png").on("mousedown",function(){d3.select(this).on("mousemove",function(){var t=d3.event.pageX;t=t-T.left-D;d3.event.pageY;t<g.select("#rightImage").attr("x")&&t>=0&&(d3.select(this).attr("x",t-15),g.select("#leftRect").attr("width",t))})}).on("mouseup",function(){d3.select(this).on("mousemove",null);var e=g.select("#rightImage").attr("x");e=Math.round(t.invert(e))+1;var a=d3.select(this).attr("x");a=Math.round(t.invert(a)),0>a&&(a=0),i(a,e),o(a,e),l(a,e),r(a,e),n(a,e)}),e.append("image").attr("id","rightImage").attr("x",function(){return L-a+2}).attr("y",function(){return T.top+.94*N}).attr("width",a).attr("height",a).attr("xlink:href","img/brush.png").on("mousedown",function(){d3.select(this).on("mousemove",function(){var t=d3.event.pageX;t=t-T.left-D;d3.event.pageY;t>g.select("#leftImage").attr("x")&&L>t&&(d3.select(this).attr("x",t-15),g.select("#rightRect").attr("x",t).attr("width",L-t))})}).on("mouseup",function(){d3.select(this).on("mousemove",null);var e=g.select("#leftImage").attr("x");e=Math.abs(Math.round(t.invert(e)));var a=d3.select(this).attr("x");a=Math.round(t.invert(a)),i(e,a),o(e,a),l(e,a),r(e,a),n(e,a)})}}var u,f=e.title,p=e.xAxisTickArray,m=e.yAxisLabel1,b=e.yAxisLabel2,A=e.xAxisLabel,M=e.yAxisData1,k=e.yAxisData2,w=e.dataColor,S=e.yAxisUnit,C=Y.leftMarginController(M),T={left:C,right:.05*v,bottom:45,top:.075*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},L=v-T.left-T.right,N=y-T.top-T.bottom,D=t(h).offset().left,P=t(h).offset().top;g.on("mousemove",function(){d3.selectAll(".toolTip").remove();var t=d3.event.pageX,e=d3.event.pageY;if(t=t-D-T.left,t>=0&&L-.5*u>=t&&e>=T.top+P&&e<=.85*N+T.top+P){var a=[],n=[],r=[],i=[],o=d3.svg.line().x(function(t,e){return a[e]}).y(function(t,e){return n[e]}),l=d3.svg.line().x(function(t,e){return r[e]}).y(function(t,e){return i[e]});t=Math.round(W.invert(t)),e=e-P-T.top;var s=p[t],c=M[t]+" "+S,d=k[t]+" "+S,f=[{headingName:m,headingVal:c},{headingName:b,headingVal:d}];X.showToolTip(d3.event,"",s,!1,f,.9*d3.event.pageY),j.append("line").attr("class","toolTip").attr("x1",0).attr("y1",$(M[t])).attr("x2",L).attr("y2",$(M[t])).attr("stroke","black").attr("opacity",.5),j.append("rect").attr("class","toolTip").attr("x",W(t)-.5*u).attr("y",0).attr("width",u).attr("height",.5*N).attr("fill","red").attr("opacity",.3),H.append("rect").attr("class","toolTip").attr("x",W(t)-.5*u).attr("y",0).attr("width",u).attr("height",.25*N).attr("fill","red").attr("opacity",.3);var h=6.5*p[t].toString().length+10,g=20,v=W(t),y=.82*N;a=[v-.5*h,v-7,v,v+7,v+.5*h,v+.5*h,v-.5*h],n=[y,y,y-7,y,y,y+g,y+g],j.append("path").data([a]).attr("class","toolTip").attr("d",o).attr("stroke","black").attr("stroke-width",1).attr("fill","black"),j.append("text").attr("class","toolTip").attr("x",W(t)-(.5*h-8)).attr("y",.82*N+13).attr("fill","white").style("font-size","10px","important").text(function(){parseInt(W.invert(t));return p[t]});var h=C-10,y=$(M[t])-12.5;r=[-h,-10,-10,-3,-10,-10,-h],i=[y,y,y+9,y+12.5,y+16,y+25,y+25],j.append("path").data([a]).attr("class","toolTip").attr("d",l).attr("stroke","black").attr("stroke-width",1).attr("fill","black"),j.append("text").attr("class","toolTip").attr("x",-h+10).attr("y",y+15).attr("fill","white").style("font-size","10px","important").text(M[t]);var x=K(k[t])-12.5;i=[x,x,x+9,x+12.5,x+16,x+25,x+25],H.append("path").data([a]).attr("class","toolTip").attr("d",l).attr("stroke","black").attr("stroke-width",1).attr("fill","black"),H.append("text").attr("class","toolTip").attr("x",-h+10).attr("y",x+15).attr("fill","white").style("font-size","10px","important").text(k[t]),H.append("line").attr("class","toolTip").attr("x1",0).attr("y1",K(k[t])).attr("x2",L).attr("y2",K(k[t])).attr("stroke","black").attr("opacity",.5)}}).on("mouseleave",function(){X.hideTooTip()});var _=g.append("g").attr("class","labelGroup").attr("transform","translate("+T.left+","+T.top+")"),I=7,V=m.toString().length*I,F=.45*N/2+V/2,O=-T.left+15;R.appendLabel(m,O,F,-90,_,x.yLabelColor,600);var V=b.toString().length*I,F=.55*N+(.8*N-.55*N)/2+V/2,O=-T.left+15;R.appendLabel(b,O,F,-90,_,x.yLabelColor,600);var z=A.length*I,G=N+T.bottom-5,J=L/2-z/2;R.appendLabel(A,J,G,0,_,x.xLabelColor,600);var I=8,q=v/2-f.length*I/2,U=g.append("g").attr("class","title");R.appendLabel(f,q,.05*y,0,U,x.chartTitleColor,800);var H,j,W,$,Z,K,Q,te,ee,ae,ne=g.append("g").attr("class","areaChartGroup").attr("transform","translate("+T.left+","+(T.top+.92*N)+")");i(0,p.length-1),o(0,p.length-1),l(0,p.length-1),n(0,p.length-1),r(0,p.length-1),a(),s(),c(g),d(g)}},Xe={ThreeDComparisionAnalysis:function(e){var a,n=e.yAxisEstimateData,r=e.yAxisActualData,i=e.xAxisData,o=e.yAxisUnit,l=e.yAxisLabel,s=e.xAxisLabel,u=e.title,f=e.yAxisActualDataUnit,p=e.yAxisEstimateDataUnit,m=e.legendArray,b=Y.leftMarginController(n),A={left:b,right:.05*v,bottom:45,top:.2*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},M=v-A.left-A.right,k=y-A.top-A.bottom,w=t(h).offset().left,S=M/(1.8*i.length);a=S>60?.3*S:.4*S;for(var C=[],T=[],L=12,N="calibri",D=[],P=0;P<i.length;P++)D[P]=P;var _=g.append("g").attr("class","main-group").attr("transform","translate("+A.left+","+A.top+")"),I=7,V=v/2-u.length*I/2,F=g.append("g").attr("class","title");R.appendLabel(u,V,A.top/2,0,F,x.chartTitleColor,800);var I=7,O=l.toString().length*I,z=k/2+O/2,J=-A.left+15;R.appendLabel(l,J,z,-90,_,x.yLabelColor,600);var q=s.toString().length*I,U=k+(A.bottom-5),H=M/2-q/2;R.appendLabel(s,H,U,0,_,x.xLabelColor,600);for(var j=(parseInt(k/S),d3.scale.linear().domain([0,i.length-1]).range([.8*S,M-.8*S])),W=d3.min(n)<d3.min(r)?n:r,$=E.getMin(W),W=d3.max(n)>d3.max(r)?n:r,Z=E.getMax(W),K=d3.scale.linear().domain([$,Z]).range([k,0]),Q=0,P=0;P<i.length;P++)Q<i[P].toString().length&&(Q=i[P].toString().length);var te=d3.svg.axis().scale(j).orient("bottom").tickValues(B.getXTickArray(0,i.length,Q,M)),ee=_.append("g").attr("id","xAxis").attr("class","xAxis").attr("fill","none").attr("transform","translate(0,"+k+")").call(te);ee.selectAll("text").text(function(t){return i[t]});var ae=B.getTickArray($,Z,8),ne=d3.svg.axis().scale(K).orient("left").tickValues(ae);_.append("g").attr("id","yAxis").attr("class","yAxis").attr("fill","none").attr("transform","translate(0,0)").call(ne).selectAll("text").style("font-size",L).style("font-family",N).attr("fill","black");for(var re,ie=d3.svg.line().x(function(t){return t}).y(function(t,e){return T[e]}),oe=d3.svg.line().x(function(t){return t}).y(function(){return k}),le=0;le<ae.length;le++){C[0]=0,T[0]=K(ae[le]),C[1]=a,T[1]=K(ae[le])-20,C[2]=M,T[2]=T[1],re=_.selectAll(".path").data([C]).enter().append("path").attr("d",ie).attr("fill","none").attr("stroke","gray");var se=re.node().getTotalLength();re.attr("stroke-dasharray",function(){return se+","+se}).attr("stroke-dashoffset",se).transition().duration(1500).ease("linear").attr("stroke-dashoffset",0)}for(var P=0;P<n.length;P++)C[0]=j(P)-.55*S,T[0]=K($)-a,C[1]=C[0],T[1]=K(n[P])+a,C[2]=C[1]+S,T[2]=T[1],C[3]=C[2],T[3]=T[0],re=_.selectAll(".path").data([C]).enter().append("path").attr("class","pathClass").attr("d",oe).attr("fill","#f6cd03"),re.transition().duration(2e3).ease("elastic").attr("d",ie),C[0]=j(P)-.55*S,T[0]=K(n[P])+a,C[1]=C[0]+.25*S,T[1]=T[0]-a,C[2]=C[1]+S,T[2]=T[1],C[3]=C[0]+S,T[3]=T[0],re=_.selectAll(".path").data([C]).enter().append("path").attr("d",oe).attr("class","pathClass").attr("fill","#f9f303"),re.transition().duration(2e3).ease("elastic").attr("d",ie),C[0]=C[3],T[0]=K($)-a,C[1]=C[3]+.25*S,T[1]=K($)-2*a,re=_.selectAll(".path").data([C]).enter().append("path").attr("class","pathClass").attr("d",oe).attr("fill","#c9a703"),re.transition().duration(2e3).ease("elastic").attr("d",ie);for(var P=0;P<r.length;P++)C[0]=j(P)-.8*S,T[0]=K(r[P])+a,C[1]=C[0]+.25*S,T[1]=T[0]-a,C[2]=C[1]+S,T[2]=T[1],C[3]=C[0]+S,T[3]=T[0],re=_.selectAll(".path").data([C]).enter().append("path").attr("class","pathClass").attr("d",oe).attr("fill","#fa7600"),re.transition().duration(2e3).ease("elastic").attr("d",ie),C[0]=C[3],T[0]=K($),C[1]=C[3]+.25*S,T[1]=K($)-a,re=_.selectAll(".path").data([C]).enter().append("path").attr("class","pathClass").attr("d",oe).attr("fill","#cc5200"),re.transition().duration(2e3).ease("elastic").attr("d",ie),C[0]=j(P)-.8*S,T[0]=K($),C[1]=C[0],T[1]=K(r[P])+a,C[2]=C[1]+S,T[2]=T[1],C[3]=C[2],T[3]=T[0],re=_.selectAll(".path").data([C]).enter().append("path").attr("class","pathClass").attr("d",oe).attr("fill","#fa6400"),re.transition().duration(2e3).ease("elastic").attr("d",ie);d3.selectAll(".pathClass").on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=w+A.left,t=Math.round(j.invert(t));var e=i[t],a=n[t]+" "+o,s=r[t]+" "+o,u=[{headingName:p+" "+l,headingVal:a},{headingName:f+" "+l,headingVal:s}];X.showToolTip(d3.event,"",e,!1,u,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()});{var ue=10,ce=-5,de=G.showHorizontalLegend(M,ce,m,ue,ue),fe=g.append("g").attr("class","legend").attr("transform","translate("+A.left+","+A.top+")");fe.selectAll(".rect").data(de).enter().append("rect").attr("width",ue).attr("height",ue).attr("x",function(t,e){return de[e].x}).attr("y",function(t,e){return de[e].y}).attr("fill",function(t,e){return 0==e?"#f6cd03":"#fa6400"}),fe.selectAll(".text").data(de).enter().append("text").attr("x",function(t,e){return de[e].textXPos}).attr("y",function(t,e){return de[e].y+ue}).style("font-family","calibri").text(function(t,e){return m[e]})}c(g),d(g)}},Ue={detailAnalysis:function(e){for(var a=e.data.leftYAxisData,n=e.data.rightYAxisData,r=e.data.xAxisData,i=e.data.topYSymbolArray,o=e.data.bottomYSymbolArray,l=e.data.title,s=(e.data.titleColor,e.data.titleSize,e.data.rightYAxisLabel),u=e.data.leftYAxisLabel,f=e.data.xAxisLabel,p=e.data.leftYAxisColor,m=e.data.rightYAxisColor,b=Y.leftMarginController(a),A=Y.leftMarginController(n),M={left:b,right:A,bottom:45,top:.1*y,chartSeparator:5,xScalePaddingTop:.2*y,yScalePaddingLeft:.1*v},k=v-M.left-M.right,w=y-M.top-M.bottom,S=e.data.imageFolderPath,C=e.data.bottomYSymbolLabel,T=e.data.leftYAxisUnit,L=e.data.rightYAxisUnit,N=[],D=0;D<r.length;D++)N[D]=D;U.init(g,w,k,M.left,M.top,x.gridLineColor);var P=t(h).offset().left,_=g.append("g").attr("class","scoredMainGroup").attr("transform","translate("+M.left+","+M.top+")"),I=7.5,V=v/2-l.length*I/2,F=g.append("g").attr("class","title");R.appendLabel(l,V,M.top,0,F,x.chartTitleColor,800);var I=6,O=s.toString().length*I,z=w/2-O/2,G=k+A-15;R.appendLabel(s,G,z,90,_,x.yLabelColor,600);var O=u.toString().length*I,J=w/2+O/2,q=-M.left+15;R.appendLabel(u,q,J,-90,_,x.yLabelColor,600);
var H=f.toString().length*I,j=w+(M.bottom-5),W=k/2-H/2;R.appendLabel(f,W,j,0,_,x.xLabelColor,600);for(var $=E.getMin(a),Z=E.getMax(a),K=d3.scale.linear().domain([$,Z]).range([w,0]),Q=d3.svg.axis().scale(K).orient("left"),te=(_.append("g").attr("class","y axis").attr("transform","translate(-5,0)").attr("fill","none").call(Q).selectAll("text").style("fill",p,"important"),E.getMin(n)),ee=E.getMax(n),ae=d3.scale.linear().domain([te,ee]).range([w,0]),ne=d3.svg.axis().scale(ae).orient("left"),N=(_.append("g").attr("class","y axis").attr("transform","translate("+(k+A-20)+",0)").attr("fill","none").call(ne).selectAll("text").style("fill",m,"important"),[]),D=0;D<r.length;D++)N[D]=D;for(var re=d3.scale.linear().domain([0,r.length-1]).range([0,k]),ie=0,D=0;D<r.length;D++)ie<r[D].toString().length&&(ie=r[D].toString().length);var oe=d3.svg.axis().scale(re).orient("bottom").tickValues(B.getXTickArray(0,r.length,ie,k)),le=(_.append("g").attr("class","x axis").attr("transform","translate(0,"+w+")").attr("fill","none").call(oe).selectAll("text").text(function(t){return r[t]}).attr("fill","black"),k/(2*o.length)),se=_.selectAll("img").data(o).enter().append("image").attr("class","detailChartObj").attr("x",function(){return 0}).attr("y",function(){return w-le}).attr("width",le).attr("height",le).attr("xlink:href",function(t){return S+""+t+".png"});se.transition().duration(2500).attr("x",function(t,e){return re(N[e])-le/2});var ue=d3.svg.line().x(function(t,e){return re(N[e])}).y(function(t,e){return ae(n[e])}).interpolate("cardinal"),ce=k/(2*i.length),de=_.selectAll(".path").data([n]).enter().append("path").attr("d",ue).attr("class","detailChartObj").attr("stroke",m).attr("stroke-width",1).attr("fill","none"),fe=de.node().getTotalLength();de.attr("stroke-dasharray",function(){return fe+","+fe}).attr("stroke-dashoffset",fe).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0);var he=_.selectAll("img").data(i).enter().append("image").attr("class","detailChartObj").attr("x",function(){return 0}).attr("y",function(){return 0}).attr("width",ce).attr("height",ce).attr("xlink:href",function(t){return S+""+t+".png"});he.transition().duration(2500).attr("x",function(t,e){return re(N[e])-ce/2}).attr("y",function(t,e){return ae(n[e])-(ce+5)});var pe=d3.svg.line().x(function(t,e){return re(N[e])}).y(function(t,e){return K(a[e])}).interpolate("cardinal"),ge=_.selectAll(".path").data([a]).enter().append("path").attr("d",pe).attr("class","detailChartObj").attr("stroke",p).attr("stroke-width",1).attr("fill","none"),ve=ge.node().getTotalLength();ge.attr("stroke-dasharray",function(){for(var t=3,e=2*t,a=t;ve>e;)a+=","+t+","+t,e+=2*t;return a+","+ve}).attr("stroke-dashoffset",ve).transition().duration(2e3).ease("linear").attr("stroke-dashoffset",0),g.selectAll(".detailChartObj").on("mousemove",function(){{var t=d3.event.pageX;d3.event.pageY}t-=P+M.left,t=Math.round(re.invert(t));var e=o[t],r=i[t],l=T,s=a[t],u=L,c=n[t],d=[{headingName:C,headingVal:e},{headingName:l,headingVal:s},{headingName:u,headingVal:c}];X.showToolTip(d3.event,"",r,!1,d,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}),c(g),d(g)}},He={threeDBubbleChart:function(t){function e(t){for(var e=0;e<t.length;e++){for(var a=[],n=0;n<t[e].data.length;n++){var r=t[e].data[n];a.push(JSON.parse('{"x":'+r[0]+',"y":'+r[1]+',"r":'+r[2]+"}"))}p.push(a)}return p}function a(t){var e=I(t);return.008*f>e&&(e=.008*f),e>.04*f&&(e=.04*f),e}function n(){return d3.svg.axis().scale(V).orient("bottom").ticks(10)}function r(){return d3.svg.axis().scale(F).orient("left").ticks(10)}var i=t.data.title,o=(t.data.titleColor,t.data.yAxisData,t.data.yAxisLabel),l=(t.data.xAxisData,t.data.xAxisLabel),s=t.data.series,u=t.data.legendArray;501>v?(titleFontSize=18,gridFactor=8,fontSize=11,rectangleSize=9,rectangleTextSize=9):(titleFontSize=20,gridFactor=12,fontSize=14,rectangleSize=10,rectangleTextSize=10);for(var f=y>v?v:y,h={top:.15*y,right:.15*v,bottom:.15*y,left:.15*v},p=[],m=e(s),b=d3.min(m[0],function(t){return t.x}),A=d3.max(m[0],function(t){return t.x}),M=d3.min(m[0],function(t){return t.y}),k=d3.max(m[0],function(t){return t.y}),w=d3.max(m[0],function(t){return t.r}),S=d3.min(m[0],function(t){return t.r}),C=0,T=0,L=0,N=0,D=0,P=0,_=1;_<m.length;_++)C=d3.max(m[_],function(t){return t.r}),T=d3.min(m[_],function(t){return t.r}),N=d3.max(m[_],function(t){return t.x}),L=d3.min(m[_],function(t){return t.x}),P=d3.max(m[_],function(t){return t.y}),D=d3.min(m[_],function(t){return t.y}),C>w&&(w=C),S>T&&(S=T),N>A&&(A=N),b>L&&(b=L),P>k&&(k=P),M>D&&(M=D);var I=d3.scale.linear().domain([0,w]).range([0,.1*f]),V=d3.scale.linear().range([h.left,v-h.right]).domain([0,1.1*A]),F=d3.scale.linear().range([y-h.top,h.bottom]).domain([M,1.2*k]),O=d3.svg.axis().scale(V).orient("bottom"),z=d3.svg.axis().scale(F).orient("left"),E=g.append("g").attr("class","bubble-main-group").attr("transform","translate(0,0)"),Y=8,B=v/2-i.length*Y/2,J=g.append("g").attr("class","title");R.appendLabel(i,B,h.top/2,0,J,x.chartTitleColor,800);var Y=6,q=l.toString().length*Y,U=y-h.top+.15*(y-h.top),H=(v-h.right)/2-q/2;R.appendLabel(l,H,U,0,E,x.xLabelColor,600);var j=o.toString().length*Y,W=y/2+j/2,$=h.left/3;R.appendLabel(o,$,W,-90,E,x.yLabelColor,600);for(var Z=t.data.colorArray,K=0;K<m.length;K++){E.selectAll("circle.s"+K).data(m[K]).enter().insert("circle").attr("cx",function(t){return V(t.x)}).attr("cy",function(t){return F(t.y)}).attr("r",function(t){return a(t.r)}).on("mousemove",function(t){var e=[{headingName:o,headingVal:t.y}];X.showToolTip(d3.event,"",l+" "+t.x,!1,e,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}).transition().duration(1e3).attr("opacity",.3).attr("class","s"+K).attr("fill",function(){return"url(#gradient"+K+")"});var Q=E.append("svg:defs").append("svg:linearGradient").attr("id","gradient"+K).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","100%").attr("spreadMethod","pad");Q.append("svg:stop").attr("offset","0%").attr("stop-color",Z[K]).attr("stop-opacity",1),Q.append("svg:stop").attr("offset","100%").attr("stop-color",Z[K]+1e3).attr("stop-opacity",1)}E.append("g").attr("class","xGrid").attr("transform","translate(0,"+(v-h.bottom)+")").call(n().tickSize(-v+h.bottom,0,0).tickFormat("")).attr("opacity","0.3"),E.append("g").attr("class","yGrid").attr("transform","translate("+h.left+",0)").call(r().tickSize(-y+2*h.bottom,0,0).tickFormat("")).attr("opacity","0.3"),E.append("svg:g").attr("class","xAxis axis").transition().call(O).attr("transform","translate(0,"+(f-.9*h.bottom)+")").attr("fill","black"),E.append("svg:g").attr("class","yAxis axis").transition().call(z).attr("transform","translate("+.9*h.left+",0)").attr("fill","black"),g.selectAll(".yAxis path").attr("fill","none"),g.selectAll(".xAxis path").attr("fill","none"),g.selectAll(".xGrid").attr("stroke","lightgrey"),g.selectAll(".yGrid").attr("stroke","lightgrey"),g.selectAll(".xGrid ").attr("opacity",.5),g.selectAll(".yGrid ").attr("opacity",.5),g.selectAll(".xGrid .tick").attr("stroke-width",0),g.selectAll(".yGrid .tick").attr("stroke-width",0);for(var te=y-h.top,ee=v-h.right,ae=E.append("g").attr("class","legend").attr("transform","translate("+.9*h.left+","+.13*te+")"),ne=12,re=12,ie=G.getLegendPositionArray(u,ee,te),oe=0;oe<ie.length;oe++)console.log("x "+ie[oe].x+" y "+ie[oe].y+" end "+ie[oe].endPos);ae.selectAll("rect.legendRect").data(u).enter().append("rect").attr("class","legendRect").attr("x",function(t,e){return ie[e].x}).attr("y",function(t,e){return ie[e].y}).attr("width",ne).attr("height",re).style("fill",function(t,e){return"url(#gradient"+e+")"}).attr("opacity",.3),newXCord=0,ae.selectAll("text").data(u).enter().append("text").attr("x",function(t,e){return ie[e].textPos}).attr("y",function(t,e){return ie[e].y+re}).attr("width",ne).attr("height",re).attr("font-size",12).text(function(t){return t}),c(g),d(g)}},je={twoDStackedBarChartAnalysis:function(t){function e(t){Q=100,te=100,g.selectAll("#twoDStackedBarchart").remove(),g.selectAll("#twoDStackedBarchartText").remove(),g.selectAll(".lowerStand").remove();for(var e=0;e<i.length;e++)for(k[e]=0,r(e),C=0;C<o.length;C++)1==t[C]&&(pathRef=I.append("path").attr("d",W(n(e,C))).attr("class","twoDStackedBarchart"+C).attr("id","twoDStackedBarchart").attr("key",C).attr("value",e).attr("fill",o[C].color).on("mousemove",function(){var t=d3.select(this).attr("value"),e=d3.select(this).attr("key"),a=i[t],n=[{headingName:o[e].name,headingVal:o[e].data[t]}];X.showToolTip(d3.event,"",a,!1,n,.95*d3.event.pageY)}).on("mouseleave",function(){X.hideTooTip()}).transition().duration(te).delay(Q).ease(ee).attr("d",W(a(e,C))),k[e]=k[e]+o[C].data[e],Q+=100)}function a(t,e){$=[],K=0;var a=16,n=17,r="white";if(0==e&&0!=o[e].data[t]){if(H=V(t)-P/2,j=_,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=F(o[e].data[t])+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t),j=F(o[e].data[t]),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=F(o[e].data[t])+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=_,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=_,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),_-F(o[e].data[t])>n){var i=o[e].data[t];7*i.toString().length>=P&&(a=12),I.append("text").attr("id","twoDStackedBarchartText").transition().duration(te).delay(Q).attr("x",V(t)-6.5*i.toString().length/2).attr("y",F(o[e].data[t])+Z).text(i).attr("fill",r).attr("dy",".6em").style("font-family","calibri","important").style("font-size",a,"important").style("font-style","bold","important")}}else if(0!=o[e].data[t]&&0==k[t]){if(H=V(t)-P/2,j=_,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=F(o[e].data[t])+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t),j=F(o[e].data[t]),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=F(o[e].data[t])+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=_,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=_,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),_-F(o[e].data[t])>n){var i=o[e].data[t];7*i.toString().length>=P&&(a=12),I.append("text").attr("id","twoDStackedBarchartText").transition().duration(te).delay(Q).attr("x",V(t)-6.5*i.toString().length/2).attr("y",F(o[e].data[t])+Z).text(i).attr("fill",r).attr("dy",".6em").style("font-family","calibri","important").style("font-size",a,"important").style("font-style","bold","important")}}else if(0!=o[e].data[t]&&(K=F(0)-F(o[e].data[t]),H=V(t)-P/2,j=F(k[t])+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=F(k[t])-K+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t),j=F(k[t])-K,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=F(k[t])-K+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=F(k[t])+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t),j=F(k[t]),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=F(k[t])+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),K>n)){var i=o[e].data[t];7*i.toString().length>=P&&(a=12),I.append("text").attr("id","twoDStackedBarchartText").transition().delay(Q+te).attr("x",V(t)-6.5*i.toString().length/2).attr("y",F(k[t])-K+Z).text(i).attr("fill",r).attr("dy",".6em").style("font-family","calibri","important").style("font-size",a,"important").style("font-style","bold","important")}return $}function n(t,e){return $=[],K=0,0==e&&0!=o[e].data[t]?(H=V(t)-P/2,j=F(0),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=F(0),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t),j=F(0),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=F(0),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=F(0),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=F(0),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}"))):0!=o[e].data[t]&&0==k[t]?(H=V(t)-P/2,j=F(0),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=F(0),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t),j=F(0),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=F(0),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=F(0),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=F(0),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}"))):0!=o[e].data[t]&&(K=0,H=V(t)-P/2,j=F(k[t])+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=F(k[t])-K+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t),j=F(k[t])-K,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=F(k[t])-K+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=F(k[t])+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t),j=F(k[t]),$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=F(k[t])+Z,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}"))),$}function r(t){$=[],H=V(t)-.3*P,j=_+.4*P,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-.2*P,j=_+.3*P,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-.2*P,j=_+.1*P,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2-.1*P,j=_+.1*P,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2-.1*P,j=_-P/2,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=_-P/2,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-P/2,j=_,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=_,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2,j=_-P/2,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2+.1*P,j=_-P/2,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+P/2+.1*P,j=_+.1*P,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+.2*P,j=_+.1*P,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+.2*P,j=_+.3*P,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)+.3*P,j=_+.4*P,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),H=V(t)-.3*P,j=_+.4*P,$.push(JSON.parse('{"x":'+H+',"y":'+j+"}")),pathRef=I.append("path").attr("d",W($)).attr("class","lowerStand").attr("fill","grey").attr("stroke","grey").attr("stroke-width",1),t%2!=0&&(I.append("line").attr("class","lowerStand").attr("x1",V(t)).attr("y1",_+.4*P).attr("x2",V(t)).attr("y2",_+P).attr("stroke","grey").attr("stroke-width",1),I.append("circle").attr("class","lowerStand").attr("cx",V(t)).attr("cy",_+P).attr("r",3).attr("fill","grey"))}for(var i=t.xAxisData,o=t.key,l=t.title,s=t.xAxisLabel,u=t.yAxisLabel,f=[0],h=o[0].data,p=[],m=0,b=[],A=0,M=0,k=[],w=[],S=0;S<o.length;S++)w[S]=1,b[S]=o[S].name,f=d3.max(f)<d3.max(o[S].data)?o[S].data:f,h=d3.min(h)>d3.min(o[S].data)?o[S].data:h;for(var S=0;S<i.length;S++){A=0;for(var C=0;C<o.length;C++)A+=o[C].data[S];M=A>M?A:M}for(var T=E.getMin(h),L=E.getMax([M,M-10]),S=0;S<i.length;S++)p[S]=S,k[S]=0,m<i[S].toString().length&&(m=i[S].toString().length);var N={left:Y.leftMarginController(M.toFixed(1)),right:.05*v,bottom:.15*y,top:.05*y},D=v-N.left-N.right,P=D/(2*i.length);N.bottom=P+.8*P;var _=y-N.top-N.bottom;U.init(g,_,D+N.left,N.left,N.top,x.gridLineColor);for(var I=g.append("g").attr("class","mainGroup").attr("transform","translate("+N.left+","+N.top+")"),V=d3.scale.linear().domain([0,p.length-1]).range([P/2,D]),F=d3.scale.linear().domain([T,L]).range([_,0]),O=B.getTickArray(T,L,6),z=d3.svg.axis().scale(V).orient("bottom").tickValues(B.getXTickArray(0,p.length,m,D)),J=d3.svg.axis().scale(F).orient("left").tickValues(O),q=(I.append("g").attr("class","xAxisGroup").attr("display","none").attr("transform","translate(0,"+(_+P/2)+")").call(z),I.append("g").attr("class","yAxisGroup").attr("transform","translate(0,0)").call(J).attr("fill","none").selectAll("text").attr("fill","black")),S=0;S<p.length;S++)I.append("text").attr("x",function(){return V(S)-7*i[S].toString().length/2}).attr("y",function(){return S%2==0?_+P:_+P+.4*P}).text(i[S]).attr("fill",x["tick-font-color"]);var H,j,W=d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}).interpolate("closed"),$=[],Z=6,K=0,Q=100,te=100,ee="linear";e(w);var ae=7,ne=s.toString().length*ae,re=y,ie=v/2-ne/2;R.appendLabel(s,ie,re,0,g,x.xLabelColor,600);var oe=u.toString().length*ae,le=y/2+oe/2,se=10;R.appendLabel(u,se,le,-90,g,x.xLabelColor,600);var ue=v/2-l.length*ae/2,ce=10;R.appendLabel(l,ue,ce,0,g,x.xLabelColor,800);{var de=10,fe=10,he=16,pe=G.showHorizontalLegend(D,he,b,de+20,fe),ge=g.append("g").attr("class","legendGroup").attr("transform","translate("+N.left+",0)");ge.selectAll(".rect").data(pe).enter().append("rect").attr("id","legendRectangle").attr("value",function(t,e){return e}).attr("width",de).attr("height",fe).attr("x",function(t,e){return pe[e].x}).attr("y",function(t,e){return pe[e].y}).attr("fill",function(t,e){return o[e].color}).on("click",function(t,a){M=0;var n=parseInt(d3.select(this).attr("value"));if(1==w[n]){d3.select(this).attr("fill","grey"),g.selectAll("#legend-text"+n).style("text-decoration","line-through"),w[n]=0;for(var a=0;a<i.length;a++){A=0;for(var r=0;r<o.length;r++)1==w[r]&&(A+=o[r].data[a]);M=A>M?A:M}var l=E.getMin(h),s=E.getMax([M,M-10]);g.select(".yAxisGroup").remove(),O=B.getTickArray(l,s,6),F=d3.scale.linear().domain([l,s]).range([_,0]),J=d3.svg.axis().scale(F).orient("left").tickValues(O),q=I.append("g").attr("class","yAxisGroup").attr("transform","translate(0,0)").call(J).attr("fill","none").selectAll("text").attr("fill",x["tick-font-color"],"important");for(var u=0,c=0;c<w.length;c++)if(1==w[c]){u=1;break}e(w)}else{d3.select(this).attr("fill",function(){return o[n].color}),g.selectAll("#legend-text"+n).style("text-decoration","none"),w[n]=1;for(var a=0;a<i.length;a++){A=0;for(var r=0;r<o.length;r++)1==w[r]&&(A+=o[r].data[a]);M=A>M?A:M}var l=E.getMin(h),s=E.getMax([M,M-10]);g.select(".yAxisGroup").remove(),O=B.getTickArray(l,s,6),F=d3.scale.linear().domain([l,s]).range([_,0]),J=d3.svg.axis().scale(F).orient("left").tickValues(O),q=I.append("g").attr("class","yAxisGroup").attr("transform","translate(0,0)").call(J).attr("fill","none").selectAll("text").attr("fill",x["tick-font-color"],"important"),e(w)}}),ge.selectAll(".text").data(pe).enter().append("text").attr("id",function(t,e){return"legend-text"+e}).attr("x",function(t,e){return pe[e].textXPos-20}).attr("y",function(t,e){return pe[e].y}).text(function(t,e){return o[e].name}).attr("dy",".8em").attr("font-family","calibri").attr("fill",x.legendTextColor)}c(g),d(g)}},We={meterChartAnalysis:function(t){function e(){setInterval(function(){a()},2500)}function a(){function t(t){var e=t.attr("d"),a=e.split(" ");return a[1].split(",")}function e(){s.transition().duration(2e3).attrTween("transform",a(o.node()))}function a(t){var e=t.getTotalLength()/2;return function(){return function(a){var n=t.getPointAtLength(a*e);g.select("#lineTrans").remove();f.append("line").attr("id","lineTrans").attr("x1",0).attr("y1",0).attr("x2",n.x).attr("y2",n.y).attr("stroke","black").attr("stroke-width",3);return"translate("+n.x+","+n.y+")"}}}g.select("#circleForTransition").remove(),g.select("#needleText").remove();var n=Math.floor(Math.random()*(O-F+1)+F),r=n;n=z(n);var i=d3.svg.arc().innerRadius(x-15).outerRadius(x-15).startAngle(J*(S/180)).endAngle(n*(S/180)),o=f.append("path").attr("d",i).attr("class","individualArc").attr("fill","f"),l=t(o),s=f.append("circle").attr("id","circleForTransition").attr("r",0).attr("transform","translate("+l+")");e(),J=n,f.append("text").attr("id","needleText").attr("x",function(){var t=9*r.toString().length;return.5*-t}).attr("y",.4*h).text(r)}var n=t.data,r=(t.dataLeft,t.colorArray),i=t.meterLabel,o={left:.005*v,right:.005*v,bottom:.005*y,top:.005*y},l=v-o.left-o.right,s=y-o.top-o.bottom,u=[1,3,1],c=(Math.PI/180,14),d=g.append("g").attr("class","main-group").attr("transform","translate("+o.left+","+o.top+")"),f=d.append("g").attr("class","centerArcGroup").attr("transform","translate("+.5*l+","+.5*s+")"),h=.5*l>.5*s?.5*s:.5*l;151>h&&(c=12);var p=l/6,x=.9*p;f.append("text").attr("x",function(){var t=9*i.toString().length;return.5*-t}).attr("y",.4*-p).text(i);for(var m,b,A,M,k,w=230,S=Math.PI,C=0;C<u.length;C++){{var T=u[C]/5*260,L=d3.svg.arc().innerRadius(x+20).outerRadius(p+20).startAngle(w*(S/180)).endAngle((T+w)*(S/180));f.append("path").attr("d",L).attr("class","individualArc").attr("fill",r[C])}w=T+w}for(var N=260,D=d3.svg.arc().innerRadius(x+20).outerRadius(x+21).startAngle(230*(S/180)).endAngle((N+230)*(S/180)),P=(f.append("path").attr("d",D).attr("class","individualArc").attr("fill","yellow"),w),_=w+1,I=230,V=x+20,F=d3.min(n),O=d3.max(n),z=d3.scale.linear().domain([F,O]).range([I+.5,P-.5]),G=0,R=((P-I)/n.length,0);R<n.length;R++){_=n[R],_=z(_),b=V*Math.sin(_*(Math.PI/180)),M=-V*Math.cos(_*(Math.PI/180)),A=(V-15)*Math.sin(_*(Math.PI/180)),k=-(V-15)*Math.cos(_*(Math.PI/180)),f.append("line").attr("x1",b).attr("y1",M).attr("x2",A).attr("y2",k).attr("stroke",function(){return I+52>_?r[0]:I+208>_?r[1]:r[2]}).attr("stroke-width",2),f.append("text").attr("x",function(){if(I+80>_)return A+3;if(I+160>_)return A-9;var t=8*n[G].toString().length;return A-t}).attr("y",function(){return I+80>_?k+4:I+160>_?k+13:k+4}).attr("fill",function(){return I+52>_?r[0]:I+208>_?r[1]:r[2]}).style("font-size",c,"important").text(n[G++]);var m,E=d3.scale.linear().domain([0,10]).range([z(n[R]),z(n[R+1])]);if(R<n.length-1)for(var Y=0;10>Y;Y++)m=E(Y),b=V*Math.sin(m*(Math.PI/180)),M=-V*Math.cos(m*(Math.PI/180)),A=(V-7)*Math.sin(m*(Math.PI/180)),k=-(V-7)*Math.cos(m*(Math.PI/180)),f.append("line").attr("x1",b).attr("y1",M).attr("x2",A).attr("y2",k).attr("stroke",function(){return I+52>m?r[0]:I+208>m?r[1]:r[2]})}var B=((V-40)*Math.sin(z(F)*(Math.PI/180)),-(V-40)*Math.cos(z(F)*(Math.PI/180))),J=z(F),q=[],q=(d3.svg.line().x(function(t){return t}).y(function(t,e){return q[e]}),[0,B]);e()}};return{drawLine:H.drawLine,drawBarWithMultipleLineAndCircle:H.drawBarWithMultipleLineAndCircle,squareChart:Z.squareChart,areaChart:pe.areaChart,circleChart:K.circleChart,pieChart:Q.pieChart,gaugeGraph:fe.gaugeGraph,drawYAxis:F.drawYAxis,drawMulitpleLineChartWithSquare:F.drawMulitpleLineChartWithSquare,setYSclae:$.setYSclae,drawPyramidChart:te.drawPyramidChart,draw3DPyramidChartWithoutSlice:te.draw3DPyramidChartWithoutSlice,draw3DPyramidSliceChart:te.draw3DPyramidSliceChart,drawRadarChart:ee.drawRadarChart,drawDrillDownChart:ne.drawDrillDownChart,drawPieChartWithTransition:ie.drawPieChartWithTransition,dountChartWithLegend:ie.dountChartWithLegend,drawDountWithBarChart:ie.drawDountWithBarChart,newDountChartWithBarAnalysis:ie.newDountChartWithBarAnalysis,multipleDountChartAnalysis:ie.multipleDountChartAnalysis,drawHeatMapChart:oe.drawHeatMapChart,groupedBarChart:$.groupedBarChart,groupedBar2DChart:$.groupedBar2DChart,bulletBar:$.bulletBar,cricketAnalysis:$.cricketAnalysis,barWithLogo:$.barWithLogo,drawScatterPlotChart:le.drawScatterPlotChart,drawBasicLineChart:ue.drawBasicLineChart,drawThreeDBarChart:se.drawThreeDBarChart,drawStackedAreaChart:ce.drawStackedAreaChart,stackedBarChart:$.stackedBarChart,drawFunnelChart:de.drawFunnelChart,areaChart:pe.areaChart,meterChart:ge.meterChart,turnNeedle:ge.turnNeedle,drawCombinationalChart:ae.drawCombinationalChart,drawThreeDStackedBarChart:ve.drawThreeDStackedBarChart,variationAnalysis:re.variationAnalysis,areaChartWithNegativeValueAnalysis:me.areaChartWithNegativeValueAnalysis,areaChartWithVaryColorAnalysis:be.areaChartWithVaryColorAnalysis,musicSpikesAnalysis:Me.musicSpikesAnalysis,comparisonAnalysis:Ae.comparisonAnalysis,drawThreeDGroupedBarChart:ke.drawThreeDGroupedBarChart,globChartAnalysis:ye.globChartAnalysis,detailAnalysis:Ue.detailAnalysis,threeDBubbleChart:He.threeDBubbleChart,treeChart:xe.treeChart,barWithLabelAnalysis:we.barWithLabelAnalysis,logoChart:Se.logoChart,multiAxisChartAnalysis:Ce.multiAxisChartAnalysis,roundedThreeDBarAnalysis:Ee.roundedThreeDBarAnalysis,threeDDountChartAnalysis:Re.threeDDountChartAnalysis,threeDPieChartAnalysis:Te.threeDPieChartAnalysis,arcWithCylinderChartAnalysis:Ye.arcWithCylinderChartAnalysis,ThreeDComparisionAnalysis:Xe.ThreeDComparisionAnalysis,brushingChartAnalysis:qe.brushingChartAnalysis,angularMeterChartAnalysis:Je.angularMeterChartAnalysis,comparisionAreaChartAnalysis:Be.comparisionAreaChartAnalysis,threeDPieChartWithLegendAnalysis:Le.threeDPieChartWithLegendAnalysis,threeDDountChartWithLegendAnalysis:Ne.threeDDountChartWithLegendAnalysis,dountChartWithMappingAnalysis:Ge.dountChartWithMappingAnalysis,smoothLineChartAnalysis:Ie.smoothLineChartAnalysis,activeAreaChartAnalysis:_e.activeAreaChartAnalysis,treeMapChartAnalysis:Pe.treeMapChartAnalysis,drillDownDountChartAnalysis:De.drillDownDountChartAnalysis,LineChartWithReverseYAxisAnalysis:Ve.LineChartWithReverseYAxisAnalysis,performanceChartAnalysis:Oe.performanceChartAnalysis,horizontalStackedBarChartAnalysis:Fe.horizontalStackedBarChartAnalysis,multiGroupedBarChartAnalysis:ze.multiGroupedBarChartAnalysis,twoDStackedBarChartAnalysis:je.twoDStackedBarChartAnalysis,meterChartAnalysis:We.meterChartAnalysis}}}(jQuery);var meterChart={image:"",needle:"",plot:"",arc:"",prevdata:90,text:"",init:function(t){var e=d3.select("#"+t).style("width"),a=d3.select("#"+t).style("height");e=parseInt(e.replace("px","")),a=parseInt(a.replace("px",""));var n=d3.select("#"+t).append("svg").attr("width",e).attr("height",a).append("g").attr("transform","translate("+(e/2-160)+",0)");this.arc=d3.svg.arc().innerRadius(30).outerRadius(120).startAngle(120*(Math.PI/180)).endAngle(240*(Math.PI/180));n.append("g").attr("class","arc");this.image=n.append("svg:image").attr("x",20).attr("y",0).attr("width",280).attr("height",250).attr("xlink:href","http://stocinn.github.io/stocweb/img/gauge_skin.jpg").attr("id","fillImage"),this.text=n.append("svg:text").attr("transform","translate(165,220)").attr("text-anchor","middle").text(""),this.needle=n.append("g").attr("class","needle").attr("transform","translate( 20 , 70)").append("path").attr("class","tri").attr("d","M152 130 L150 0 L147 130 C147 140 153 140 153 130 Z").attr("transform","rotate(-90, 150,130)")},turnNeedle:function(t){function e(){return d3.interpolateString("rotate("+a+", 150, 130)","rotate("+n+", 150, 130)")}0>t?meterChart.text.transition().attr("fill","red").text(t):meterChart.text.transition().attr("fill","green").text(t),this.needle.transition().duration(1e3).attrTween("transform",e);var a=this.getAngleFromCoordinate(meterChart.getCoordinateFromData(meterChart.prevdata)),n=this.getAngleFromCoordinate(meterChart.getCoordinateFromData(meterChart.getPercentFromAngle(meterChart.getAngleForProfitAndLoss(t))))},getPercentFromAngle:function(t){return 0>t&&t>=-180?-(5*t/9):5*t/9},getAngleFromCoordinate:function(t){var e=0,a=90;return e+=a*t},getCoordinateFromData:function(t){return coordinate=t/100-(1-t/100),coordinate},getRadianFromData:function(t){return coordinate=t/57.2958,coordinate},callTurnNeedle:function(){var t=100*Math.random();meterChart.turnNeedle(t),meterChart.prevdata=t},getAngleForProfitAndLoss:function(t){var e;return e=t>0&&100>=t?90+.9*t:90+.9*t}};StockMarketChartManager={xScaleHistoricChart:"",data:"",cmfConfigurations:"",lineChartConfiguration:"",powerGauageChartConfiguration:"",selectorContainerId:"",chartHeightMap:{},margin:{top:10,left:20,right:20,bottom:10},scalableLimit:2,areaSubsetArray:[],area:"",textLabelDx:50,dateArray:[],chartStyleMap:{hlcChart:"block",cmfChart:"block",powerGaugeChart:"block"},drawStockMarketCharts:function(t,e,a,n,r,i){StockMarketChartManager.selectorContainerId=t,StockMarketChartManager.emptyCharts(),StockMarketChartManager.getHeightOfEachChart(),StockMarketChartManager.cmfConfigurations=a,StockMarketChartManager.lineChartConfiguration=n,StockMarketChartManager.powerGauageChartConfiguration=r,StockMarketChartManager.data=e,StockMarketChartManager.dateArray=i,StockMarketChartManager.drawHLCChart(n),StockMarketChartManager.drawCmfChart(a),StockMarketChartManager.drawPowerGauageChart(r),StockMarketChartManager.drawTimeScale(i),StockMarketChartManager.attachHoveringEffect(),StockMarketChartManager.listenWindowResize(),StockMarketChartManager.appendToolTip()},listenWindowResize:function(){$(window).resize(function(){StockMarketChartManager.updateChartOnResize()})},attachHoveringEffect:function(){var t=StockMarketChartManager.selectorContainerId,e=StockMarketChartManager.margin,a=StockMarketChartManager.dateArray,n=StockMarketChartManager.lineChartConfiguration.data,r=StockMarketChartManager.cmfConfigurations.data,i=StockMarketChartManager.powerGauageChartConfiguration.data,o=StockMarketChartManager.lineChartConfiguration.highFieldName,l=StockMarketChartManager.lineChartConfiguration.closeFieldName,s=StockMarketChartManager.lineChartConfiguration.lowFieldName,u=StockMarketChartManager.cmfConfigurations.fieldName,c=StockMarketChartManager.powerGauageChartConfiguration.pgrFieldName;d3.select("#"+t).on("mousemove",function(){console.log("mousemove ");var d=StockMarketChartManager.xScaleHistoricChart,f=(e.left-.08*e.left,d3.event.pageX-$("#"+t).offset().left),h=Math.round(d.invert(f));if(0>h||h>a.length-1)d3.select("#"+t).selectAll(".drag-line").style("display","none"),StockMarketChartManager.hideToolTip();else{d3.select("#"+t).selectAll(".drag-line").attr("x1",d(h)).attr("x2",d(h));var p=n[h][o],g=n[h][l],v=n[h][s],y=r[h][u],x=i[h][c];console.log(p+" :: ::"+g+" :: "+v+":: "+y+" :: "+x+" :: "+a[h]);var m=[{headingName:l,headingVal:g},{headingName:o,headingVal:p},{headingName:s,headingVal:v},{headingName:u,headingVal:y},{headingName:c,headingVal:x}];StockMarketChartManager.showToolTip(d3.event,"",a[h],!1,m,""),d3.select("#"+t).selectAll(".drag-line").style("display","block")}}).on("mouseleave",function(){StockMarketChartManager.hideToolTip(),d3.select("#"+t).selectAll(".drag-line").style("display","none")})},updateChartOnResize:function(){var t=StockMarketChartManager.cmfConfigurations,e=StockMarketChartManager.lineChartConfiguration,a=StockMarketChartManager.powerGauageChartConfiguration;StockMarketChartManager.emptyCharts();var n=StockMarketChartManager.chartStyleMap.hlcChart,r=StockMarketChartManager.chartStyleMap.cmfChart,i=StockMarketChartManager.chartStyleMap.powerGaugeChart;StockMarketChartManager.getHeightOfEachChart(),"block"==n&&StockMarketChartManager.drawHLCChart(e),"block"==r&&StockMarketChartManager.drawCmfChart(t),"block"==i&&StockMarketChartManager.drawPowerGauageChart(a);var o=StockMarketChartManager.dateArray;StockMarketChartManager.drawTimeScale(o)},updateChartWithData:function(t){var e=StockMarketChartManager.selectorContainerId,a=StockMarketChartManager.cmfConfigurations,n=StockMarketChartManager.lineChartConfiguration,r=StockMarketChartManager.powerGauageChartConfiguration;StockMarketChartManager.drawStockMarketCharts(e,t,a,n,r)},hideChart:function(t){var e=(StockMarketChartManager.selectorContainerId,StockMarketChartManager.cmfConfigurations),a=StockMarketChartManager.lineChartConfiguration,n=StockMarketChartManager.powerGauageChartConfiguration;StockMarketChartManager.emptyCharts(),StockMarketChartManager.chartStyleMap[t]="none";var r=StockMarketChartManager.chartStyleMap.hlcChart,i=StockMarketChartManager.chartStyleMap.cmfChart,o=StockMarketChartManager.chartStyleMap.powerGaugeChart;StockMarketChartManager.getHeightOfEachChart(),"block"==r&&StockMarketChartManager.drawHLCChart(a),"block"==i&&StockMarketChartManager.drawCmfChart(e),"block"==o&&StockMarketChartManager.drawPowerGauageChart(n);var l=StockMarketChartManager.dateArray;StockMarketChartManager.drawTimeScale(l)},showChart:function(t){StockMarketChartManager.selectorContainerId;StockMarketChartManager.chartStyleMap[t]="block";var e=StockMarketChartManager.chartStyleMap.hlcChart,a=StockMarketChartManager.chartStyleMap.cmfChart,n=StockMarketChartManager.chartStyleMap.powerGaugeChart,r=StockMarketChartManager.cmfConfigurations,i=StockMarketChartManager.lineChartConfiguration,o=StockMarketChartManager.powerGauageChartConfiguration;StockMarketChartManager.emptyCharts(),StockMarketChartManager.getHeightOfEachChart(),"block"==e&&StockMarketChartManager.drawHLCChart(i),"block"==a&&StockMarketChartManager.drawCmfChart(r),"block"==n&&StockMarketChartManager.drawPowerGauageChart(o);var l=StockMarketChartManager.dateArray;StockMarketChartManager.drawTimeScale(l)},attachPanningAndZooming:function(t,e){function a(){var t=n.translate(),e=t[0],a=t[1];e=Math.min(e,0),e=Math.max(e,i-r*i),n.translate([e,a]);d3.selectAll(".money-flow-area ").data([StockMarketChartManager.areaSubsetArray]).attr("d",function(t){return StockMarketChartManager.area(t)})}var n=d3.behavior.zoom().x(t).scaleExtent([1,8]).on("zoom",a);
d3.select("#"+e).call(n);var r=StockMarketChartManager.scalableLimit,i=d3.select("#"+e).style("width").replace("px","")},emptyCharts:function(){var t=StockMarketChartManager.selectorContainerId;document.getElementById(""+t).innerHTML=""},getHeightOfEachChart:function(){var t=StockMarketChartManager.selectorContainerId,e=d3.select("#"+t).style("height");e=parseInt(e.replace("px",""));var a={cmf:"",hlc:"",powergauage:""},n=StockMarketChartManager.chartStyleMap.cmfChart,r=StockMarketChartManager.chartStyleMap.hlcChart,i=StockMarketChartManager.chartStyleMap.powerGaugeChart,o=e/2,l=e;"block"==i&&(l-=o/3),"block"==n&&(l-=o/1.5);var s=e;"block"==i&&(s-=o/3),"block"==r&&(s-=o);var u=o/6;a.cmf=s,a.hlc=l,a.powergauage=u,StockMarketChartManager.chartHeightMap=a},generateXScale:function(){var t=d3.min(dateArray.map(function(t){return parseDate.parse(t)})),e=d3.max(dateArray.map(function(t){return parseDate.parse(t)}));xScaleHistoricChart=d3.time.scale().range([0,historicalChartWidth*scalableLimit]).domain([t,e])},drawCmfChart:function(t){function e(t){return t>m?1:m>t?-1:0}var a=StockMarketChartManager.selectorContainerId,n=StockMarketChartManager.margin,r=(StockMarketChartManager.scalableLimit,t.data),i=t.fieldName,o=StockMarketChartManager.chartHeightMap,l=d3.select("#"+a).style("width"),s=o.cmf;l=parseInt(l.replace("px",""));var u=l-n.left-n.right,c=s-n.top-n.bottom,d=d3.select("#"+a).append("svg:svg").attr("class","cmfChart").attr("id","cmfChart").attr("width",l).attr("height",s),f=(d.append("defs").append("svg:clipPath").attr("id","clip1").append("svg:rect").attr("id","clip-rect").attr("x","0").attr("y","0").attr("width",l).attr("height",s),d.append("g").attr("clip-path","url(#clip1)"));if(void 0!=r&&0!=r.length){for(var h=0;h<r.length;h++){var p=r[h];for(var g in p)(isNaN(p[g])||null==p[g])&&(p[g]="N/A");r[h]=p}for(var v=new Array,h=0;h<r.length;h++)"N/A"!=r[h][i]&&v.push(r[h][i]);v.sort(function(t,e){return t>e?1:e>t?-1:0});var y=v[0],x=v[v.length-1],m=0,b=d3.scale.linear().domain([y,x]).range([c-n.bottom,n.top]),A=d3.scale.linear().domain([d3.min(r.map(function(t){return t.timeIndex})),d3.max(r.map(function(t){return t.timeIndex}))]).range([n.left,u]);StockMarketChartManager.xScaleHistoricChart=A;var M=StockMarketChartManager.textLabelDx;f.append("line").attr("class","divider").attr("x1",A(r[0].timeIndex)).attr("y1",b(m)).attr("x2",A(r[r.length-1].timeIndex)).attr("y2",b(m)),f.append("text").attr("class","yrule").attr("x",u-n.right+M).attr("y",b(m)).attr("dy",0).attr("dx","-1.2em").attr("text-anchor","end").text(parseFloat(m).toFixed(2)).style("color","#FFFFFF").attr("fill","white");var k=[0];$(r).each(function(t,a){t>0&&(isNaN(r[t-1][i])||isNaN(a[i])?k.push(t):e(r[t-1][i])!=e(a[i])&&0!=a[i]&&k.push(t))}),k.push(r.length-1);var w,S=r[0][i]>m;$(k).each(function(t,e){var a;if(t!=k.length-1){var n=k[t+1];a=r.slice(e,n),void 0!=w&&a.unshift({timeIndex:w,MoneyFlow:m}),w=Math.round((r[n-1].timeIndex+r[n].timeIndex)/2);var o;o=n!=e&&n!=r.length-1?m:"N/A"==r[n][i]?m:r[n][i],a.push({timeIndex:n+1<=r.length-1?w:r[r.length-1].timeIndex+1,MoneyFlow:o}),r[r.length-1][i]>0&&r[r.length-2][i]<0&&n==r.length-1&&n!=e?(a.splice(-1,1),a.push({timeIndex:n+1<=r.length-1?w:r[r.length-1].timeIndex+1,MoneyFlow:m})):r[r.length-1][i]<0&&r[r.length-2][i]>0&&n==r.length-1&&n!=e?(a.splice(-1,1),a.push({timeIndex:n+1<=r.length-1?w:r[r.length-1].timeIndex+1,MoneyFlow:m})):n!=e&&n==r.length-1&&a.push({timeIndex:n+1<=r.length-1?w:r[r.length-1].timeIndex+1,MoneyFlow:m}),S="N/A"==r[e].cmfFieldName?r[n][i]>=m:r[e][i]>=m;var l=d3.svg.area().x(function(t){return A(t.timeIndex)}).y0(b(m)).y1(function(t){return"N/A"!=t[i]?b(void 0!=t[i]?t[i]:m):(console.log("0 "+b(m)),b(m))}).interpolate("basis");$(a).each(function(t,e){void 0===e[i]&&(e[i]="N/A"),StockMarketChartManager.areaSubsetArray.push(e)}),f.append("path").datum(a).attr("class","money-flow-area "+(S?"positive":"negative")).attr("fill",function(){return S?"green":"red"}).attr("d",l(a))}}),d.append("line").attr("x1",5).attr("x2",5).attr("y1",0).attr("y2",s).attr("class","drag-line").style("display","none").style("stroke","#FFFFFF").style("stroke-width","2px")}},drawHLCChart:function(t){for(var e=StockMarketChartManager.selectorContainerId,a=StockMarketChartManager.margin,n=(StockMarketChartManager.scalableLimit,t.data),r=t.highFieldName,i=t.closeFieldName,o=t.lowFieldName,l=t.HighBand,s=t.LowBand,u=t.Band,c=t.Trend,d=StockMarketChartManager.chartHeightMap,f=0;f<n.length;f++){var h=n[f];for(var p in h)(isNaN(h[p])||null==h[p])&&(h[p]="N/A");n[f]=h}var g=d3.select("#"+e).style("width"),v=d.hlc;g=parseInt(g.replace("px",""));var y=g-a.left-a.right,x=v-a.top-a.bottom,m=d3.select("#"+e).append("svg:svg").attr("class","hlcChart").attr("id","hlcChart").attr("width",g).attr("height",v),b=getMinRange(n),A=getMaxRange(n),M=d3.scale.linear().domain([b,A]).range([x-a.bottom,a.top]),k=d3.scale.linear().domain([d3.min(n.map(function(t){return t.timeIndex})),d3.max(n.map(function(t){return t.timeIndex}))]).range([a.left,y]);StockMarketChartManager.xScaleHistoricChart=k;var w=StockMarketChartManager.textLabelDx;m.selectAll("text.yrule").data(M.ticks(10)).enter().append("svg:text").attr("class","yrule").attr("x",y-a.right+w).attr("y",M).attr("dy",0).attr("dx",0).attr("text-anchor","end").style("color","#FFFFFF").style("font-size","12px").attr("fill","#FFFFFF").append("tspan").text(function(t){return new Number(t).toFixed(2)+""}),m.selectAll("line.close").data(n).enter().append("svg:line").attr("class","close").attr("x1",function(t){return k(t.timeIndex)+.25*y/n.length-.5}).attr("y1",function(t){return"N/A"!=t[i]?M(t[i]):($(this).select("line.close").attr("class","NA"),M(0))}).attr("x2",function(t){return k(t.timeIndex)+.25*(y-(a.left+a.right))/n.length+2}).attr("y2",function(t){return"N/A"!=t[i]?M(t[i]):($(this).select("line.close").attr("class","NA"),M(0))}).style("stroke","#15c515").attr("stroke-width","1px"),m.selectAll("line.stem").data(n).enter().append("svg:line").attr("class","stem").attr("x1",function(t){return k(t.timeIndex)+.25*(y-(a.left+a.right))/n.length}).attr("x2",function(t){return k(t.timeIndex)+.25*(y-(a.left+a.right))/n.length}).attr("y1",function(t){return"N/A"!=t[r]?M(t[r]):($(this).select("line.stem").attr("class","NA"),M(0))}).attr("y2",function(t){return"N/A"!=t[o]?M(t[o]):($(this).select("line.stem").attr("class","NA"),M(0))}).attr("stroke","#15c515").attr("stroke-width","1px");var S=d3.svg.line().x(function(t){return k(t.timeIndex)}).y(function(t){return M(t[l])}).interpolate("linear").defined(function(t){return 0!=t[l]}).defined(function(t){return"N/A"!=t[l]&&0!=t[l]}),C=d3.svg.line().x(function(t){return k(t.timeIndex)}).y(function(t){return M(t[s])}).interpolate("linear").defined(function(t){return 0!=t[s]}).defined(function(t){return"N/A"!=t[s]&&0!=t[s]}),T=d3.svg.line().x(function(t){return k(t.timeIndex)}).y(function(t){return M(t[u])}).interpolate("linear").defined(function(t){return 0!=t[u]}).defined(function(t){return"N/A"!=t[u]&&0!=t[u]}),L=d3.svg.line().x(function(t){return k(t.timeIndex)}).y(function(t){return M(t[c])}).interpolate("linear").defined(function(t){return 0!=t[c]&&"N/A"!=t[c]});m.selectAll("path.high-band").data([n]).enter().append("path").attr("class","high-band band").style("stroke-dasharray","1, 4").attr("d",S).attr("stroke-width",2).attr("fill","none").attr("stroke-dasharray","1px, 4px").attr("stroke","#fcfcfc"),m.selectAll("path.low-band").data([n]).enter().append("path").attr("class","low-band band").style("stroke-dasharray","1, 4").attr("d",C).attr("stroke-width",2).attr("fill","none").attr("stroke-dasharray","1px, 4px").attr("stroke","#fcfcfc"),m.selectAll("path.mid-band").data([n]).enter().append("path").attr("class","band mid-band").style("stroke-dasharray","1, 4").attr("d",T).attr("stroke-width",1).attr("fill","none").attr("stroke","#fcfcfc"),m.selectAll("path.trend").data([n]).enter().append("path").attr("class","trend").attr("d",L).attr("fill","none").attr("stroke","#e38502").attr("stroke-width","1px"),m.append("line").attr("x1",5).attr("x2",5).attr("y1",0).attr("y2",v).attr("class","drag-line").style("display","none").style("stroke","#FFFFFF").style("stroke-width","2px")},drawPowerGauageChart:function(t){for(var e=StockMarketChartManager.selectorContainerId,a=StockMarketChartManager.margin,n=(StockMarketChartManager.scalableLimit,t.data),r=t.pgrFieldName,i=t.pgrColorMap,o=StockMarketChartManager.chartHeightMap,l=0;l<n.length;l++){var s=n[l];for(var u in s)(isNaN(s[u])||null==s[u])&&(s[u]="N/A");n[l]=s}var c=d3.select("#"+e).style("width"),d=o.powergauage;c=parseInt(c.replace("px",""));var f=c-a.left-a.right,h=d-a.top-a.bottom,p=d3.select("#"+e).append("svg:svg").attr("class","power-gauage").attr("id","power-gauage").attr("width",c).attr("height",d),g=d3.max(n.map(function(t){return t.powerGauageFieldName})),v=d3.min(n.map(function(t){return t.powerGauageFieldName})),y=(d3.scale.linear().domain([v,g]).range([h-a.bottom,a.top]),d3.scale.linear().domain([d3.min(n.map(function(t){return t.timeIndex})),d3.max(n.map(function(t){return t.timeIndex}))]).range([a.left,f]));StockMarketChartManager.xScaleHistoricChart=y;var x=y(n[1].timeIndex)-y(n[0].timeIndex);p.selectAll("rect.rel-strength").data(n).enter().append("svg:rect").attr("class","rel-strength").attr("x",function(t){return y(t.timeIndex)}).attr("y",function(){return 0}).attr("width",x).attr("height",h).attr("fill",function(t){return i[t[r]]}).attr("stroke",function(t){return i[t[r]]}),p.append("line").attr("x1",5).attr("x2",5).attr("y1",0).attr("y2",d).attr("class","drag-line").style("display","none").style("stroke","#FFFFFF").style("stroke-width","2px")},drawTimeScale:function(t){var e=StockMarketChartManager.xScaleHistoricChart,a=StockMarketChartManager.selectorContainerId,n=StockMarketChartManager.margin,r=d3.select("#"+a).style("width"),i=30;r=parseInt(r.replace("px",""));var o=(r-n.left-n.right,{}),l=[],s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],u={};$(t).each(function(t,e){var a=new Date(e);void 0==o[a.getMonth()+"-"+a.getYear()]&&a.getDate()<15&&(l.push(e),u[e]=t,o[a.getMonth()+"-"+a.getYear()]=!0)});for(var c in u)console.log("keys    "+c+" value "+u[c]);var d=new Date(l[0]),f=d3.select("#"+a).append("svg:svg").attr("class","time-axis").attr("id","time-axis").attr("width",r).attr("height",i),h=f.selectAll("div.tick").data(l).enter().append("g").attr("class","tick").attr("transform",function(t){console.log("xScale  "+e(u[t]));var a=e(u[t]);return"translate("+a+","+n.top+")"});h.append("text").style("color","#FFFFFF").style("font-size","12px").attr("fill","#FFFFFF").text(function(t,e){var a=new Date(t);return 0==e?"'"+(d.getFullYear()+"").substr(2,3):s[a.getMonth()]}),f.append("line").attr("x1",5).attr("x2",5).attr("y1",0).attr("y2",i).attr("class","drag-line").style("display","none").style("stroke","#FFFFFF").style("stroke-width","2px")},appendToolTip:function(){{var t='<div id="tooltipChart-stock-market" style="z-index:99999;float:none;display:none; margin:0px; padding:0px; position:absolute; width:150px;"><div id="textContainer" style="width:150px; background-color:#eeeeee; border:solid 1px #666666; box-shadow:5px 5px 5px #5d5d5d; border-radius:7px; font-family:calibri; float:left; font-size:11px; padding:10px;">	<div class="xVal" style="text-align:center; font-size:13px; background-color:#6699cc; border-top-left-radius:7px; margin-top:-10px; margin-left:-10px;  margin-right:-10px;border-top-right-radius:7px; padding:5px 10px;">14 jan</div><div id="y-label" class="y-label label1" style="width:60%;display:none; float:left; text-align:left; padding:3px 0;">Auto Loans</div><div  class="yVal label1" style="width:40%; float:right;display:none; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label2" style="width:60%; float:left;display:none; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label2" style="width:40%;display:none; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label3" style="width:60%; float:left; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label3" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label4" style="width:60%; float:left; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label4" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>		<div class="y-label label5" style="width:60%; float:left; text-align:left; padding:3px 0;">Auto Loans</div>		<div class="yVal label5" style="width:40%; float:right; text-align:right;  padding:3px 0;">$ 400</div>	</div></div>';StockMarketChartManager.selectorContainerId}$("body").append(t)},showToolTip:function(t,e,a,n,r){var i,o=t.pageX;i=t.pageY;var l;l=e;var s;s=a,$("#tooltipChart-stock-market").find(".xVal").html(""),$("#tooltipChart-stock-market").find(".xVal").html(s),$("#tooltipChart-stock-market").find(".y-label").html(""),$("#tooltipChart-stock-market").find(".yVal").html(""),$("#tooltipChart-stock-market").find(".yVal").hide(),$("#tooltipChart-stock-market").find(".y-label").hide();for(var u=$("#tooltipChart-stock-market"),c=0;c<r.length;c++){var d=r[c],f=c+1,h=".y-label.label"+f,p=".yVal.label"+f;$(u).find(h).html(d.headingName),$(u).find(p).html(d.headingVal),$(u).find(p).show(),$(u).find(h).show()}var g=o;if($(".ps-scrollbar-x-rail"))try{g+=parseInt($(".ps-scrollbar-x-rail").css("left").replace("px",""))}catch(v){}var y=$("body").find("#tooltipChart-stock-market"),x=($(y).find("#textContainer"),i-.9*$("body").find("#tooltipChart-stock-market").height());g-=.95*$("body").find("#tooltipChart-stock-market").width(),g-$(y).width()<170&&(g=.5*g+$(y).width()),console.log("page y "+x+"y "+i),$("body").find("#tooltipChart-stock-market").css("left",g);var m=StockMarketChartManager.selectorContainerId,b=parseInt(d3.select("#"+m).style("height").replace("px",""));$("body").find("#tooltipChart-stock-market").css("top",b/2),$("body").find("#tooltipChart-stock-market").show()},hideToolTip:function(){$("#tooltipChart-stock-market").find(".yVal").html(""),d3.select("#tooltipChart-stock-market").style("display","none")}};